---
title: 文字模板轉換流程 |Microsoft Docs
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-modeling
ms.topic: conceptual
helpviewer_keywords:
- text templates, transformation process
ms.assetid: 80b3f0e0-49e7-4865-a1ac-dba068abe96b
caps.latest.revision: 32
author: jillre
ms.author: jillfra
manager: jillfra
ms.openlocfilehash: 7322724b2118cb8b844262696a6e7cbd91a74e9b
ms.sourcegitcommit: a8e8f4bd5d508da34bbe9f2d4d9fa94da0539de0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/19/2019
ms.locfileid: "72658499"
---
# <a name="the-text-template-transformation-process"></a>文字範本轉換流程
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

文字模板轉換程式會接受文字模板檔案做為輸入，並產生新的文字檔做為輸出。 例如，您可以使用文字模板來產生 Visual Basic 或C#程式碼，也可以產生 HTML 報表。

 有三個元件會納入此程式中：引擎、主機和指示詞處理器。 引擎會控制進程;它會與主機和指示詞處理器互動，以產生輸出檔案。 主機會提供與環境的任何互動，例如尋找檔案和元件。 指示詞處理器會加入功能，例如從 XML 檔案或資料庫讀取資料。

 文字模板轉換程式會以兩個步驟執行。 首先，引擎會建立一個暫存類別，稱為「產生的轉換類別」。 這個類別包含指示詞和控制區塊所產生的程式碼。 之後，引擎會編譯並執行產生的轉換類別，以產生輸出檔。

## <a name="components"></a>元件

|元件|描述|可自訂（是/否）|
|---------------|-----------------|------------------------------|
|搜尋引擎優化|引擎元件控制文字模板轉換進程|否。|
|主機|主機是引擎與使用者環境之間的介面。 [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] 是文字轉換程式的主機。|可以。 您可以撰寫自訂主機。|
|指示詞處理器|指示詞處理器是在文字模板中處理指示詞的類別。 您可以使用指示詞，從輸入來源將資料提供給文字模板。|可以。 您可以撰寫自訂指示詞處理器|

## <a name="the-engine"></a>引擎
 引擎會以字串的形式接收來自主機的範本，以處理轉換進程中使用的所有檔案。 然後，引擎會要求主機找出任何自訂指示詞處理器和環境的其他層面。 然後，引擎會編譯並執行產生的轉換類別。 引擎會將產生的文字傳回到主機，這通常會將文字儲存至檔案。

## <a name="the-host"></a>主機
 主機負責轉換程式外部與環境相關的任何專案，包括下列各項：

- 尋找引擎或指示詞處理器所要求的文字和二進位檔案。 主機可以搜尋目錄和全域組件快取來找出元件。 主機可以找出引擎的自訂指示詞處理器程式碼。 主機也可以尋找和讀取文字檔，並以字串形式傳回其內容。

- 提供標準元件和命名空間的清單，由引擎用來建立所產生的轉換類別。

- 提供當引擎編譯並執行產生的轉換類別時所使用的應用程式域。 使用個別的應用程式域來保護主應用程式，避免出現範本程式碼中的錯誤。

- 正在寫入產生的輸出檔。

- 為產生的輸出檔設定預設的副檔名。

- 處理文字模板轉換錯誤。 例如，主機可以在使用者介面中顯示錯誤，或將它們寫入檔案。 （在 [!INCLUDE[vsprvs](../includes/vsprvs-md.md)] 中，錯誤會顯示在錯誤訊息視窗中）。

- 如果使用者已呼叫指示詞而未提供值，則提供必要的參數值。 指示詞處理器可以指定指示詞和參數的名稱，並要求主機提供預設值（如果有的話）。

## <a name="directives-and-directive-processors"></a>指示詞和指示詞處理器
 指示詞是文字模板中的命令。 它會提供參數給產生進程。 通常指示詞會定義模型或其他輸入的來源和類型，以及輸出檔的副檔名。

 指示詞處理器可以處理一或多個指示詞。 當您轉換範本時，您必須已安裝可處理您範本中之指示詞的指示詞處理器。

 指示詞的作用是在產生的轉換類別中加入程式碼。 您會從文字模板呼叫指示詞，而引擎會在建立所產生的轉換類別時，處理所有的指示詞呼叫。 在您成功呼叫指示詞之後，您在文字模板中撰寫的其餘程式碼，都可以依賴指示詞所提供的功能。 例如，您可以對範本中的 `import` 指示詞進行下列呼叫：

 `<#@ import namespace="System.Text" #>`

 標準指示詞處理器會將此轉換成產生的轉換類別中的 `using` 語句。 接著，您可以在範本程式碼的其餘部分使用 `StringBuilder` 類別，而不需將它限定為 `System.Text.StringBuilder`。
