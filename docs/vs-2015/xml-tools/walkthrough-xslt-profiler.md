---
title: 逐步解說： XSLT Profiler |Microsoft Docs
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-xml-tools
ms.topic: conceptual
ms.assetid: 87387c9a-2e89-4801-ad51-83740cd6ea25
caps.latest.revision: 10
author: jillre
ms.author: jillfra
manager: jillfra
ms.openlocfilehash: f7ee6665aea98edf7cb701f5fdfe07d293887bac
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/02/2020
ms.locfileid: "72669531"
---
# <a name="walkthrough-xslt-profiler"></a>逐步解說：XSLT 分析工具
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

XSLT 分析工具可建立詳細的 XSLT 效能報告，協助您測量、評估並解決 XSLT 程式碼中與效能相關的問題。 XSLT 分析工具包含 XSL 和 XSLT 樣式表最佳化的實用提示。 就需要最大效能的 XSLT 應用程式而言，此工具是非常基本的。

## <a name="prerequisites"></a>Prerequisites
 下列逐步解說中的程序需要 Visual Studio 2010 和 .NET Framework 4.0 版。 XSLT 分析工具僅適用於搭配使用已安裝程式碼剖析工具的 Microsoft Visual Studio Team System。

### <a name="create-the-performance-report"></a>建立效能報告

1. 在 Visual Studio 中開啟 XSLT 文件。

2. 按一下 [XML] 功能表中提供的 [ **設定檔] XSLT** 選項。

3. 提供輸入 XML 文件。 如果尚未開啟任何 XML 文件，系統會提示您開啟檔案。

4. 開始分析時會出現一個進度列，顯示編輯器中的進度。

5. XSLT 輸出會顯示在輸出窗格中。

6. 效能工作階段結束後，請查看效能報告。 儲存在效能報告中的資料可讓您檢視並分析 XSLT 效能。

### <a name="get-all-the-available-views"></a>取得所有可用的檢視

1. 按一下 [ **目前的視圖** ] 下拉式清單，即可取得所有可用的視圖。

2. 在 [**目前的視圖**] 下拉式清單中，選取 [**摘要視圖**] 選項。 依預設，效能報表會顯示在 **摘要視圖**中。 這個檢視是透過 XSLT 文件判斷效能問題的起點。 **摘要視圖**會列出下列資料點：

    - 最常呼叫的函式

    - 含有最多個別工作的函式

    - 執行時間最長的函式

3. 根據預設，每個資料點中有三個資料行：函式的名稱、呼叫的次數 (絕對值)，以及具名函式佔總函式呼叫次數的百分比值。 您可以從 **摘要視圖**中的每個資料點，以滑鼠右鍵按一下函式資料點來流覽至更詳細的視圖。

4. 在 [**目前的視圖**] 下拉式清單中，選取 [**函數視圖**] 選項。 **函數視圖**會列出程式碼剖析期間呼叫的函式。 您可以按一下資料行名稱來排序資料。 預設顯示的資料行為：

    - **函數名稱**

    - **功能內含耗用 (Elapsed Inclusive) 時間**

    - **功能專屬耗用 (Elapsed Exclusive) 時間**

    - **應用程式內含 (Application Inclusive) 時間**

    - **應用程式專屬 (Application Exclusive) 時間**

    - **呼叫次數**

5. 所有時間資料行均會同時顯示絕對值和百分比。 「 **獨佔** 」一詞是指函式在執行此函式期間呼叫其他函式所花費的時間內，所花費的時間總計。

6. 「 **內含** 」一詞是指函式花費在執行的總時間，包括它所呼叫之所有函式的執行時間，以及這些呼叫的函式是否有任何稱為其他函式。

### <a name="select-callercallee-view"></a>選取呼叫端/被呼叫端檢視

1. 選取 [**目前的視圖**] 下拉式清單中的 [**呼叫端/被呼叫者**]。

2. **呼叫端/被呼叫**端的視圖有下列三個不同的部分：

    - **呼叫**的函式：所有呼叫特定函式的函式會列在視圖的上半部。

    - **目前**的函式：所呼叫的特定函式會列在視圖的中間部分。

    - **呼叫** 的函式：特定函式所呼叫的所有函式都會列在視圖的下半部。

3. 如果名為 `SyncToNavigator` 的函式出現在檢視的中間部分，則所有呼叫 `SyncToNavigator` 函式的函式都會出現在檢視的上半部，而所有被 `SyncToNavigator` 呼叫的函式會出現在檢視的下半部。

4. 您可以按兩下檢視中其他兩個部分列出的任何一個函式，以變更檢視中間部分的函式。 然後檢視會自動更新以反映變更。

5. 您也可以按一下資料行名稱以排序資料。

### <a name="select-calltree-view"></a>選取呼叫樹狀圖檢視

1. 選取 [**目前的視圖**] 下拉式清單中的 [**呼叫樹狀檢視**]。 此檢閱是程式執行的樹狀檢閱。

2. [ **呼叫樹狀檢視** ] 會將樹狀結構的根顯示為進程名稱。 函式即為樹狀的節點。 此檢視可讓您深入查看特定的呼叫追蹤，並且分析哪些追蹤會對效能造成最大的影響。 此視圖類似于偵錯工具期間可用的 [ **呼叫堆疊] 視圖** 。 除了函式 **視圖**中的資料行之外，在 [ **呼叫樹狀檢視**] 中還有另一個資料行可顯示 **模組名稱**。

3. 在 [目前的**視圖**] 下拉式清單中選取 [**標記**]。

4. 使用 SLT 分析工具時，資料集合資料流中會出現標記及相關的註解。 標記放置在具有計數器的程式碼中。 當您指示 XSLT 分析工具收集 XSLT 效能計數器時，該工具就會在每次執行其中一個標記時收集計數器。 資料會顯示在包含 **標記識別項**、 **標記名稱** (**開始程式**]、[ **結束程式**) ] 和 [ **時間戳記**] 的資料表中。 這些標記不會匯總，而且會依時間順序顯示在效能報表的 **標記視圖** 中。

### <a name="select-modules-in-the-current-view"></a>在目前的檢視中選取模組

1. 選取 [目前的**視圖**] 下拉式清單中的 [**模組**]。

2. 模組檢視是彙總為模組層級之所有函式的一般清單。 請展開或摺疊模組名稱來顯示或關閉模組效能資料的檢視。 您可以按一下資料行名稱來排序資料。 根據預設，有功能的 **內含時間**、功能 **專屬時間**、 **應用程式內含時間**、 **應用程式專屬時間**和 **呼叫次數**都有絕對值和百分比數位。

3. 在 [目前的**視圖**] 下拉式清單中選取 [**進程**]。

4. 進程視圖會顯示一個資料表，其中包含 **處理序識別碼**、 **進程名稱**、 **開始時間**和 **結束時間**。 按一下資料行名稱即可排序資料。

## <a name="see-also"></a>另請參閱
 [逐步解說：使用 XSLT 階層](../xml-tools/walkthrough-using-xslt-hierarchy.md)
