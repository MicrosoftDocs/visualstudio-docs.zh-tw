---
title: C6291 |Microsoft Docs
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-code-analysis
ms.topic: reference
f1_keywords:
- C6291
helpviewer_keywords:
- C6291
ms.assetid: d0457386-e403-43fa-b959-5b6a495fab42
caps.latest.revision: 16
author: corob-msft
ms.author: corob
manager: jillfra
ms.openlocfilehash: 835bc16493b5d15595725a5b4a406b960f94b9b0
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/02/2020
ms.locfileid: "77274639"
---
# <a name="c6291"></a>C6291
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

警告 C6291：邏輯結果的位運算：！ 的優先順序高於 &#124;。 改用 &#124;&#124; 或 (！ (x &#124; y) # A3  
  
 `!`運算子會產生布林結果，而 `|` (位 or) 運算子採用兩個算術引數。 `!`運算子的優先順序也高於 `|` 。  
  
 因此，偵測到下列其中一個錯誤：  
  
- 運算式 parenthesised：  
  
   因為的結果 `!` 是布林值 (零或一個) ，所以嘗試測試兩個變數是否有位設定，只會結束測試右邊有最低位： `((!x) | y) != (!(x | y))` when `x == 0` 和 `y == 1` 。  
  
- `!`運算子不正確，應 `~` 改為：  
  
   `!`運算子有布林值結果，但是 `~` 運算子有算術結果。 即使是在布林值上操作 (零或一個) ： `((!x) | y) != ((~x) | y)` when `x == 1` 和，這些運算子永遠不可互換 `y == 0` 。  
  
- 二元運算子不 `|` 正確，應改為 `||` ：  
  
   雖然 `|` 有時可以與交換 `||` ，但它不是相等的，因為它會強制評估運算式的右邊。 這種運算式中的某些副作用可以是 terminal： `(!p | (*p == '\0'))` 、when `p == NULL` ，必須將它取值以評估運算式的另一半。  
  
  如果運算子位於運算子右邊，則不會報告此警告， `!` `|` 因為這種情況通常只是不正確運算子的相對無害案例。  
  
  在不檢查程式碼的情況下，很難判斷這個問題的嚴重性。 您應檢查程式碼，以確保發生預期的測試。  
  
  此警告一律表示使用運算子或運算子優先順序時可能會造成混淆。  
  
## <a name="example"></a>範例  
 下列程式碼會產生這個警告：  
  
```  
void f(int x, int y )  
{  
  if (!x | y)  
  {  
    //code   
  }  
}  
```  
  
 若要更正這個警告，請使用下列程式碼中所示的其中一個方法：  
  
```  
void fC(int x, int y )  
{  
  /* When checking whether any bits are set in either x or y. */  
  if (!(x | y))  
  {  
    // code  
  }  
  /* When checking whether bits are set in either */  
  /* the complement of x or in y. */  
  if ((~x) | y)  
  {  
    // code  
  }  
}  
  
#include <windows.h>  
void f(int x, BOOL y )  
{  
  /* When y is a Boolean or Boolean result. */  
  if ((!x) || y)  
  {  
    // code  
  }  
}  
```
