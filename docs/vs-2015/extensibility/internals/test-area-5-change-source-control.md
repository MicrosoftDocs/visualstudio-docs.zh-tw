---
title: 測試區域5：變更原始檔控制 |Microsoft Docs
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- source control [Visual Studio SDK], changing
- source control plug-ins, changing source control
ms.assetid: fdf09e00-108c-4d51-bbd5-72452d52a490
caps.latest.revision: 16
ms.author: gregvanl
manager: jillfra
ms.openlocfilehash: d79281e2fef6a7ae77a2ba6c8375f47dc6520b3a
ms.sourcegitcommit: 6cfffa72af599a9d667249caaaa411bb28ea69fd
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/02/2020
ms.locfileid: "68155985"
---
# <a name="test-area-5-change-source-control"></a>測試區域 5：變更原始檔控制
[!INCLUDE[vs2017banner](../../includes/vs2017banner.md)]

此原始檔控制外掛程式測試區域包含透過 [ **變更原始檔控制** ] 命令變更原始檔控制。  
  
 **變更原始檔控制** 命令為使用者提供四個基本功能：  
  
- **綁定：**  
  
   可讓使用者建立或重新建立解決方案/專案與版本存放區之間的原始檔控制連結。  
  
- **先**  
  
   從原始檔控制中移除專案/方案（以每個連接為基礎）。  
  
- **連線/中斷連接：**  
  
  切換受控制解決方案的連線或離線狀態（涵蓋于區域3）。 如需詳細資訊，請參閱 [測試區域3：簽出/復原簽](../../extensibility/internals/test-area-3-check-out-undo-checkout.md)出。  
  
## <a name="command-menu-access"></a>命令功能表存取  
 下列 [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] 整合式開發環境功能表路徑用於測試案例中。  
  
 變更原始檔控制 **：檔案**、 **原始檔控制**、 **變更原始檔控制**。  
  
## <a name="test-cases"></a>測試案例  
 以下是 **變更原始檔控制** 命令測試區域的特定測試案例。  
  
### <a name="case-5a-bind"></a>案例5a：系結  
 系結可讓使用者將原始程式碼控制資訊新增至選取的專案和方案。 系統通常會提示使用者在原始檔控制中識別要加入這些專案的專案。 使用者無法在原始檔控制中建立新的專案做為這項作業的一部分， (與 [新增至原始檔控制]) 的對比。  
  
|動作|測試步驟|要驗證的預期結果|  
|------------|----------------|--------------------------------|  
|系結至空白位置|1. 建立專案。<br />2. 將方案加入至原始檔控制。<br />3. 開啟 [ **變更原始檔控制** ] **對話方塊 (檔案**、原始檔 **控制**、 **變更原始檔控制**) 。<br />4. 按一下 [ **解除**系結]。<br />5. [接受警告] 對話方塊（如果有的話）。<br />6. 選取所有專案。<br />7 **. 按一下 [** 系結]。<br />8. 流覽至原始檔控制存放區中的空白位置。<br />9. 按一下 **[確定** ] 關閉 [ **變更原始檔控制** ] 對話方塊。<br />10. 在確認對話方塊中按一下 [ **繼續使用這些** 系結]。<br />11. 如果出現 [警告] 對話方塊，請按一下 **[確定** ]。<br />12. 全部簽入。 如果此步驟成功，請繼續下一個步驟。<br />13. 將方案從原始檔控制開啟至新位置。|`Result from Step 12:`<br /><br /> 方案和專案會系結至版本存放區中的新目標並寫入。<br /><br /> 方案和專案檔案已簽入。<br /><br /> 版本存放區專案階層符合磁片上專案的資料夾階層。<br /><br /> `Result from Step 13:`<br /><br /> 所有專案專案都已下載。|  
|系結至與用戶端同步的位置|1. 建立專案。<br />2. 將方案加入至原始檔控制。<br />3. 如果使用) ，請在版本存放區中建立方案和專案的複本 (共用和分支 [!INCLUDE[vsvss](../../includes/vsvss-md.md)] 。<br />4. 開啟 [ **變更原始檔控制** ] **對話方塊 (檔案**、原始檔 **控制**、 **變更原始檔控制**) 。<br />5. 全部解除系結。<br />6. 按一下 **[確定** ] 關閉 [ **變更原始檔控制** ] 對話方塊。<br />7. 重新開啟 **變更原始檔控制** 對話方塊。<br />8. 全選。<br />9 **. 按一下 [** 系結]。<br />10. 流覽至步驟3的解決方案和專案 (的分支位置) <br />11. 按一下 **[確定** ] 關閉 [ **變更原始檔控制** ] 對話方塊。<br />12. 針對所有專案以遞迴方式取得最新的。|Get 之後的檔案內容與 get 之前的內容相同。|  
|系結至與用戶端不同步的位置|1. 建立專案。<br />2. 將方案加入至原始檔控制。<br />3. 如果使用) ，請在版本存放區中建立方案和專案的複本 (共用和分支 [!INCLUDE[vsvss](../../includes/vsvss-md.md)] 。<br />4. 修改版本存放區中分支專案的檔案。<br />5. 開啟 [ **變更原始檔控制** ] **對話方塊 (檔案**、原始檔 **控制**、 **變更原始檔控制**) 。<br />6. 全部解除系結。<br />7. 按一下 **[確定** ] 關閉 [ **變更原始檔控制** ] 對話方塊。<br />8. 重新開啟 **變更原始檔控制** 對話方塊。<br />9. 全選。<br />10 **. 按一下 [** 系結]。<br />11. 流覽至分支位置以取得方案和專案。<br />12. 按一下 **[確定** ] 關閉 [ **變更原始檔控制** ] 對話方塊。<br />13. [接受警告] 對話方塊（如果有的話）。<br />14. 取得所有專案的最新遞迴。|在步驟4中修改的檔案也會在本機修改。|  
|系結從未在原始檔控制下的解決方案|1. 在原始檔控制中建立空的資料夾。<br />2. 建立用戶端專案。<br />3. 開啟 [ **變更原始檔控制** ] **對話方塊 (檔案**、原始檔 **控制**、 **變更原始檔控制**) 。<br />4. 將方案系結至原始檔控制中的空白位置。<br />5. 按一下 **[確定** ] 關閉 [ **變更原始檔控制** ] 對話方塊。<br />6. 在確認對話方塊中按一下 [ **繼續使用這些** 系結]。<br />7. 如果出現警告對話方塊，請按一下 [ **確定** ]。|方案會新增至原始檔控制。<br /><br /> 方案和專案已簽出。|  
|取消系結|1. 建立專案。<br />2. 將方案加入至原始檔控制。<br />3. 開啟 [變更原始檔控制] 對話方塊。<br />4. 全部解除系結。<br />5. 按一下 **[確定** ] 按鈕以關閉對話方塊。 如果此步驟成功，請繼續下一個步驟。<br />6. 重新開啟 [ **變更原始檔控制** ] 對話方塊。<br />7. 系結至不相關的位置。<br />8. 按一下 [ **取消**]。|`Result from Step 5:`<br /><br /> 方案已不再受到原始檔控制<br /><br /> `Result from Step 8:`<br /><br /> 方案仍不在原始檔控制之下。|  
  
### <a name="case-5b-unbind"></a>案例5b：解除系結  
 解除系結會從專案及其方案移除原始程式碼控制資訊。 受影響的專案和方案是以使用者選取的混合，以及如何將專案新增至原始檔控制的方式來決定。  
  
|動作|測試步驟|要驗證的預期結果|  
|------------|----------------|--------------------------------|  
|解除系結方案，其中包含一個檔案系統或本機 IIS Web 專案和一個用戶端專案|1. 建立檔案系統或本機 IIS Web 專案。<br />2. 將方案加入至原始檔控制。<br />3. 將新的用戶端專案加入至方案。<br />4. 如果出現提示，請接受簽出解決方案。<br />5. 開啟 [ **變更原始檔控制** ] 對話方塊。<br />6. 按一下 [ **解除**系結]。<br />7. 按一下 **[確定** ] 關閉對話方塊。<br />8. 嘗試簽出方案、專案、方案專案、專案專案。|方案和專案不在原始檔控制之下。<br /><br /> 原始檔控制功能表命令不會出現。|  
|取消解除系結|1. 建立專案。<br />2. 將方案加入至原始檔控制。<br />3. 開啟 [ **變更原始檔控制** ] 對話方塊。<br />4. 按一下 [ **全部解除**系結]。<br />5. 按一下 [ **取消**]。|解決方案是在原始檔控制之下。|  
  
### <a name="case-5c-rebind"></a>案例5c：重新綁定  
 重新系結只是解除系結和系結的組合—這是重新系結先前在原始檔控制之下且已解除系結之專案/方案的程式。  
  
|動作|測試步驟|要驗證的預期結果|  
|------------|----------------|--------------------------------|  
|重新系結方案和專案，但不關閉 **變更原始檔控制** 對話方塊|1. 建立專案。<br />2. 將方案加入至原始檔控制。<br />3. 開啟 [ **變更原始檔控制** ] 對話方塊。<br />4. 按一下 [ **解除**系結]。<br />5. 選取所有資料列。<br />6 **. 按一下 [** 系結]。<br />7. 按一下 **[確定** ] 關閉 [ **變更原始檔控制** ] 對話方塊。<br />8. 如果出現提示，請接受簽出。|方案和專案在原始檔控制之下。|  
|只有在不關閉 **變更原始檔控制** 對話方塊的情況下重新系結專案|1. 建立專案。<br />2. 使用 (檔案 >將專案加入至原始檔控制->將選取的專案加入至原始檔控制。<br />3. 開啟 [變更原始檔控制] 對話方塊。<br />4. 只解除系結專案。<br />5. 只系結專案。|解決方案仍保持未受控制狀態。<br /><br /> 專案仍維持受控制狀態。|  
|只有在未關閉 **變更原始檔控制** 對話方塊的情況下重新系結方案|1. 建立專案。<br />2. **使用 (檔案**、原始檔 **控制**將方案加入至原始檔控制， **並將選取的專案加入至原始檔控制**。<br />3. 開啟 [ **變更原始檔控制** ] 對話方塊。<br />4. 只解除系結方案 (不要關閉 [ **變更原始檔控制** ] 對話方塊。 ) <br />5. 只系結方案。<br />6. 按一下 **[確定** ] 關閉對話方塊。<br />7. 查看解決方案和方案專案 (如果有的話） ) |解決方案保持控制。<br /><br /> 專案仍保持未受控制狀態。|  
|只在相同目錄中重新系結解決方案/專案|1. 建立專案。<br />2. **使用 (檔案**、原始檔 **控制**將專案加入至原始檔控制， **並將選取的專案加入至原始檔控制**。<br />3. 關閉方案。<br />4. 建立至少具有兩個專案的新方案。<br />5. 將方案加入至原始檔控制。<br />6. 將步驟1中建立的專案從原始檔控制加入。<br />7. 如果出現提示，請接受簽出解決方案。<br />8. 簽入整個方案。<br />9. 開啟 [ **變更原始檔控制** ] 對話方塊。<br />10. 從步驟 6) 選取加入的專案 (，然後按一下 [ **解除**系結]。<br />11. 按一下 **[確定** ] 關閉對話方塊。<br />12. 如果出現提示，請接受簽出。<br />13. 重新開啟 **變更原始檔控制** 對話方塊。<br />14. 從步驟 6) 選取加入的專案 (**然後按一下 [** 系結]。<br />15. 選取原始位置。|方案和專案仍保持控制。|  
  
## <a name="see-also"></a>另請參閱  
 [原始檔控制外掛程式測試指南](../../extensibility/internals/test-guide-for-source-control-plug-ins.md)
