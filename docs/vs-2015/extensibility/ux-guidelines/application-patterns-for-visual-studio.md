---
title: 應用程式模式
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.technology: vs-ide-sdk
ms.topic: conceptual
ms.assetid: 8ed68602-4e28-46fe-b39f-f41979b308a2
caps.latest.revision: 8
ms.author: gregvanl
manager: jillfra
ms.openlocfilehash: af70b191e4b9061d08acdc7f76ade843dee41709
ms.sourcegitcommit: d9254e54079ae01cdf2d07b11f988faf688f80fc
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/11/2020
ms.locfileid: "88114115"
---
# <a name="application-patterns-for-visual-studio"></a>適用於 Visual Studio 的應用程式模式
[!INCLUDE[vs2017banner](../../includes/vs2017banner.md)]

## <a name="window-interactions"></a><a name="BKMK_WindowInteractions"></a>視窗互動

### <a name="overview"></a>總覽
 Visual Studio 中使用的兩個主要視窗類型為 [檔編輯器] 和 [工具視窗]。 很罕見，但可能是大型非強制回應對話方塊。 雖然這些全都是命令介面中的非模式，但它們的模式基本上是不同的。 本主題涵蓋文件視窗、工具視窗和非強制回應對話方塊之間的差異。 [對話](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_Dialogs)中涵蓋了強制回應對話方塊模式。

### <a name="comparing-window-usage-patterns"></a>比較視窗使用模式
 檔**視窗**幾乎一律會顯示在檔中。 這會讓檔編輯器成為「中心階段」，以安排周圍的補充工具視窗。

 **工具視窗**最常顯示為另一個較小的視窗，可以是可見、隱藏或自動隱藏–針對 IDE 的邊緣折迭。 不過，有時候它們會在檔中呈現，方法是在視窗中取消核取 [**視窗/** 停駐] 屬性。 這會導致更多的資產，但也是常見的設計決策：嘗試整合到 Visual Studio 時，您必須決定您的功能是否應該顯示工具視窗或文件視窗。

 Visual Studio 不建議採用非**強制回應對話方塊**。 在很大的範圍內，它們是依定義–浮動工具視窗，應該以這種方式執行。 當停駐在 shell 邊緣的一般工具視窗大小太過限制時，就允許非強制回應對話方塊。 在使用者可能會將對話移至次要監視的情況下，也可以使用它們。

 請仔細考慮您需要的容器類型。 下表提供 UI 設計的常見使用模式考慮。

||文件視窗|工具視窗|非強制回應對話方塊|
|-|---------------------|-----------------|---------------------|
|**位置**|一定會放在檔中，而且不會停駐在 IDE 的邊緣。 它可以「拉出」，讓它與主要 shell 分開浮動。|通常會停駐在 IDE 邊緣附近，但可以自訂為浮動、自動隱藏 (取消釘選) 或停駐在檔中。|與 IDE 分開的大型浮動視窗。|
|**認可模型**|*延遲認可*<br /><br /> 為了將資料儲存在檔中，使用者必須發出 [檔案]/[儲存]、[另存新檔] 或 [全部儲存] 命令。 文件視窗的概念是它在「變動」中的資料，然後認可到其中一個 [儲存] 命令。 關閉文件視窗時，所有內容都會儲存到磁片或遺失。|*立即認可*<br /><br /> 沒有儲存模型。 對於協助編輯檔案的偵測器工具視窗，檔案必須在使用中的編輯器或設計工具中開啟，而且編輯器或設計工具擁有儲存。|*延遲或立即認可*<br /><br /> 最常見的情況是，大型非強制回應對話方塊需要採取動作來認可變更，並允許「取消」作業，這會回復在對話會話內所做的任何變更。  這會區分非強制回應對話方塊與該工具視窗中的工具視窗一律具有立即認可模型。|
|**可見性**|*開啟/建立 (檔案) 並關閉*<br /><br /> 開啟檔視窗是透過開啟現有檔或使用範本建立新檔來完成。 沒有 "Open \<specific editor> " 命令。|*隱藏和顯示*<br /><br /> 可以隱藏或顯示單一實例工具視窗。 不論是在 view 或 hidden 中，都能保存在工具視窗內的內容和狀態。 多重實例工具視窗也可以關閉和隱藏。 當多個實例的工具視窗關閉時，會捨棄工具視窗中的內容和狀態。|*從命令啟動*<br /><br /> 對話方塊是從以工作為基礎的命令啟動。|
|**執行個體**|*多重實例*<br /><br /> 可以同時開啟數個編輯器並編輯不同的檔案，而某些編輯器也允許在多個編輯器中開啟相同的檔案 (使用**視窗 > 新的視窗**命令) 。<br /><br /> 單一編輯器可能會同時編輯一個或多個檔案 ([專案設計工具]) 。|*單一或多重實例*<br /><br /> 內容會變更，以反映屬性瀏覽器) 的內容 (，或將焦點/內容推送至其他 windows (工作清單方案總管) 。<br /><br /> 單一實例和多重實例工具視窗都應該與使用中文件視窗相關聯，除非有極具說服力的理由不這麼做。|*單一實例*|
|**範例**|**文本**編輯器，例如程式碼編輯器<br /><br /> **設計表面**，例如表單設計工具或模型介面<br /><br /> **類似對話方塊的控制項版面**配置，例如資訊清單設計工具|**方案總管**提供解決方案和方案中包含的專案<br /><br /> **伺服器總管**會提供使用者在視窗中選擇要開啟的伺服器和資料連線的階層式視圖。 從資料庫階層開啟物件（例如查詢）時，會開啟文件視窗，並允許使用者編輯查詢。<br /><br /> **屬性瀏覽器**會顯示在文件視窗或其他工具視窗中選取之物件的屬性。 屬性會顯示在階層式格線視圖或複雜的對話型控制項中，並允許使用者設定這些屬性的值。||

## <a name="tool-windows"></a><a name="BKMK_ToolWindows"></a>工具視窗

### <a name="overview"></a>總覽
 工具視窗支援在文件視窗中發生的使用者工作。 它們可以用來顯示階層，此階層代表 Visual Studio 提供和可以操作的基本根物件。

 考慮到 IDE 中的新工具視窗時，作者應該：

- 使用工作適當的現有工具視窗，而不是使用類似的功能來建立新的。 只有在新的工具視窗提供明顯不同的「工具」或無法整合至類似視窗的功能，或將現有的視窗轉換成旋轉中樞時，才應該建立這個視窗。

- 如有需要，請在工具視窗的頂端使用標準命令列。

- 與其他工具視窗中已經存在的模式一致，可用於控制項呈現和鍵盤導覽。

- 與其他工具視窗中的控制項呈現一致。

- 檔特有的工具視窗應該會在可能的情況下自動顯示，使其只有在父檔啟用時才會出現。

- 確保其視窗內容可由鍵盤導覽 (支援方向鍵) 。

#### <a name="tool-window-states"></a>工具視窗狀態
 Visual Studio 工具視窗具有不同的狀態，其中有些是使用者啟動的 (，例如自動隱藏功能) 。 其他狀態（例如自動顯示）允許工具視窗出現在正確的內容中，並在不需要時隱藏。 總共有五個工具視窗狀態。

- 停駐 **/釘**選的工具視窗可以附加到檔區域的四個邊。 圖釘圖示會出現在工具視窗標題列中。 工具視窗可以在 shell 和其他工具視窗的邊緣水準或垂直停駐，而且也可以用 tab 鍵連結。

- **自動隱藏**工具視窗會取消固定。 視窗可以滑出看不見，讓索引標籤 (以工具視窗的名稱和其圖示) 在檔區域的邊緣。 當使用者將滑鼠停留在索引標籤上時，工具視窗會滑出。

- **自動可見**的工具視窗會在另一段 UI （例如編輯器）啟動或獲得焦點時自動顯示。

- **浮動**工具視窗將滑鼠停留在 IDE 外部。 這適用于多監視器設定。

- 索引標籤**式檔**工具視窗可以停駐在檔中。 這對於需要比停駐在框架邊緣的大型工具視窗（例如物件瀏覽器）很有用。

  ![Visual Studio 中的工具視窗狀態](../../extensibility/ux-guidelines/media/0702-01-toolwindowstates.png "0702-01_ToolWindowStates")

  **Visual Studio 中的工具視窗狀態**

#### <a name="single-instance-and-multi-instance"></a>單一實例和多重實例
 工具視窗可以是單一實例或多重實例。 某些單一實例工具視窗可能會與活動文件視窗相關聯，而多重實例工具視窗則不會。 多重實例工具視窗會藉由建立新的視窗實例，來回應 [視窗]/[新增視窗] 命令。 下圖說明當視窗的實例處於作用中狀態時，啟用 [新增視窗] 命令的工具視窗：

 ![Visual Studio 中啟用命令的工具視窗](../../extensibility/ux-guidelines/media/0702-02-toolwindowenablingcommand.png "0702-02_ToolWindowEnablingCommand")

 **當視窗的實例為使用中狀態時，啟用 [新增視窗] 命令的工具視窗**

 單一實例工具視窗可以隱藏或顯示，而多實例工具視窗則可以關閉和隱藏。 所有工具視窗都可以停駐、以 tab 連結、浮動或設定為多重文件介面 (MDI) 子視窗 (類似于文件視窗) 。 所有工具視窗都應該在 [視窗] 功能表中回應適當的視窗管理命令：

 ![Visual Studio 中的視窗管理命令](../../extensibility/ux-guidelines/media/0702-03-windowmanagementcontrols.png "0702-03_WindowManagementControls")

 **Visual Studio 視窗功能表中的視窗管理命令**

#### <a name="document-specific-tool-windows"></a>檔特有的工具視窗
 某些工具視窗的設計是根據指定的檔案類型來變更。 這些視窗會持續更新，以反映適用于 IDE 中活動文件視窗的功能。

 其內容變更為反映所選編輯器的工具視窗範例為 [工具箱] 和 [檔大綱]。 當編輯器的焦點不提供視窗內容時，這些視窗會顯示浮水印。

#### <a name="navigable-list-tool-windows"></a>可瀏覽清單工具視窗
 某些工具視窗會顯示使用者可以與之互動的可流覽專案清單。 在此類型的視窗中，即使視窗處於非使用中狀態，也應該一律會有清單中目前專案的意見反應。 此清單應該也會變更視窗中目前選取的專案，以回應**GoToNextLocation**和**GoToPrevLocation**命令

 [可瀏覽清單] 工具視窗是 [方案總管] 和 [尋找結果] 視窗的範例。

### <a name="tool-window-types"></a>工具視窗類型

#### <a name="common-tool-windows-and-their-functions"></a>通用工具視窗及其功能

|類型|工具視窗|函式|
|----------|-----------------|--------------|
|**階層**|方案總管|階層樹狀結構，可顯示專案、其他檔案和方案專案中包含的檔案清單。 專案內的專案顯示是由擁有專案類型的封裝所定義 (例如，以參考為基礎、目錄型或混合模式類型) 。|
|**階層**|類別檢視|在工作集檔中，類別和各種元素的階層樹狀結構，與檔案本身無關。|
|**階層**|Server Explorer|顯示解決方案中所有伺服器和資料連線的階層樹狀結構。|
|**階層**|文件大綱|現用檔的階層式結構。|
|**Grid**|屬性|此方格會顯示所選物件的屬性清單，以及用來編輯這些屬性的值選擇器。|
|**Grid**|工作清單|允許使用者建立/編輯/刪除工作和批註的方格。|
|**內容**|説明|可讓使用者從「如何？」取得協助的各種方法的視窗 MSDN 論壇的影片。|
|**內容**|動態說明|此工具視窗會顯示適用于目前選取範圍之說明主題的連結。|
|**內容**|物件瀏覽器|具有左窗格中階層式物件元件清單的兩個數據行框架組，以及右資料行中物件的屬性和方法。|
|**對話方塊**|尋找，先進尋找|可讓使用者在解決方案內的各種檔案中尋找或尋找和取代的對話方塊。|
|**其他**|工具箱|工具視窗用來儲存將放在設計介面上的專案，以提供所有設計工具的一致拖放來源。|
|**其他**|起始頁|使用者的入口網站，可讓您存取開發人員新聞、Visual Studio 說明和最近專案的摘要，以 Visual Studio。 使用者也可以建立自訂起始頁，方法是將 "Common7\IDE\StartPages\" Visual Studio program files 目錄中的 StartPage 檔案複製到 [Visual Studio documents] 目錄中的 [StartPages] 資料夾，然後在 Visual Studio 或其他程式碼編輯器中手動編輯或開啟 XAML。|
|調試**程式：** 一組專門用來調試工作和監視活動的 windows|自動||
|調試**程式：** 一組專門用來調試工作和監視活動的 windows|立即||
|調試**程式：** 一組專門用來調試工作和監視活動的 windows|輸出|每當您有要宣告的文字事件或狀態時，就可以使用 [輸出] 視窗。|
|調試**程式：** 一組專門用來調試工作和監視活動的 windows|記憶體||
|調試**程式：** 一組專門用來調試工作和監視活動的 windows|中斷點||
|調試**程式：** 一組專門用來調試工作和監視活動的 windows|執行中||
|調試**程式：** 一組專門用來調試工作和監視活動的 windows|文件||
|調試**程式：** 一組專門用來調試工作和監視活動的 windows|呼叫堆疊||
|調試**程式：** 一組專門用來調試工作和監視活動的 windows|本機||
|調試**程式：** 一組專門用來調試工作和監視活動的 windows|監控||
|調試**程式：** 一組專門用來調試工作和監視活動的 windows|反組譯碼||
|調試**程式：** 一組專門用來調試工作和監視活動的 windows|暫存器||
|調試**程式：** 一組專門用來調試工作和監視活動的 windows|Threads||

## <a name="document-editor-conventions"></a><a name="BKMK_DocumentEditorConventions"></a>檔編輯器慣例

### <a name="document-interactions"></a>檔互動
 「檔良好」是 IDE 內最大的空間，而且使用者通常已專注于完成其工作，並協助補充工具視窗。 檔編輯器代表使用者在 Visual Studio 中開啟和儲存的基本工作單位。 它們會保有與方案總管或其他作用中階層視窗相關的選取範圍。 使用者應該能夠指向其中一個階層視窗，並知道檔的所在位置，以及與方案、專案或 Visual Studio 封裝所提供的另一個根物件的關係。

 檔編輯需要一致的使用者體驗。 若要讓使用者專注于手上的工作，而不是視窗管理和尋找命令，請選取最適合用於編輯該檔案類型之使用者工作的檔視圖策略。

#### <a name="common-interactions-for-the-document-well"></a>檔 well 的一般互動

- 在常見的**新**檔案中維護一致的互動模型，並**開啟**檔案體驗。

- 當文件視窗開啟時，更新相關視窗和功能表中的相關功能。

- 功能表命令會適當地整合到一般功能表，例如 [**編輯**]、[**格式**] 和 [**視圖**] 功能表。 如果有大量的特製化命令可供使用，則可以建立新的功能表，只有在檔具有焦點時才會顯示。

- 內嵌工具列可以放在編輯器的頂端。 這是在編輯器之外出現另一個工具列的理想作法。

- 一律在 [方案總管或類似的 [作用中階層] 視窗中維持選取。

- 按兩下方案總管中的檔，應該會執行與**Open**相同的動作。

- 如果檔案類型上可以使用多個編輯器，使用者應該能夠使用 [**開啟方式**] 對話方塊，以滑鼠右鍵按一下檔案，然後從快捷方式功能表選取 [**開啟方式**]，來覆寫或重設指定檔案類型上的預設動作。

- 請勿在檔中建立 wizard。

### <a name="user-expectations-for-specific-document-types"></a>特定檔案類型的使用者預期
 檔編輯器有數個不同的基本類型，而且每個都有一組與相同類型之其他專案一致的互動。

- 以**文字為基礎的編輯器：程式**代碼編輯器，記錄檔

- **設計介面：** WPF 表單設計工具，Windows forms

- **對話方塊樣式編輯器：** 專案屬性、資訊清單設計工具

- **模型設計師：** 工作流程設計工具、codemap、架構圖表、進展

  也有數個非編輯器類型使用檔。 雖然它們不會自行編輯檔，但必須遵循文件視窗的標準互動。

- **報表：** IntelliTrace 報告，Hyper-v 報告，profiler 報告

- **儀表板：** 診斷中樞

#### <a name="text-based-editors"></a>以文字為基礎的編輯器

- 此檔會參與 [預覽] 索引標籤模型，允許預覽檔，而不需要開啟它。

- 檔的結構可能會在隨附的工具視窗中呈現，例如檔大綱。

- 如果適當的) 會與其他程式碼編輯器一致的行為，IntelliSense (。

- 快顯或輔助 UI 會遵循與現有類似 UI （例如 CodeLens）類似的樣式和模式。

- 檔狀態的相關訊息會顯示在檔頂端的資訊列控制項或狀態列中。

- 使用者必須能夠使用 [**工具] > [選項**] 頁面（[共用字型] 和 [色彩] 頁面），或編輯器特定的字型，自訂字型和色彩的外觀。

#### <a name="design-surfaces"></a>設計介面

- 空的設計工具在介面上應有浮水印，表示如何開始使用。

- 視圖切換機制會遵循現有的模式，例如按兩下以開啟程式碼編輯器，或在文件視窗中允許與這兩個窗格互動的索引標籤。

- 除非需要高度特定的工具視窗，否則將專案新增至設計介面時，應透過 [工具箱] 來完成。

- 介面上的專案會遵循一致的選取模型。

- 內嵌工具列只包含檔特定的命令，而不是一般的命令，例如 [**儲存**]。

#### <a name="dialog-style-editors"></a>對話方塊樣式編輯器

- 控制項配置應遵循正常的對話版面配置慣例。

- 編輯器中的索引標籤不應符合檔索引標籤的外觀，而應符合兩個允許之內部索引標籤樣式的其中一個。

- 使用者必須能夠僅使用鍵盤與控制項互動;藉由啟用編輯器，並依控制項或使用標準助憶鍵來執行 tab 鍵。

- 設計工具應該使用一般的儲存模型。 表面上不應放置整體的 [儲存] 或 [認可] 按鈕，但其他按鈕可能會適當。

#### <a name="model-designers"></a>模型設計師

- 空的設計工具在介面上應有浮水印，表示如何開始使用。

- 將專案加入至設計介面時，應該透過 [工具箱] 來完成。

- 介面上的專案會遵循一致的選取模型。

- 內嵌工具列只包含檔特定的命令，而不是一般的命令，例如 [**儲存**]。

- 圖例可能會出現在介面上，也就是指示或浮水印。

- 使用者必須能夠使用 [**工具] > [選項**] 頁面（[共用字型] 和 [色彩] 頁面，或編輯器特定的字型）來自訂字型/色彩的外觀。

#### <a name="reports"></a>報表

- 報表通常僅限資訊，並不會參與儲存模型。 不過，它們可能包括互動，例如其他相關資訊的連結，或展開和折迭的章節。

- 介面上大部分的命令都應該是超連結，而不是按鈕。

- 版面配置應該包含標頭，並遵循標準的報表配置指導方針。

#### <a name="dashboards"></a>儀表板

- 儀表板本身沒有互動模型，但做為提供各種其他工具的方法。

- 它們不會參與儲存模型。

- 使用者只能使用鍵盤與控制項互動，方法是啟用編輯器並依控制項的 tab 鍵或使用標準的助憶鍵。

## <a name="dialogs"></a><a name="BKMK_Dialogs"></a>對話

### <a name="introduction"></a>簡介
 Visual Studio 中的對話方塊通常會支援使用者工作的一個離散單位，然後予以關閉。

 如果您確定需要對話方塊，您有三個選擇，依喜好設定順序：

1. 將您的功能整合到 Visual Studio 中的其中一個共用對話方塊。

2. 使用在現有類似對話方塊中找到的模式，建立您自己的對話方塊。

3. 建立新的對話方塊，並遵循互動和版面配置方針。

   本主題描述如何在 Visual Studio 工作流程內選擇正確的對話模式，以及對話方塊設計的一般慣例。

### <a name="themes"></a>佈景主題
 Visual Studio 中的對話方塊會遵循下列兩種基本樣式之一：

#### <a name="standard-unthemed"></a>標準 (unthemed) 
 大部分的對話方塊都是標準的公用程式對話，應該 unthemed。 請勿重新範本通用控制項，或嘗試建立樣式化的 [新式] 按鈕或控制項。 控制項和 chrome 外觀遵循[適用于對話方塊的標準 Windows 桌面互動指導方針](https://msdn.microsoft.com/library/windows/desktop/dn742499\(v=vs.85\).aspx)。

#### <a name="themed"></a>主題
 特殊的「簽章」對話方塊可能會有主題。 主題對話具有不同的外觀，也有一些與樣式相關聯的特殊互動模式。 只有在符合下列需求時，才針對您的對話方塊進行主題：

- 對話是常見的體驗，經常會看到並使用，或由許多使用者 (例如 [**新增專案**] 對話方塊。

- 此對話方塊包含明顯的產品品牌要素 (例如，[**帳戶設定**] 對話方塊) 。

- 對話方塊會顯示為較大流程中的不可或缺部分，其中包含其他主題對話方塊 (例如，[**加入已連接服務**] 對話方塊) 。

- 對話是在升級或區分產品版本時扮演策略性角色之經驗的重要部分。

  建立主題對話時，請使用適當的環境色彩，並遵循正確的版面配置和互動模式。  (參閱[Visual Studio) 的版面](../../extensibility/ux-guidelines/layout-for-visual-studio.md)配置

### <a name="dialog-design"></a>對話方塊設計
 設計良好的對話方塊會考慮下列元素：

- 支援的使用者工作

- 對話文字樣式、語言和詞彙

- 控制選擇和 UI 慣例

- 視覺效果版面配置規格和控制項對齊

- 存取鍵盤

#### <a name="content-organization"></a>內容組織
 請考慮這些基本對話類型之間的差異：

- [簡單對話方塊](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_SimpleDialogs)會在單一強制回應視窗中呈現控制項。 簡報可能包含複雜控制項模式的變化，包括欄位選擇器或圖示列。

- 當一段 UI 包含多個控制項群組時，會使用[分層對話方塊](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_LayeredDialogs)來充分發揮螢幕的實際資產。 對話方塊的群組會透過索引標籤控制項、導覽清單控制項或按鈕來「分層」，讓使用者可以選擇要在任何指定時間看到的分組。

- 「檢查程式[」適用于](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_Wizards)將使用者的邏輯順序引導至完成工作的步驟。 連續面板中會提供一系列的選擇，有時會引進不同的工作流程 ( 「分支」 ) 相依于上一個面板中所做的選擇。

#### <a name="simple-dialogs"></a><a name="BKMK_SimpleDialogs"></a>簡單對話方塊
 簡單的對話是單一強制回應視窗中控制項的呈現方式。 這種呈現可能包括複雜控制項模式的變化，例如欄位選擇器。 針對簡單的對話方塊，請遵循標準一般版面配置，以及複雜控制項群組所需的任何特定版面配置。

 ![Visual Studio 中的簡單對話方塊](../../extensibility/ux-guidelines/media/0704-01-createstrongnamekey.png "0704-01_CreateStrongNameKey")

 **建立強式名稱金鑰是 Visual Studio 中簡單對話方塊的範例。**

#### <a name="layered-dialogs"></a><a name="BKMK_LayeredDialogs"></a>分層對話方塊
 分層對話方塊包含索引標籤、儀表板和內嵌樹狀結構。 當單一 UI 中提供多個控制項群組時，會使用它們來最大化房地產。 群組會分層，讓使用者可以選擇要在任何一次查看哪一個群組。

 在最簡單的情況下，在群組之間切換的機制是索引標籤控制項。 有數個替代方案可供使用。 請參閱優先順序和分層以瞭解如何選擇最適當的樣式。

 [**工具 > 選項**] 對話方塊是使用內嵌樹狀結構的多層式對話範例：

 ![Visual Studio 中的分層對話方塊](../../extensibility/ux-guidelines/media/0704-02-toolsoptions.png "0704-02_ToolsOptions")

 **[工具 > 選項] 是 Visual Studio 中分層對話方塊的範例。**

#### <a name="wizards"></a><a name="BKMK_Wizards"></a>借助
 當工作完成時，系統會引導使用者完成步驟的邏輯順序。 連續面板中會提供一系列的選擇，使用者必須繼續執行每個步驟，才能繼續進行下一步。 一旦有足夠的預設值，就會啟用 [**完成]** 按鈕。

 強制回應的工作會用於下列工作：

- 包含分支，視使用者選擇而定，會提供不同的路徑

- 包含步驟之間的相依性，而後續步驟則取決於上一個步驟中的使用者輸入 (s) 

- 非常複雜，應使用 UI 來說明所提供的選項，以及每個步驟中的可能結果。

- 是交易式的，需要在認可任何變更之前完整完成一組步驟

### <a name="common-conventions"></a>一般慣例
 若要使用對話達到最佳的設計和功能，請遵循下列慣例：對話方塊大小、位置、標準、控制設定和對齊、UI 文字、標題列、控制項按鈕和存取金鑰。

 如需版面配置特定的指導方針，請參閱[Visual Studio 的版面](../../extensibility/ux-guidelines/layout-for-visual-studio.md)配置。

#### <a name="size"></a>大小
 對話應符合最小的1024x768 螢幕解析度，而初始對話方塊大小不應超過900x700 圖元。 對話方塊可以是可調整大小的，但不是必要條件。

 可調整大小的對話方塊有兩個建議：

1. 大小下限是針對對話方塊定義的，它會針對控制集優化而不進行裁剪，並進行調整以配合合理的當地語系化成長。

2. 使用者調整的大小會從會話保留到會話。 例如，如果使用者將對話調整為150%，則後續啟動對話方塊會顯示在150%。

#### <a name="position"></a>位置
 第一次啟動時，對話方塊必須在 IDE 中顯示為中央。 對於不可調整大小的對話方塊，不需要保存對話的最後一個位置，因此它會在後續啟動時顯示在中央。 針對可調整大小的對話方塊，應該在後續啟動時保存大小。 針對具有模式的可調整大小對話方塊，不需要保存位置。 當使用者的顯示設定變更時，將其顯示在 IDE 中，可防止對話方塊出現在無法預期或無法使用的位置。 對於可以重新置放的非強制回應對話方塊，使用者的位置應該在後續啟動時維護，因為對話可能經常做為較大工作流程不可或缺的一部分。

 當對話必須產生其他對話時，最上層的對話應該從父系向右和向下重迭，讓使用者明顯地流覽至新的位置。

#### <a name="modality"></a>模態
 [強制回應] 表示使用者必須完成或取消對話方塊，才能繼續。 因為強制回應對話方塊會封鎖使用者與環境的其他部分互動，所以您的功能的工作流程應該盡可能謹慎使用它們。 當需要強制回應作業時，Visual Studio 有多個共用對話方塊，您可以將功能整合至其中。 如果您必須建立新的對話方塊，請遵循具有類似功能之現有對話的互動模式。

 當使用者需要同時執行兩個活動時（例如，在撰寫新程式碼時**尋找**和**取代**），對話方塊應該是非強制回應，讓使用者可以輕鬆地在其間切換。 Visual Studio 通常會針對這類編輯器支援連結的工作使用工具視窗。

#### <a name="control-configuration"></a>控制設定
 與現有的控制設定一致，這會在 Visual Studio 中達到相同的目的。

#### <a name="title-bars"></a>標題列

- 標題列中的文字必須反映啟動它的命令名稱。

- 對話方塊標題列中不應使用任何圖示。 在系統需要的情況下，請使用 Visual Studio 標誌。

- 對話方塊不應該有最小化或最大化的按鈕。

- 標題列中的 [說明] 按鈕已被取代。 請勿將它們新增至新的對話方塊。 當他們存在時，應該啟動與工作相關的說明主題。

  ![Visual Studio 的標題列規格](../../extensibility/ux-guidelines/media/0704-03-titlebarspecs.png "0704-03_TitleBarSpecs")

  **Visual Studio 對話方塊中標題列的指導方針規格。**

#### <a name="control-buttons"></a>控制項按鈕
 一般而言， **[確定] [** / **取消**說明] / **Help**按鈕應該在對話方塊的右下角水準排列。 如果對話方塊底部有數個其他按鈕會呈現與控制項按鈕的視覺混淆，則允許使用替代垂直堆疊。

 ![Visual Studio 中的控制項按鈕組態](../../extensibility/ux-guidelines/media/0704-04-controlbuttonconfig.png "0704-04_ControlButtonConfig")

 **Visual Studio 對話方塊中控制項按鈕的可接受設定**

 對話方塊必須包含預設的控制項按鈕。 若要判斷做為預設值使用的最佳命令，請從下列選項中選擇 (依優先順序) 順序列出：

- 選擇最安全且最安全的命令做為預設值。 這表示選擇最可能防止資料遺失的命令，並避免非預期的系統存取。

- 如果資料遺失和安全性不是因素，請根據便利性選擇預設命令。 當對話方塊支援經常或重複性的工作時，包含最可能的命令做為預設值，將可改善使用者的工作流程。

  請避免為預設命令選擇永久破壞性動作。 如果有這類命令，請改為選擇更安全的命令做為預設值。

#### <a name="access-keys"></a>便捷鍵
 請勿使用 **[確定]** / **取消**說明按鈕的存取金鑰 / **Help** 。 根據預設，這些按鈕會對應到快速鍵：

|按鈕名稱|鍵盤快速鍵|
|-----------------|-----------------------|
|確定|Enter|
|取消|Esc|
|説明|F1|

#### <a name="imagery"></a>栩栩如生
 在對話方塊中謹慎使用影像。 請不要在對話方塊中使用大圖示，只是使用空間。 只有在將訊息傳達給使用者時（例如警告圖示或狀態動畫）很重要時，才使用影像。

### <a name="prioritizing-and-layering"></a><a name="BKMK_PrioritizingAndLayering"></a>排序和分層

#### <a name="prioritizing-your-ui"></a>排列 UI 的優先順序
 您可能必須將某些 UI 元素帶入 forefront，並放置更先進的行為和選項 (包括) 到對話方塊中的隱匿命令。 將常用的功能帶入 forefront，方法是為它騰出空間，並在顯示對話方塊時，以文字標籤顯示在 UI 中。

#### <a name="layering-your-ui"></a>分層您的 UI
 如果您已判定某個對話方塊是必要的，但是您想要呈現給使用者的相關功能超出可在簡單對話方塊中顯示的內容，則您需要將 UI 分層。 Visual Studio 使用的最常見分層方法是索引標籤和走廊或儀表板。 在某些情況下，可以展開和折迭的區域可能是適當的。 在 Visual Studio 中，通常不建議使用調適型 UI。

 透過類似索引標籤的控制項，對不同的分層 UI 方法有一些優點和缺點。 請參閱下列清單，以確保您選擇適合您情況的分層技術。

##### <a name="tabbing"></a>定位處理

|切換機制|優點和適當用法|缺點和不當使用|
|-------------------------|------------------------------------|-----------------------------------------|
|索引標籤控制項|以邏輯方式將對話頁面分組到相關集合<br /><br /> 適用于五個以上的 (，或在對話方塊中符合一個資料列的索引標籤數目，) 頁面的相關控制項<br /><br /> 定位字元標籤必須是簡短的：一或兩個可輕鬆識別內容的單字<br /><br /> 通用系統對話方塊樣式<br /><br /> 範例： **File Explorer > 專案屬性**|使描述性的簡短標籤變得很棘手<br /><br /> 通常不會在單一對話方塊中調整過去五個索引標籤<br /><br /> 如果一個資料列有太多索引標籤，則不適合;使用替代的分層技術<br /><br /> 不可延伸|
|提要欄位導覽|可容納比索引標籤更多類別的簡單切換裝置<br /><br />  (沒有階層的一般分類清單) <br /><br /> 可延伸<br /><br /> 範例：**自訂 ... > 新增命令**|如果少於三個群組，則不適合使用水準空格<br /><br /> 工作可能較適合下拉式|
|樹狀控制項|允許無限制的類別<br /><br /> 允許類別目錄的群組和/或階層<br /><br /> 可延伸<br /><br /> 範例：**工具 > 選項**|大量嵌套的階層可能會導致過多的水準滾動<br /><br /> Visual Studio 具有樹狀檢視的 overabundance|
|精靈|藉由逐步執行以工作為基礎的順序步驟，協助完成工作。 此 wizard 代表高階工作，而個別面板代表完成整體工作所需的子工作。<br /><br /> 當工作跨越 Ui 界限時很有用，如同使用者在其他情況下必須使用多個編輯器和工具視窗來完成工作一樣<br /><br /> 當工作需要分支時很有用<br /><br /> 當工作包含步驟之間的相依性時很有用<br /><br /> 當有數個類似的工作在一個對話方塊中呈現，以減少不同類似對話的數目時，就很有用。|不適合不需要連續工作流程的任何工作<br /><br /> 因為有太多步驟，所以使用者可能會變得龐大並困惑<br /><br /> 在本質上，我們有有限的螢幕畫面|

##### <a name="hallways-or-dashboards"></a>走廊或儀表板
 走廊和儀表板是對話或面板，可作為其他對話方塊和視窗的啟動點。 設計良好的「走廊」會立即呈現最常見的選項、命令和設定，讓使用者可以輕鬆完成一般工作。 就像真實世界的走廊提供門口來存取它們背後的房間，這裡較不常用的 UI 會收集到個別的「房間」， (通常是其他對話) 可從主要走廊存取的相關功能。

 或者，在單一集合中提供所有可用功能的 UI，而不是將較不常用的功能重構到不同的位置，只是一個儀表板。

 ![Outlook 中的 Hallway 概念](../../extensibility/ux-guidelines/media/0704-08-hallway.png "0704-08_Hallway")

 **在 Outlook 中公開其他 UI 的走廊概念**

##### <a name="adaptive-ui"></a>彈性 UI
 顯示或隱藏以使用量為基礎的 UI 或使用者的自我回報體驗，是另一種呈現必要 UI，同時隱藏其他部分的方式。 在 Visual Studio 中，我們不建議您這麼做，因為用來決定何時要顯示或隱藏 UI 的演算法可能有點棘手，而在某些情況下，規則一律會是錯誤的。

## <a name="projects"></a><a name="BKMK_Projects"></a>投影

### <a name="projects-in-the-solution-explorer"></a>方案總管中的專案
 大部分專案都會分類為參考型、目錄型或混合式。 方案總管中同時支援三種類型的專案。 使用專案的使用者體驗的根，會發生在這個視窗內。 雖然不同的專案節點是參考、目錄或混合模式的類型專案，但有一種常見的互動模式，應該先套用做為起點，再分叉為專案特定的使用者模式。

 專案應一律：

- 支援加入專案資料夾來組織專案內容的功能

- 維護專案持續性的一致模型

  專案也應該維護的一致互動模型：

- 移除專案專案

- 儲存檔

- 專案屬性編輯

- 在替代視圖中編輯專案

- 拖放作業

### <a name="drag-and-drop-interaction-model"></a>拖放互動模型
 專案通常會將本身分類為以參考為基礎的 (能夠只保存儲存) 中專案專案的參考、目錄型 (只能保存實際儲存在專案階層) 中的專案專案，或混合 (能夠保存參考或實體專案) 。 IDE 會在**方案總管**內同時容納所有三種類型的專案。

 從拖放的觀點來看，下列特性應套用至**方案總管**內的每一種專案類型：

- 以**參考為基礎的專案：** 重點在於，專案會在儲存體中的專案參考周圍拖曳。 當以參考為基礎的專案作為移動作業的來源時，它應該只會從專案中移除專案的參考。 專案實際上不應從硬碟中刪除。 當以參考為基礎的專案做為 move (或 copy) 作業的目標時，它應該加入原始來源專案的參考，而不建立專案的私用複本。

- 以**目錄為基礎的專案：** 從拖放的角度來看，專案會在實體專案的周圍拖曳，而不是參考。 當以目錄為基礎的專案做為移動作業的來源時，它最後應該會從硬碟中刪除實體專案，並將它從專案中移除。 當以目錄為基礎的專案做為移動 (或複製) 作業的目標時，應該在其目標位置中建立來源專案的複本。

- **混合目標專案：** 從拖放的角度來看，這個專案類型的行為是根據所拖曳專案的本質， (對儲存體中的專案或專案本身) 的參考。 參考和實體專案的正確行為如上所述。

  如果**方案總管**中只有一種專案類型，則拖放作業會很簡單。 由於每個專案系統都能夠定義自己的拖放行為，因此 (根據 Windows Explorer 拖放行為的特定方針) 應遵循，以確保可預測的使用者體驗：

- 在**方案總管** (中未修改的拖曳作業，當 Ctrl 或 Shift 鍵不是按住) 時，就會產生移動作業。

- Shift 拖曳作業也應該導致移動作業。

- Ctrl 拖曳作業應該會產生複製作業。

- 以參考為基礎的專案系統支援將連結 (或參考) 新增至來源專案的概念。 當這些專案是拖放作業的目標時 (當**Ctrl + Shift**向下) 時，應該會導致專案的參考新增至專案

  並非所有拖放作業都可以在以參考為基礎、目錄型和混合專案的組合之間有意義。 特別的是，假設在目錄型來源專案和參考型目標專案之間允許移動作業會有問題，因為以來原始目錄為基礎的專案必須在移動完成時刪除來源專案。 以目標參考為基礎的專案最後會參考已刪除的專案。

  它也會誤導，以允許在這些專案類型之間進行複製作業，因為以目標參考為基礎的專案不應建立來源專案的獨立複本。 同樣地，不應允許 Ctrl + Shift 拖曳到目錄型目標專案，因為以目錄為基礎的專案無法保存參考。 在不支援拖放作業的情況下，IDE 應該不允許卸載，並向使用者顯示不會出現的游標 () 下方的指標表中顯示。

  為了正確地執行拖放行為，拖曳的來源專案必須與它的本質 (，例如，它是參考或目錄型？ ) 至目標專案。 這項資訊是由來源所提供的剪貼簿格式所表示。 做為拖曳 (或剪貼簿複製作業的來源) 專案應分別提供**CF_VSREFPROJECTITEM**S 或**CF_VSSTGPROJECTITEMS** ，視專案是參考型還是以目錄為基礎而定。 這兩種格式都具有相同的資料內容，類似于 Windows **CF_HDROP**格式，但字串清單（而不是檔案名）是以 double**Null**終止的**Projref**字串清單， (如**IVsSolution：： GetProjrefOfItem**或 **：： GetProjrefOfProject**從適當的) 傳回。

  做為 drop (或剪貼簿貼上作業) 的目標時，專案應該同時接受**CF_VSREFPROJECTITEMS**和**CF_VSSTGPROJECTITEMS**，雖然拖放作業的確切處理會根據目標專案和來源專案的本質而有所不同。 來源專案會根據它是否提供**CF_VSREFPROJECTITEMS**或**CF_VSSTGPROJECTITEMS**來宣告其本質。 捨棄的目標會瞭解它自己的本質，因此有足夠的資訊可決定是否要執行移動、複製或連結。 使用者也會藉由按 Ctrl、Shift 或 Ctrl 和 Shift 鍵來修改應該執行的拖放作業。 放置目標必須適當地指示將在其**system.windows.dragdrop.dragenter>** 和**system.windows.dragdrop.dragover>** 方法中預先執行的作業，這點很重要。 **方案總管**會自動知道來源專案和目標專案是否為相同的專案。

  將專案專案拖曳到 Visual Studio 的實例 (例如，從一個 devenv.exe 實例到另一個) 是特別不支援的。 **方案總管**也會直接停用此。

  使用者應該一律能夠判斷拖放作業的效果，方法是選取專案、將它拖曳至目標位置，並觀察下列哪一個滑鼠指標出現在專案卸載之前：

|滑鼠指標|Command|描述|
|-------------------|-------------|-----------------|
|![滑鼠「不置放」圖示](../../extensibility/ux-guidelines/media/0706-01-mousenodrop.png "0706-01_MouseNoDrop")|不捨棄|無法將專案拖放到指定的位置。|
|![滑鼠「複製」圖示](../../extensibility/ux-guidelines/media/0706-02-mousecopy.png "0706-02_MouseCopy")|複製|專案將會複製到目標位置。|
|![滑鼠「移動」圖示](../../extensibility/ux-guidelines/media/0706-03-mousemove.png "0706-03_MouseMove")|移動|專案將會移至目標位置。|
|![滑鼠「加入參考」圖示](../../extensibility/ux-guidelines/media/0706-04-mouseaddref.png "0706-04_MouseAddRef")|新增參考|所選取專案的參考將會新增至目標位置。|

#### <a name="reference-based-projects"></a>以參考為基礎的專案
 下表摘要說明拖放 (，以及剪下/複製/貼上) 作業，這些作業應根據來源專案的本質和針對以參考為基礎的目標專案所按的輔助按鍵而執行：

|修飾詞|作業|來源專案：參考/連結|來源專案：實體專案或檔案系統 (CF_HDROP) |
|-|-|----------------------------------|-------------------------------------------------------------|
|無修飾詞|動作|移動|連結|
|無修飾詞|目標|將參考加入至原始專案|將參考加入至原始專案|
|無修飾詞|來源|刪除原始專案的參考|保留原始專案|
|無修飾詞|結果|從下列位置傳回**DROPEFFECT_MOVE** **：:D rop** ，而專案會保留在儲存體中的原始位置|從下列位置傳回**DROPEFFECT_LINK** **：:D rop** ，而專案會保留在儲存體中的原始位置|
|Shift + 拖曳|動作|移動|不捨棄|
|Shift + 拖曳|目標|將參考加入至原始專案|不捨棄|
|Shift + 拖曳|來源|刪除原始專案的參考|不捨棄|
|Shift + 拖曳|結果|從下列位置傳回**DROPEFFECT_MOVE** **：:D rop** ，而專案會保留在儲存體中的原始位置|不捨棄|
|Ctrl + 拖曳|動作|複製|不捨棄|
|Ctrl + 拖曳|目標|將參考加入至原始專案|不捨棄|
|Ctrl + 拖曳|來源|保留原始專案的參考|不捨棄|
|Ctrl + 拖曳|結果|從下列位置傳回**DROPEFFECT_COPY** **：:D rop** ，而專案會保留在儲存體中的原始位置|不捨棄|
|Ctrl + Shift + 拖曳|動作|連結|連結|
|Ctrl + Shift + 拖曳|目標|將參考加入至原始專案|將參考加入至原始專案|
|Ctrl + Shift + 拖曳|來源|保留原始專案的參考|保留原始專案|
|Ctrl + Shift + 拖曳|結果|從下列位置傳回**DROPEFFECT_LINK** **：:D rop** ，而專案會保留在儲存體中的原始位置|從下列位置傳回**DROPEFFECT_LINK** **：:D rop** ，而專案會保留在儲存體中的原始位置|
|Ctrl + Shift + 拖曳|注意|與 Windows Explorer 快捷方式的拖放行為相同。||
|剪下/貼上|動作|移動|連結|
|剪下/貼上|目標|將參考加入至原始專案|將參考加入至原始專案|
|剪下/貼上|來源|保留原始專案的參考|保留原始專案|
|剪下/貼上|結果|專案會保留在儲存體中的原始位置|專案會保留在儲存體中的原始位置|
|複製/貼上|動作|複製|連結|
|複製/貼上|來源|將參考加入至原始專案|將參考加入至原始專案|
|複製/貼上|結果|保留原始專案的參考|保留原始專案|
|複製/貼上|動作|專案會保留在儲存體中的原始位置|專案會保留在儲存體中的原始位置|

#### <a name="directory-based-projects"></a>以目錄為基礎的專案
 下表摘要說明拖放 (，以及剪下/複製/貼上) 作業，應根據針對以目錄為基礎的目標專案所按的來源專案和輔助按鍵的本質來執行：

|修飾詞|作業|來源專案：參考/連結|來源專案：實體專案或檔案系統 (CF_HDROP) |
|-|-|----------------------------------|-------------------------------------------------------------|
|無修飾詞|動作|移動|移動|
|無修飾詞|目標|將專案複製到目標位置|將專案複製到目標位置|
|無修飾詞|來源|刪除原始專案的參考|刪除原始專案的參考|
|無修飾詞|結果|**DROPEFFECT_ MOVE**會當做 action 傳回 **：:D rop** ，而專案會保留在儲存體中的原始位置|**DROPEFFECT_ MOVE**會當做 action 傳回 **：:D rop** ，而專案會保留在儲存體中的原始位置|
|Shift + 拖曳|動作|移動|移動|
|Shift + 拖曳|目標|將專案複製到目標位置|將專案複製到目標位置|
|Shift + 拖曳|來源|刪除原始專案的參考|從原始位置刪除專案|
|Shift + 拖曳|結果|**DROPEFFECT_ MOVE**會當做 action 傳回 **：:D rop** ，而專案會保留在儲存體中的原始位置|**DROPEFFECT_ MOVE**會當做 action 傳回 **：:D rop** ，而專案會保留在儲存體中的原始位置|
|Ctrl + 拖曳|動作|複製|複製|
|Ctrl + 拖曳|目標|將專案複製到目標位置|將專案複製到目標位置|
|Ctrl + 拖曳|來源|保留原始專案的參考|保留原始專案的參考|
|Ctrl + 拖曳|結果|從下列位置傳回**DROPEFFECT_ 複製** **：:D rop** ，而專案會保留在儲存體中的原始位置|從下列位置傳回**DROPEFFECT_ 複製** **：:D rop** ，而專案會保留在儲存體中的原始位置|
|Ctrl + Shift + 拖曳||不捨棄|不捨棄|
|剪下/貼上|動作|移動|移動|
|剪下/貼上|目標|將專案複製到目標位置|將專案複製到目標位置|
|剪下/貼上|來源|刪除原始專案的參考|從原始位置刪除專案|
|剪下/貼上|結果|專案會保留在儲存體中的原始位置|已從儲存體中的原始位置刪除專案|
|複製/貼上|動作|複製|複製|
|複製/貼上|目標|將參考加入至原始專案|將專案複製到目標位置|
|複製/貼上|來源|保留原始專案|保留原始專案|
|複製/貼上|結果|專案會保留在儲存體中的原始位置|專案會保留在原始位置儲存體中|

#### <a name="mixed-target-projects"></a>混合目標專案
 下表摘要說明拖放 (，以及剪下/複製/貼上) 作業，應根據針對混合目標專案所按的來源專案和輔助按鍵的本質來執行：

|修飾詞|作業|來源專案：參考/連結|來源專案：實體專案或檔案系統 (CF_HDROP) |
|-|-|----------------------------------|-------------------------------------------------------------|
|無修飾詞|動作|移動|移動|
|無修飾詞|目標|將參考加入至原始專案|將專案複製到目標位置|
|無修飾詞|來源|刪除原始專案的參考|刪除原始專案的參考|
|無修飾詞|結果|**DROPEFFECT_ MOVE**會當做 action 傳回 **：:D rop** ，而專案會保留在儲存體中的原始位置|**DROPEFFECT_ MOVE**會當做 action 傳回 **：:D rop** ，並從儲存體中的原始位置刪除專案|
|Shift + 拖曳|動作|移動|移動|
|Shift + 拖曳|目標|將參考加入至原始專案|將專案複製到目標位置|
|Shift + 拖曳|來源|刪除原始專案的參考|從原始位置刪除專案|
|Shift + 拖曳|結果|**DROPEFFECT_ MOVE**會當做 action 傳回 **：:D rop** ，而專案會保留在儲存體中的原始位置|**DROPEFFECT_ MOVE**會當做 action 傳回 **：:D rop** ，並從儲存體中的原始位置刪除專案|
|Ctrl + 拖曳|動作|複製|複製|
|Ctrl + 拖曳|目標|將參考加入至原始專案|將專案複製到目標位置|
|Ctrl + 拖曳|來源|保留原始專案的參考|保留原始專案|
|Ctrl + 拖曳|結果|從下列位置傳回**DROPEFFECT_ 複製** **：:D rop** ，而專案會保留在儲存體中的原始位置|從下列位置傳回**DROPEFFECT_ 複製** **：:D rop** ，而專案會保留在儲存體中的原始位置|
|Ctrl + Shift + 拖曳|動作|連結|連結|
|Ctrl + Shift + 拖曳|目標|將參考加入至原始專案|將參考加入至原始來源專案|
|Ctrl + Shift + 拖曳|來源|保留原始專案的參考|保留原始專案|
|Ctrl + Shift + 拖曳|結果|從下列位置傳回**DROPEFFECT_ 連結** **：:D rop** ，而專案會保留在儲存體中的原始位置|從下列位置傳回**DROPEFFECT_ 連結** **：:D rop** ，而專案會保留在儲存體中的原始位置|
|剪下/貼上|動作|移動|移動|
|剪下/貼上|目標|將專案複製到目標位置|將專案複製到目標位置|
|剪下/貼上|來源|刪除原始專案的參考|從原始位置刪除專案|
|剪下/貼上|結果|專案會保留在儲存體中的原始位置|已從儲存體中的原始位置刪除專案|
|複製/貼上|動作|複製|複製|
|複製/貼上|目標|將參考加入至原始專案|將專案複製到目標位置|
|複製/貼上|來源|保留原始專案|保留原始專案|
|複製/貼上|結果|專案會保留在儲存體中的原始位置|專案會保留在儲存體中的原始位置|

 在**方案總管**中執行拖曳時，應將這些詳細資料納入考慮：

- 針對多個選取案例進行設計。

-  (完整路徑) 的檔案名在目標專案中必須是唯一的，否則不應允許放置。

- 資料夾名稱必須是唯一的， (不區分大小寫的) 。

- 在拖曳時開啟或關閉的檔案，在) 以上的案例中未提及時，會有一些行為上的差異 (。

- 最上層檔案的行為與資料夾中的檔案稍有不同。

  另一個要注意的問題是，如何處理已開啟設計工具或編輯器之專案上的移動作業。 預期的行為如下所示 (這適用于) 的所有專案類型：

1. 如果開啟的編輯器/設計工具沒有任何未儲存的變更，則應該以無訊息模式關閉編輯器/設計工具視窗。

2. 如果 [開啟編輯器]/[設計工具] 具有未儲存的變更，則拖曳的來源應該等候卸載，然後要求使用者在關閉視窗前，先將未認可的變更儲存在開啟的檔中，然後才會出現類似下面的提示：

   ```
   ==========================================================
        One or more open documents have unsaved changes.
   Do you want to save uncommitted changes before proceeding?
                     [Yes]  [No]  [Cancel]
   ==========================================================
   ```

   這讓使用者有機會在目標建立其複本之前，先儲存進行中的工作。 已加入新的方法**IVsHierarchyDropDataSource2：： OnBeforeDropNotify**以啟用此處理。

   目標會接著複製專案在儲存體中的狀態，而如果使用者選擇 [) **否**]，則不會在編輯器中包含未儲存的變更 (。 在目標完成其複製 (在**IVsHierarchyDropDataSource：:D rop**) 中，來源會有機會完成移動作業的刪除部分， (在**IVsHierarchyDropDataSource：： OnDropNotify**) 中。

   任何具有未儲存之變更的編輯器都應該保持開啟。 對於具有未儲存之變更的檔，這表示將會執行移動作業的複製部分，但刪除部分將會中止。 在多重選取案例中，當使用者選擇 [**否**] 時，不應關閉或移除具有未儲存之變更的檔，但必須關閉並移除沒有未儲存之變更的檔。
