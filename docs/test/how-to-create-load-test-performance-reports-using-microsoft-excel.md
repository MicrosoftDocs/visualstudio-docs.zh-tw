---
title: 使用 Microsoft Excel 建立負載測試效能報表
ms.date: 10/19/2016
ms.topic: conceptual
helpviewer_keywords:
- load tests, creating Excel reports
- load tests, reporting
ms.assetid: b87fb196-9973-4512-a924-088788def4ea
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: 8134d2652c1654a65ac303838bd1209a5d061bd0
ms.sourcegitcommit: cc841df335d1d22d281871fe41e74238d2fc52a6
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/18/2020
ms.locfileid: "75589067"
---
# <a name="how-to-create-load-test-performance-reports-using-microsoft-excel"></a>如何：使用 Microsoft Excel 建立負載測試效能報告

您可以根據兩個或多個測試結果，產生 Microsoft Excel 負載測試報告。

[!INCLUDE [web-load-test-deprecated](includes/web-load-test-deprecated.md)]

共有兩種負載測試報告可供使用：

- **執行比較**：這會建立一組報告，這些報告會使用表格和橫條圖比較兩個負載測試結果中的資料。

- **趨勢**：您可以為兩個以上的負載測試結果產生趨勢分析。 結果會以折線圖顯示，但也可以利用樞紐分析表使用資料。

> [!TIP]
> 您也可以透過從摘要檢視、圖形檢視和資料表檢視複製並貼上資料，手動建立 Microsoft Word 報告。 請參閱[如何：使用 Microsoft Word 手動建立負載測試效能報告](../test/how-to-manually-create-a-load-test-performance-report-using-microsoft-word.md)。

上述兩種報告都能用來與專案關係人共用效能資料，傳達出整體效能和系統的健康狀況是變好還是變差。

報告定義儲存在負載測試資料庫中。 儲存報告時，報告的定義是儲存在資料庫中，稍後可以重複使用。

此外，也能和專案關係人共用 Excel 活頁簿，因此專案關係人不必連接至資料庫就能查看報告。

> [!NOTE]
> 您可以共用 Excel 活頁簿，不過只有電腦上已安裝 Visual Studio 的使用者能夠修改任何試算表。 其他使用者不會在 [Office]**** 功能區中看見 [負載測試報告]****，但是可以檢視活頁簿。

下圖是顯示異動 (更新購物車) 速度下降和 (% Processor) 計數器變差之相關性的報告範例。 這指出應用程式的程式碼可能出現問題，而不是資料庫或網路問題，而且是使用 ASP.NET 分析工具診斷的絕佳候選對象。

![應用程式程式碼中的潛在問題](../test/media/lt_excel.png)

產生 Excel 報表的方法包括：在 [負載測試分析器]**** 中使用工具列的 [建立 Excel 報表]**** 按鈕，或在 Excel 中使用 [Office]**** 功能區的 [負載測試]**** 索引標籤中的 [負載測試報告]**** 選項。

> [!NOTE]
> 如果您將註解新增至負載測試，這些註解就會顯示在 Excel 報表中。

## <a name="to-generate-load-test-comparison-reports-using-excel"></a>若要使用 Excel 產生負載測試比較報告

1. 在產生報告前，首先您必須執行負載測試。

2. 有兩種方式可以建立 Excel 負載測試報告：

   - 完成負載測試後，在 [負載測試結果]**** 頁面中，選擇工具列的 [建立 Excel 報表]**** 按鈕。

      > [!NOTE]
      > 如果在**Web 效能測試結果檢視器**工具列中禁用"**創建 Excel 報告**"按鈕，則可能需要在啟用 Microsoft Excel 之前運行一次。 安裝 Visual Studio Enterprise 時，會將 Visual Studio Enterprise 負載測試增益集複製到您的電腦以供 Microsoft Excel 使用，但這個增益集的安裝程序要到執行 Microsoft Excel 後才算完成。

      Microsoft Excel 隨即開啟 [產生負載測試報告精靈]****。

   **或**

   1. 開啟 Microsoft Excel，選取 [Office]**** 功能區中的 [負載測試]**** 索引標籤，然後選擇 [負載測試報告]****。

       [產生負載測試報告精靈]**** 隨即出現。

   2. 在 [選取包含負載測試的資料庫]**** 頁面的 [伺服器名稱]**** 下，鍵入包含負載測試結果的伺服器名稱。

   3. 在 [資料庫名稱]**** 下拉式清單中，選取包含負載測試結果的資料庫。

3. 在 [您要如何產生報告?]**** 頁面中確認已選取 [建立報告]****，然後選擇 [下一步]****。

4. 在 [您要產生哪一種報告?]**** 頁面中確認已選取 [執行比較]****，然後選擇 [下一步]****。

5. 在 [輸入負載測試報告詳細資料]**** 頁面的 [報告名稱]**** 中，鍵入報告的名稱。

6. 選取要產生報告的負載測試，然後選擇 [下一步]****。

7. 在 [選取報告的回合]**** 頁面的 [選取一或多個要新增報告的回合]**** 下方，選取您要在報告中比較的兩個負載測試結果，然後選擇 [下一步]****。

   > [!NOTE]
   > 您只能為兩個負載測試結果產生比較報告。 如果選取一個或超過兩個的負載測試結果，則會出現警告訊息。

8. 在"**選擇報表頁的計數器**"中，**在"選擇一個或多個計數器以添加到報表**"下，可以使用可展開的計數器清單自訂報表。 在報告中，從兩個已選取之測試回合選取您要比較的計數器，然後選擇 [完成]****。

9. 隨即產生 Excel 活頁簿報告，其中包含下列試算表索引標籤：

   - **目錄** - 顯示負載測試報告名稱，並提供可連結至報告中各索引標籤的目錄。

   - **回合** - 提供報告中兩個進行比較之回合的詳細資料。

   - **測試比較** - 提供兩個比較回合間效能衰退和改進的橫條圖詳細資料。

   - **頁面比較** - 提供兩個回合在各測試回合頁面上的橫條圖和百分比效能比較資料。

   - **電腦比較** - 根據所使用電腦，提供兩個回合間的比較資料。

   - **錯誤比較** - 比較兩個回合間所遇到的錯誤類型以及發生次數。

     > [!TIP]
     > 為求較佳的報告效果，負載測試和 Web 效能測試可使用一些屬性，以提供較豐富的報告。 頁面要求有兩個屬性會呈現在報告中：目標和報告名稱。 針對目標報告的是頁面回應時間，另外報告中會使用報告名稱而非 URL。 在負載測試回合設定的 [管理計數器集合] 下方，[電腦標記] 屬性會以報告電腦名稱表示。 此屬性很適合在報告中用來描述特定電腦的角色。

## <a name="to-generate-load-test-trend-reports-using-excel"></a>若要使用 Excel 產生負載測試趨勢報告

1. 在產生報告前，您必須先執行負載測試。

2. 有兩種方式可以建立 Excel 負載測試報告：

   - 完成負載測試後，在 [負載測試結果]**** 頁面中，選擇工具列的 [建立 Excel 報表]**** 按鈕。

      > [!NOTE]
      > 如果在**Web 效能測試結果檢視器**工具列中禁用"**創建 Excel 報告**"按鈕，則可能需要在啟用 Microsoft Excel 之前運行一次。 安裝 Visual Studio Enterprise 時，會將 Visual Studio Enterprise 負載測試增益集複製到您的電腦以供 Microsoft Excel 使用，但這個增益集的安裝程序要到執行 Microsoft Excel 後才算完成。

      Microsoft Excel 隨即開啟 [產生負載測試報告精靈]****。

   **或**

   1. 開啟 Microsoft Excel，選取 [Office]**** 功能區中的 [負載測試]**** 索引標籤，然後選擇 [負載測試報告]****。

       [產生負載測試報告精靈]**** 隨即出現。

   2. 在 [選取包含負載測試的資料庫]**** 頁面的 [伺服器名稱]**** 下，鍵入包含負載測試結果的伺服器名稱。

   3. 在 [資料庫名稱]**** 下拉式清單中，選取包含負載測試結果的資料庫。

3. 在 [您要如何產生報告?]**** 頁面中確認已選取 [建立報告]****，然後選擇 [下一步]****。

4. 在 [您要產生哪一種報告?]**** 頁面中確認已選取 [趨勢]****，然後選擇 [下一步]****。

5. 在 [輸入負載測試報告詳細資料]**** 頁面的 [報告名稱]**** 中，鍵入報告的名稱。

6. 選取要產生報告的負載測試，然後選擇 [下一步]****。

7. 在 [選取報告的回合]**** 頁面的 [選取一或多個要新增報告的回合]**** 下方，選取您要在報告中比較的負載測試結果，然後選擇 [下一步]****。

8. 在 [選取報告的計數器]**** 頁面的 [選取一或多個要新增報告的計數器]**** 下方，有一個可展開的計數器清單，可以用來自訂您的報告。 選取您要比較以進行趨勢分析的計數器，然後選擇 [完成]****。

9. 隨即產生報告，其中的目錄可連結至報告中產生的各個 Excel 活頁簿索引標籤。 這些連結是以針對趨勢報告所選取的計數器為依據。 例如，如果您選取步驟 7 中的預設計數器，則報告會根據步驟 7 列出的每個計數器，在不同的 Excel 索引標籤中呈現資料。 針對每個計數器所產生的資料，會以趨勢樣式圖表呈現。

   > [!TIP]
   > 為求較佳的報告效果，負載測試和 Web 效能測試可使用一些屬性，以提供較豐富的報告。 頁面要求有兩個屬性會呈現在報告中：目標和報告名稱。 針對目標報告的是頁面回應時間，另外報告中會使用報告名稱而非 URL。 在負載測試回合設定的 [管理計數器集合] 下方，[電腦標記] 屬性會以報告電腦名稱表示。 此屬性很適合在報告中用來描述特定電腦的角色。

## <a name="net-security"></a>.NET 安全性

負載測試結果和報告都含有潛在的敏感性資訊，可能會被用來對您的電腦或網路進行攻擊。 因為負載測試結果和報告都含有電腦名稱和連接字串， 所以當您與其他人共用負載測試報告時，請務必了解這點。

## <a name="see-also"></a>另請參閱

- [針對測試比較或趨勢分析報告負載測試結果](../test/compare-load-test-results.md)
