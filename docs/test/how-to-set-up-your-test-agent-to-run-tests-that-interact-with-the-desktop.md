---
title: 設定測試代理程式
description: 瞭解如何藉由設定您的代理程式來以進程（而非服務）的形式執行，來執行與桌面互動的自動化測試。
ms.custom: SEO-VS-2020
ms.date: 09/18/2018
ms.topic: how-to
helpviewer_keywords:
- agents, configuring for interaction with desktop
ms.assetid: 3a94dd07-6d17-402c-ae8f-7947143755c9
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.openlocfilehash: 13949465677301a336f0a4738e903657dbfe2b7f
ms.sourcegitcommit: 02f14db142dce68d084dcb0a19ca41a16f5bccff
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/23/2020
ms.locfileid: "95441009"
---
# <a name="how-to-set-up-your-test-agent-to-run-tests-that-interact-with-the-desktop"></a>如何：將您的測試代理程式設定為執行與桌面互動的測試

::: moniker range="vs-2017"
如果您想要執行與桌面互動的自動化測試，必須將代理程式設定成以處理序 (而不是服務) 的方式執行。 例如，如果您想要使用測試控制器和測試代理程式執行自動程式碼 UI 測試，或想要執行測試並在執行測試時擷取視訊錄製，則必須設定代理程式做為處理序執行。 當使用 Visual Studio 將代理程式指派給測試設定中的角色，或使用 Microsoft Test Manager 將代理程式指派給環境中的角色時，必須針對指派給需要與桌面互動之角色的代理程式變更設定。
::: moniker-end
::: moniker range=">=vs-2019"
如果您想要執行與桌面互動的自動化測試，必須將代理程式設定成以處理序 (而不是服務) 的方式執行。 例如，如果您想要使用測試控制器和測試代理程式執行自動程式碼 UI 測試，或想要執行測試並在執行測試時擷取視訊錄製，則必須設定代理程式做為處理序執行。 當您使用 Visual Studio 將代理程式指派給測試設定中的角色時，必須針對指派給需要與桌面互動之角色的任何代理程式，變更安裝程式。
::: moniker-end

[!INCLUDE [web-load-test-deprecated](includes/web-load-test-deprecated.md)]

::: moniker range="vs-2017"
> [!WARNING]
> 如果您使用 Microsoft Test Manager 設定實驗室環境，它會安裝測試代理程式。 您可以在 [環境建立精靈] 中指定，表示您要設定其中一個角色來執行自動程式化 UI 測試。
:::moniker-end

> [!IMPORTANT]
> 如果您想要在電腦所執行的某個代理程式上執行自動程式碼 UI 測試，則無法鎖定該電腦，該電腦也不能具有作用中的螢幕保護程式。

如果您正在執行啟動瀏覽器的自動程式化 UI 測試，則測試代理程式的服務帳戶可用於啟動該瀏覽器。 這個服務帳戶必須與此電腦上現用使用者的使用者帳戶相同。 如果這不是相同的使用者帳戶，瀏覽器將不會啟動。

> [!IMPORTANT]
> 如果您正在執行做為組建定義的一部分，而啟動瀏覽器的自動程式化 UI 測試，則組建服務的服務帳戶可用於啟動該瀏覽器。 這個服務帳戶必須與此電腦上現用使用者的使用者帳戶相同。 如果這不是相同的使用者帳戶，瀏覽器將不會啟動。

使用下列程序設定指派給執行需要與桌面互動工作之角色的任何代理程式。

## <a name="to-set-up-an-agent-to-run-as-a-process"></a>若要設定代理程式以做為處理序執行

1. 若要將您安裝的測試代理程式設定為以進程的形式執行，請移至 [**開始**  >  **測試代理程式設定工具**]。

   [設定測試代理程式] 對話方塊隨即顯示。

   ![設定適用於 Visual Studio 的測試代理程式](media/configure-test-agent.png)

2. 選取 [互動式處理序]。 測試代理程式會做為處理序 (而非服務) 啟動。 選擇 [下一步]  。

3. 輸入要執行測試代理程式處理序之使用者的使用者名稱和密碼。

   > [!NOTE]
   > - 您加入以啟動處理序的使用者，必須也做為此代理程式的測試控制器電腦的 TeamTestAgentService 群組成員。 如果此使用者是目前的使用者，則當您將此使用者加入至測試控制器電腦時，您必須登出或重新開機。
   > - 使用者帳戶不支援 Null 密碼。
   > - 如果您想要使用 IntelliTrace 或網路模擬資料和診斷配接器，使用者帳戶必須是 [Administrators] 群組的成員。 如果執行測試代理程式的電腦正在執行具有最低權限使用者帳戶的作業系統，您也必須以系統管理員的身分執行它 (更高的權限)。 如果代理程式使用者名稱不在代理程式服務中，它就會嘗試加入，而這項作業需要測試控制器的權限。
   > - 嘗試使用測試控制器的使用者必須是在測試控制器的 Users 帳戶中，否則他們無法對控制器執行測試。

4. 若要確定有測試代理程式的電腦可以在重新開機之後執行測試，您可以將電腦設定成自動以測試代理程式使用者身分登入。 選取 [自動登入]。 這會將使用者名稱和密碼以加密格式儲存在登錄中。

   > [!NOTE]
   > 當您使用遠端桌面或客體連接來連接至實驗室環境時，可能會經常遇到連接未預期中斷的情況。 連接中斷的其中一個可能原因，是電腦已設定成自動登入網路。

5. 若要確定已停用螢幕保護裝置，因為這可能會妨礙必須與桌面互動的自動化測試，請選取 [確保已停用螢幕保護裝置]。

   > [!WARNING]
   > 如果自動登入或停用螢幕保護裝置，則會有安全性危險。 啟用自動登入，您可讓其他使用者啟動此電腦，並且能夠使用自動登入的帳戶。 如果停用螢幕保護裝置，則電腦可能不會提示使用者登入以解除鎖定電腦。 這可讓任何人存取電腦，只要他們可以實際存取電腦。 如果在電腦上啟用這些功能，則您要確保這些電腦的實際安全性。 例如，這些電腦位於實際安全的實驗室中。 如果您清除 [ **確定已停用螢幕保護裝置**]，就不會啟用螢幕保護裝置。

   若要將代理程式變更回到作為服務執行，則您可以使用此工具並選取 [服務]。

6. 若要套用變更，請選擇 [套用設定]。

   此時會顯示 [組態摘要] 對話方塊，其中顯示設定測試代理程式的每個步驟狀態。

7. 若要關閉 [組態摘要] 對話方塊，請選擇 [關閉]。 然後再次選擇 [關閉]，即可關閉 [Test Agent 組態工具]。

   > [!NOTE]
   > 在測試代理程式的電腦上會執行通知區域圖示，該代理程式正做為處理序執行。 它會顯示測試代理程式的狀態。 您可以使用此工具啟動、停止或重新啟動以處理序方式執行的代理程式。 若要將測試代理程式作為進程啟動（如果尚未執行），請選擇 [**啟動**  >  **Visual Studio**  >  **Microsoft Visual Studio 測試代理程式**]。

   ::: moniker range="vs-2017"
   如果這個測試代理程式的測試控制器已向 Team Foundation Server 註冊，當作互動式處理序執行之測試代理程式的狀態就會顯示在 Microsoft Test Manager [實驗室中心] 的 [控制器] 檢視中。 當系統列出這個測試代理程式時，會在前面加上一個星號，表示它當做互動式處理序執行。 若要重新啟動這個測試代理程式，您必須使用在測試代理程式電腦上執行的工具，而非 [控制器] 檢視。
   ::: moniker-end

## <a name="see-also"></a>另請參閱

- [安裝和設定測試代理程式](../test/lab-management/install-configure-test-agents.md)
