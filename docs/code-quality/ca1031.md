---
title: CA1031:不要攔截一般例外狀況類型
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- CA1031
- DoNotCatchGeneralExceptionTypes
helpviewer_keywords:
- CA1031
- DoNotCatchGeneralExceptionTypes
ms.assetid: cbc283ae-2a46-4ec0-940e-85aa189b118f
author: mikejo5000
ms.author: mikejo
manager: jillfra
dev_langs:
- CSharp
- VB
ms.workload:
- multiple
ms.openlocfilehash: 402c860b3294f8b793c5576b232cb35642e5efac
ms.sourcegitcommit: a18c7e9b367c2f92f6e54c3eaef442775d457667
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/15/2020
ms.locfileid: "90096809"
---
# <a name="ca1031-do-not-catch-general-exception-types"></a>CA1031:不要攔截一般例外狀況類型

|Item|值|
|-|-|
|RuleId|CA1031|
|類別|Microsoft. 設計|
|重大變更|非中斷|

## <a name="cause"></a>原因
一般例外狀況（例如 <xref:System.Exception?displayProperty=fullName> 或 <xref:System.SystemException?displayProperty=fullName> ）會在語句中捕捉 `catch` ，或使用一般 catch 子句（例如） `catch()` 。

根據預設，此規則只會旗標攔截一般例外狀況類型，但這是 [可](#configurability)設定的。

## <a name="rule-description"></a>規則描述
不應該攔截一般例外狀況。

## <a name="how-to-fix-violations"></a>如何修正違規
若要修正此規則的違規情形，請攔截更明確的例外狀況，或重新擲回一般例外狀況做為區塊中的最後一個語句 `catch` 。

## <a name="when-to-suppress-warnings"></a>隱藏警告的時機
請勿隱藏此規則的警告。 攔截一般例外狀況類型可以隱藏程式庫使用者的執行時間問題，並且可以使調試更困難。

> [!NOTE]
> 從 .NET Framework 4 開始，common language runtime (CLR) 不再將作業系統和 managed 程式碼中發生的損毀狀態例外狀況（例如中的存取違規）傳遞 [!INCLUDE[TLA#tla_mswin](../code-quality/includes/tlasharptla_mswin_md.md)] 給 managed 程式碼處理。 如果您想要在 .NET Framework 4 或更新版本中編譯應用程式，並維護損毀狀態例外狀況的處理，您可以將 <xref:System.Runtime.ExceptionServices.HandleProcessCorruptedStateExceptionsAttribute> 屬性套用至處理損毀狀態例外狀況的方法。

## <a name="configurability"></a>性

此規則具有下列可設定的選項。

### <a name="disallowed-exception-type-names"></a>不允許的例外狀況類型名稱

您可以設定不允許攔截哪些例外狀況類型。 例如，若要指定規則應以旗標 `catch` 處理常式 `NullReferenceException` ，請將下列機碼值組新增至專案中的 editorconfig 檔案：

```ini
dotnet_code_quality.CA1031.disallowed_symbol_names = NullReferenceException
```

選項值 (允許的類型名稱格式，以 ' | ' 分隔) ：
- 僅限類型名稱 (包含名稱的所有符號，不論包含的類型或命名空間為何) 
- 符號的 [檔識別碼格式](https://github.com/dotnet/csharplang/blob/master/spec/documentation-comments.md#id-string-format) 中具有前置詞的完整名稱 `T:` 。

範例：

| 選項值 | 摘要 |
| --- | --- |
|`dotnet_code_quality.CA1031.disallowed_symbol_names = ExceptionType` | 符合編譯中名稱為 ' ExceptionType ' 的所有符號
|`dotnet_code_quality.CA1031.disallowed_symbol_names = ExceptionType1|ExceptionType2` | 符合編譯中名稱為 ' ExceptionType1 ' 或 ' ExceptionType2 ' 的所有符號
|`dotnet_code_quality.CA1031.disallowed_symbol_names = T:NS.ExceptionType` | 符合指定的完整名稱之名稱為 ' ExceptionType ' 的特定類型。
|`dotnet_code_quality.CA1031.disallowed_symbol_names = T:NS1.ExceptionType1|T:NS1.ExceptionType2` | 符合名為 ' ExceptionType1 ' 和 ' ExceptionType2 ' 的類型，並具有各自的完整限定名稱

您可以只針對此規則、所有規則或此類別中的所有規則設定這些選項， (設計) 。 如需詳細資訊，請參閱 [設定 .net 程式碼品質分析器](configure-fxcop-analyzers.md)。

## <a name="example"></a>範例
下列範例顯示違反此規則的型別，以及正確實作為區塊的型別 `catch` 。

[!code-vb[FxCop.Design.ExceptionAndSystemException#1](../code-quality/codesnippet/VisualBasic/ca1031-do-not-catch-general-exception-types_1.vb)]
[!code-csharp[FxCop.Design.ExceptionAndSystemException#1](../code-quality/codesnippet/CSharp/ca1031-do-not-catch-general-exception-types_1.cs)]

## <a name="related-rules"></a>相關規則
[CA2200:必須重新擲回以保存堆疊詳細資料](../code-quality/ca2200.md)
