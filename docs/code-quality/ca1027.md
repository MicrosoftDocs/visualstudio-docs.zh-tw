---
title: CA1027:必須以 FlagsAttribute 標記列舉
ms.date: 03/11/2019
ms.topic: reference
f1_keywords:
- MarkEnumsWithFlags
- CA1027
helpviewer_keywords:
- CA1027
- MarkEnumsWithFlags
ms.assetid: 249e882c-8cd1-4c00-a2de-7b6bdc1849ff
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: 878f4297c1c8496bc4726feca27e764d3521b864
ms.sourcegitcommit: de98ed7edc81383e47b87ae6e61143fbbbe7bc56
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/21/2020
ms.locfileid: "88711335"
---
# <a name="ca1027-mark-enums-with-flagsattribute"></a>CA1027:必須以 FlagsAttribute 標記列舉

|Item|值|
|-|-|
|CheckId|CA1027|
|類別|Microsoft. 設計|
|重大變更|非中斷|

## <a name="cause"></a>原因

列舉的值為2的乘冪，或為列舉中所定義之其他值的組合，且該 <xref:System.FlagsAttribute?displayProperty=fullName> 屬性不存在。 若要減少誤報，此規則不會針對具有連續值的列舉報告違規。

根據預設，此規則只會查看公用列舉，但這是 [可](#configurability)設定的。

## <a name="rule-description"></a>規則描述

列舉類型是一種實值類型 (Value Type)，用以定義一組相關的具名常數。 <xref:System.FlagsAttribute>當列舉的常數可以有意義地結合時，套用至列舉。 例如，請考慮在應用程式中，每一周的哪幾天列舉，以追蹤可用的當日資源。 如果每個資源的可用性是使用已存在的列舉來編碼 <xref:System.FlagsAttribute> ，則可以表示任何天數的組合。 如果沒有屬性，則只能表示一周中的一天。

針對儲存可組合列舉的欄位，會將個別列舉值視為欄位中的位群組。 因此，這類欄位有時稱為 *位欄位*。 若要在位欄位中結合儲存的列舉值，請使用布林條件運算子。 若要測試位欄位以判斷特定的列舉值是否存在，請使用布林值邏輯運算子。 若要讓位欄位正確地儲存和取得結合的列舉值，在列舉中定義的每個值都必須是2的乘冪。 除非如此，否則布林邏輯運算子將無法解壓縮儲存在欄位中的個別列舉值。

## <a name="how-to-fix-violations"></a>如何修正違規

若要修正此規則的違規情形，請新增 <xref:System.FlagsAttribute> 至列舉。

## <a name="when-to-suppress-warnings"></a>隱藏警告的時機

如果您不想要組合列舉值，請隱藏此規則的警告。

## <a name="configurability"></a>性

您可以根據其存取範圍，設定程式碼基底的哪些部分來執行此規則。 例如，若要指定規則只能針對非公用 API 介面執行，請將下列機碼值組新增至專案中的 editorconfig 檔案：

```ini
dotnet_code_quality.ca1027.api_surface = private, internal
```

您可以只針對此規則、所有規則或此類別中的所有規則設定此選項， (設計) 。 如需詳細資訊，請參閱 [設定 .net 程式碼品質分析器](configure-fxcop-analyzers.md)。

## <a name="example"></a>範例

在下列範例中， `DaysEnumNeedsFlags` 是符合使用 <xref:System.FlagsAttribute> 但沒有它之需求的列舉。 `ColorEnumShouldNotHaveFlag`列舉的值不是2的乘冪，但卻不正確地指定 <xref:System.FlagsAttribute> 。 這違反 [了規則 CA2217：請勿以 FlagsAttribute 標示](../code-quality/ca2217.md)列舉。

[!code-csharp[FxCop.Design.EnumFlags#1](../code-quality/codesnippet/CSharp/ca1027-mark-enums-with-flagsattribute_1.cs)]

## <a name="related-rules"></a>相關規則

- [CA2217:不要以 FlagsAttribute 標記列舉](../code-quality/ca2217.md)

## <a name="see-also"></a>另請參閱

- <xref:System.FlagsAttribute?displayProperty=fullName>
