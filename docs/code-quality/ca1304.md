---
title: CA1304：指定 CultureInfo
ms.date: 06/30/2018
ms.topic: reference
f1_keywords:
- SpecifyCultureInfo
- CA1304
helpviewer_keywords:
- SpecifyCultureInfo
- CA1304
ms.assetid: b912d76a-54fd-4c93-b25d-16491e0ae319
author: mikejo5000
ms.author: mikejo
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: 668555c6247b45fea9e472ab5347d692243c1d9f
ms.sourcegitcommit: ade07bd1cf69b8b494d171ae648cfdd54f7800d3
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/21/2020
ms.locfileid: "81649118"
---
# <a name="ca1304-specify-cultureinfo"></a>CA1304：指定 CultureInfo

|||
|-|-|
|TypeName|SpecifyCultureInfo|
|CheckId|CA1304|
|類別|微軟.全球化|
|重大變更|不中斷|

## <a name="cause"></a>原因

方法或建構函數調用具有接受<xref:System.Globalization.CultureInfo?displayProperty=nameWithType>參數的重載的成員,並且方法或構造函數不調用採用該參數<xref:System.Globalization.CultureInfo>的重載。 此規則忽略對以下方法的呼叫:

- <xref:System.Activator.CreateInstance%2A?displayProperty=nameWithType>
- <xref:System.Resources.ResourceManager.GetObject%2A?displayProperty=nameWithType>
- <xref:System.Resources.ResourceManager.GetString%2A?displayProperty=nameWithType>

您還可以[設定](#configurability)更多符號,以便由此規則排除。

## <a name="rule-description"></a>規則描述

如果未提供<xref:System.Globalization.CultureInfo><xref:System.IFormatProvider?displayProperty=nameWithType>或 物件,則重載成員提供的預設值可能不會在所有區域設置中產生所需的效果。 此外,.NET 成員根據可能不適合代碼的假設選擇預設區域性和格式。 為確保代碼按預期方式工作,應根據以下準則提供特定於區域性的資訊:

- 如果該值將顯示給使用者,請使用當前區域性。 請參閱＜<xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType>＞。

- 如果該值將由軟體儲存和訪問,即保存到檔案或資料庫,請使用不變區域性。 請參閱＜<xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType>＞。

- 如果不知道該值的目標,請讓數據消費者或提供程式指定區域性。

即使重載成員的默認行為適合您的需要,最好顯式調用特定於區域性的重載,以便代碼是自記錄且更易於維護。

> [!NOTE]
> <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=nameWithType>僅用於使用<xref:System.Resources.ResourceManager?displayProperty=nameWithType>類的實例檢索本地化資源。

## <a name="how-to-fix-violations"></a>如何修正違規

要修復違反此規則的項,請使用採用<xref:System.Globalization.CultureInfo>參數的重載。

## <a name="when-to-suppress-warnings"></a>何時禁止警告

當確定預設區域性是正確的選擇,並且代碼可維護性不是重要的開發優先順序時,可以安全地禁止顯示此規則的警告。

## <a name="configurability"></a>可設定性

如果從[FxCop 分析器](install-fxcop-analyzers.md)運行此規則(而不是使用舊版分析),則可以為此規則配置分析。

### <a name="excluded-symbol-names"></a>排除符號名稱

您可以配置代碼庫的哪些部分要從分析中排除。 例如,要指定規則不應在名稱`MyType`類型中的任何代碼上運行,請在專案中將以下鍵值對添加到 .editorconfig 檔案中:

```ini
dotnet_code_quality.CA1304.excluded_symbol_names = MyType
```

選項值中允許的符號名稱格式(以"*"分隔):

- 只設定符號名稱(包括名稱的所有符號,而不考慮包含的類型或命名空間)
- 符號[的文件 ID 格式](https://github.com/dotnet/csharplang/blob/master/spec/documentation-comments.md#id-string-format)完全限定的名稱。 每個符號名稱都需要一個符號類型首碼,例如方法的"M:"首碼、類型的"T:"首碼、命名空間的"N:"首碼等。
- `.ctor`對於建構函數和`.cctor`靜態建構函數

範例：

| 選項值 | 摘要 |
| --- | --- |
|`dotnet_code_quality.CA1304.excluded_symbol_names = MyType` | 符合編譯中名為「MyType」的所有符號
|`dotnet_code_quality.CA1304.excluded_symbol_names = MyType1|MyType2` | 在編譯中符合名為「MyType1」或「MyType2」的所有符號
|`dotnet_code_quality.CA1304.excluded_symbol_names = M:NS.MyType.MyMethod(ParamType)` | 將特定方法「MyMethod」與給定的完全限定簽名匹配
|`dotnet_code_quality.CA1304.excluded_symbol_names = M:NS1.MyType1.MyMethod1(ParamType)|M:NS2.MyType2.MyMethod2(ParamType)` | 將特定方法「MyMethod1」和「MyMethod2」與各自的完全限定簽名匹配

您可以僅為此規則、所有規則或此類別中的所有規則(安全性)配置所有這些選項。 有關詳細資訊,請參閱配置[FxCop 分析器](configure-fxcop-analyzers.md)。

## <a name="example-showing-how-to-fix-violations"></a>展示如何修復衝突的範例

在下面的示例中,`BadMethod`會導致兩個違反此規則的行為。 `GoodMethod`通過將不變量區域性傳遞給<xref:System.String.Compare%2A?displayProperty=nameWithType>來更正第一個衝突,並通過將當前區域性傳遞<xref:System.String.ToLower%2A?displayProperty=nameWithType>給 來更正第二個衝突`string3`,因為 顯示給使用者。

[!code-csharp[FxCop.Globalization.CultureInfo#1](../code-quality/codesnippet/CSharp/ca1304-specify-cultureinfo_1.cs)]

## <a name="example-showing-formatted-output"></a>顯示格式化輸出的範例

下面的範例顯示了當前區域性對<xref:System.IFormatProvider><xref:System.DateTime>類型選擇的預設值的影響。

[!code-csharp[FxCop.Globalization.IFormatProvider#1](../code-quality/codesnippet/CSharp/ca1304-specify-cultureinfo_2.cs)]

這個範例會產生下列輸出：

```txt
6/4/1900 12:15:12 PM
06/04/1900 12:15:12
```

## <a name="related-rules"></a>相關規則

- [CA1305：指定 IFormatProvider](../code-quality/ca1305.md)

## <a name="see-also"></a>另請參閱

- [使用文化資訊類別](/dotnet/standard/globalization-localization/globalization#work-with-culture-specific-settings)
