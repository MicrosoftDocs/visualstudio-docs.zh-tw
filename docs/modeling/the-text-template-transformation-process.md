---
title: 文字範本轉換流程
description: 瞭解文字模板轉換程式會將文字模板檔案作為輸入，並產生新的文字檔作為輸出。
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- text templates, transformation process
author: JoshuaPartlow
ms.author: joshuapa
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: 4bf2d8e7d8fc45a45dcb271d867f8f6a39564bab
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/08/2021
ms.locfileid: "99882943"
---
# <a name="the-text-template-transformation-process"></a>文字範本轉換流程
文字模板轉換程式會將文字模板檔案作為輸入，並產生新的文字檔作為輸出。 例如，您可以使用文字模板來產生 Visual Basic 或 c # 程式碼，也可以產生 HTML 報表。

 此套裝程式含三個元件：引擎、主機和指示詞處理器。 引擎會控制進程;它會與主機和指示詞處理器互動，以產生輸出檔。 主機會提供與環境的任何互動，例如尋找檔案和元件。 指示詞處理器會新增功能，例如從 XML 檔案或資料庫讀取資料。

 文字模板轉換進程會以兩個步驟執行。 首先，引擎會建立一個暫時性類別，也就是產生的轉換類別。 這個類別包含指示詞和控制區塊所產生的程式碼。 之後，引擎會編譯並執行產生的轉換類別，以產生輸出檔。

## <a name="components"></a>單元

|元件|描述|可自訂 (是/否) |
|-|-|-|
|引擎|引擎元件控制文字模板轉換進程|不會。|
|主機|主機是引擎和使用者環境之間的介面。 Visual Studio 是文字轉換進程的主控制項。|是。 您可以撰寫自訂主機。|
|指示詞處理器|指示詞處理器是可處理文字模板中指示詞的類別。 您可以使用指示詞，從輸入來源提供資料給文字模板。|是。 您可以撰寫自訂指示詞處理器|

## <a name="the-engine"></a>引擎
 引擎會從主控制項以字串的形式接收範本，以處理轉換進程中使用的所有檔案。 然後，引擎會要求主機找出任何自訂指示詞處理器和環境的其他層面。 然後，引擎會編譯並執行產生的轉換類別。 引擎會將產生的文字傳回至主機，通常會將文字儲存至檔案。

## <a name="the-host"></a>主機
 主機負責在轉換程式之外與環境相關的任何事項，包括下列各項：

- 尋找引擎或指示詞處理器所要求的文字和二進位檔案。 主機可以搜尋目錄和全域組件快取，以找出元件。 主機可以找出引擎的自訂指示詞處理器程式碼。 主機也可以尋找和讀取文字檔，並以字串形式傳回它們的內容。

- 提供引擎用來建立所產生轉換類別的標準元件和命名空間清單。

- 提供當引擎編譯和執行產生的轉換類別時，所使用的應用程式域。 使用個別的應用程式域，以保護主機應用程式免于範本程式碼中的錯誤。

- 寫入產生的輸出檔。

- 設定產生之輸出檔的預設副檔名。

- 處理文字模板轉換錯誤。 例如，主機可以在使用者介面中顯示錯誤，或將它們寫入檔案。  (在 Visual Studio 中，錯誤會顯示在錯誤訊息視窗中。 ) 

- 如果使用者在不提供值的情況下呼叫指示詞，請提供必要的參數值。 指示詞處理器可以指定指示詞和參數的名稱，並要求主機提供預設值（如果有的話）。

## <a name="directives-and-directive-processors"></a>指示詞和指示詞處理器
 指示詞是文字模板中的命令。 它會將參數提供給產生進程。 一般來說，指示詞會定義模型的來源和類型或其他輸入，以及輸出檔案的副檔名。

 指示詞處理器可以處理一或多個指示詞。 當您轉換範本時，必須已安裝可處理範本中指示詞的指示詞處理器。

 指示詞的運作方式是在產生的轉換類別中加入程式碼。 您可以從文字模板呼叫指示詞，而引擎會在建立產生的轉換類別時處理所有的指示詞呼叫。 成功呼叫指示詞之後，您在文字模板中撰寫的其餘程式碼可以依賴指示詞提供的功能。 例如，您可以對範本中的指示詞進行下列呼叫 `import` ：

 `<#@ import namespace="System.Text" #>`

 標準指示詞處理器會將此轉換成 `using` 所產生轉換類別中的語句。 然後，您可以 `StringBuilder` 在範本程式碼的其餘部分使用該類別，而不將它限定為 `System.Text.StringBuilder` 。
