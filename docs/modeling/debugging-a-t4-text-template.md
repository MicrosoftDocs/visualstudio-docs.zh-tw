---
title: 偵錯 T4 文字範本
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- text templates, troubleshooting
- text templates, debugging
author: JoshuaPartlow
ms.author: joshuapa
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: 1570061feb5da034e2e8fab7168658577f6f990d
ms.sourcegitcommit: d233ca00ad45e50cf62cca0d0b95dc69f0a87ad6
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/01/2020
ms.locfileid: "75589678"
---
# <a name="debugging-a-t4-text-template"></a>偵錯 T4 文字範本
您可以在文字模板中設定中斷點。 若要調試設計階段文字模板，請儲存文字模板檔案，然後在方案總管中檔案的快捷方式功能表上選擇 [ **Debug T4 template** ]。 若要進行執行時間文字模板的偵錯工具，只需要對它所屬的應用程式進行 debug。

 若要進行文字模板的偵錯工具，您應該瞭解範本轉換程式的步驟。 每個步驟內可能會發生不同類型的錯誤。 步驟如下所示。

|步驟|設計階段範本：發生時機|執行時間範本：發生時機|
|-|-|-|
|程式碼是從文字模板產生。<br /><br /> 指示詞中的錯誤，或不相符或 disordered `<#...#>` 標記。|當您儲存範本或叫用文字轉換時。|當您儲存範本或叫用文字轉換時。|
|已編譯產生的程式碼。<br /><br /> 範本程式碼中的編譯錯誤。|緊接在上一個步驟之後。|連同您的應用程式程式碼。|
|程式碼執行。<br /><br /> 範本程式碼中的執行階段錯誤。|緊接在上一個步驟之後。|當您的應用程式執行並叫用範本程式碼時。|

 在大部分情況下，範本程式碼中的行號會在錯誤報表中提供。 當錯誤報表參考暫存檔案案時，常見的原因是文字模板的程式碼中有不相符的括弧。

 您可以在文字模板中設定中斷點，並以一般方式進行 debug。

## <a name="common-errors-and-fixes"></a>常見的錯誤和修正
 下表列出最常見的錯誤及其修正程式。

|錯誤訊息|描述|解決方案|
|-|-|-|
|無法載入轉換類別所繼承的基類 '{0}'。|如果您在樣板指示詞的 `inherits` 參數中找不到所指定的基類，則會發生此錯誤。 訊息會提供範本指示詞的行號。|請確定指定的類別存在，而且它所存在的元件是在 assembly 指示詞中指定。|
|無法解析 file：{0} 的 include 文字|當您找不到包含的範本時發生。 訊息會提供要求的 include 檔的名稱。|請確定檔案路徑是相對於原始的範本路徑，或是檔案位於已向主機註冊的位置，或檔案的完整路徑。|
|初始化轉換物件時產生錯誤。 轉換將不會執行。|轉換類別的 ' Initialize （） ' 失敗或傳回 false 時發生。|Initialize （）函式中的程式碼來自于 \<#@template# > 指示詞和指示詞處理器中所指定的基底轉換類別。 導致初始化失敗的錯誤可能是在 [錯誤清單] 中。 調查失敗的原因。 您可以遵循程式來進行初始化（），以查看實際產生的程式碼，以進行範本的 debug。|
|指示詞處理器 '{1}' 的元件 '{0}' 未被授與 FullTrust 許可權集合。 僅允許受信任的元件提供指示詞處理器。 將不會載入這個指示詞處理器。|當系統未將 FullTrust 許可權授與包含指示詞處理器的元件時，就會發生這種情況。 訊息會提供元件的名稱和指示詞處理器的名稱。|請確定您只在本機電腦上使用信任的元件。|
|路徑 '{0}' 必須是這部電腦的本機或受信任區域的一部分。|當指示詞或元件指示詞參考的檔案不在您的本機電腦上，或在您網路的受信任區域上時，就會發生。|請確定指示詞或元件指示詞所在的目錄位於受信任的區域中。 您可以透過 Internet Explorer 將網路目錄新增至受信任的區域。|
|多個語法錯誤，例如「不正確 token ' catch '」或「命名空間不能直接包含成員」|您的範本程式碼中有太多右大括弧。 編譯器會與標準產生程式碼混淆。|檢查程式碼分隔符號內的右大括弧和括弧數。|
|未正確編譯或執行迴圈或條件。 例如：`<#if (i>10)#> Number is: <#= i #>`。<br /><br /> 此程式碼一律會輸出 i 的值。 只有 "Number is：" 是條件式。|在C#中，一律使用大括弧括住內嵌于控制語句中的文字區塊。|新增大括弧： `<#if (i>10) { #>    Number is: <#= i #><# } #>`。|
|處理設計階段範本或編譯執行時間（前置處理）範本時，「運算式太複雜」。<br /><br /> 嘗試檢查執行時間範本所產生的程式碼時，Visual Studio 停止運作。|文字區塊太長。 T4 會將文字區塊轉換成字串串連運算式，每個範本行都有一個字串常值。 非常長的文字區塊可以 overstep 編譯器的大小限制。|使用運算式區塊（例如）來分解長文字區塊：<br /><br /> `<#= "" #>`|

## <a name="warning-descriptions-and-fixes"></a>警告描述和修正
 下表列出最常見的警告以及修正（如果有的話）。

|警告訊息|描述|解決方案|
|-|-|-|
|載入 include 檔 '{0}' 會傳回 null 或空字串。|包含的文字模板檔案空白時發生。 訊息會提供所包含檔案的檔案名。|請移除 include 指示詞，或確定檔案有一些內容。|
|編譯轉換：|在編譯轉換時，將此字串附加至源自編譯器的所有錯誤或警告。 這個字串表示編譯器會擲回錯誤或警告。|如果您在尋找 DLL 時發生問題，則可能需要提供完整路徑，或如果 DLL 位於 GAC 中，則是完整的強式名稱。|
|參數 '{0}' 已經存在於指示詞中。 將忽略重複的參數。|在指示詞中指定了一次以上的參數時發生。 訊息會提供參數的名稱和指示詞的行號。|請移除重複的參數規格。|
|載入 include 檔 '{0}' 時發生錯誤。 Include 指示詞將會被忽略。|當您找不到在 `include` 指示詞中指定的檔案時發生。 訊息會提供檔案名和指示詞的行號。|請確定 include 檔案存在於與原始文字模板檔案相同的目錄中，或位於已向主機註冊的其中一個 include 目錄中。|
|為轉換類別指定了不正確基底類別。 基類必須衍生自 VisualStudio. TextTemplating. Microsoft.visualstudio.texttemplating.texttransformation。|當樣板指示詞中的 `inherits` 參數指定未繼承自 `TextTransformation`的類別時發生。 訊息會提供範本指示詞的行號。|指定衍生自 `TextTransformation`的類別。|
|' Template ' 指示詞中指定了不正確文化特性。 文化特性必須是 "xx-XX" 格式。 將會使用不因文化特性而異。|當樣板指示詞中的 culture 參數指定不正確時發生。 訊息會提供範本指示詞的行號。|將文化特性參數變更為 "xx-XX" 格式的有效文化特性。|
|在範本指示詞中指定了不正確 debug 值 '{0}'。 Debug 值必須是 "true" 或 "false"。 將使用預設值 "false"。|在範本指示詞中的 `debug` 參數指定錯誤時發生。 訊息會提供範本指示詞的行號。|將 debug 參數設為 "true" 或 "false"。|
|在範本指示詞中指定了不正確 HostSpecific 值 '{0}'。 HostSpecific 值必須是 "true" 或 "false"。 將使用預設值 "false"。|當 `template` 指示詞中的主機特定參數指定不正確時發生。 訊息會提供範本指示詞的行號。|將主機特定的參數設定為 "true" 或 "false"。|
|' Template ' 指示詞中指定了不正確語言 '{0}'。 語言必須是 "C#" 或 "VB"。 將會使用預設值C#""。|在 `template` 指示詞中指定了不支援的語言時發生。 只允許C#"" 或 "VB" （不區分大小寫）。 訊息會提供範本指示詞的行號。|將範本指示詞中的 `language` 參數設定為C#"" 或 "VB"。|
|在範本中找到多個輸出指示詞。 除了第一個以外的全部都會被忽略。|在範本檔案中指定多個 `output` 指示詞時發生。 訊息會提供重複輸出指示詞的行號。|移除重複的 `output` 指示詞。|
|在範本中找到多個範本指示詞。 除了第一個以外的全部都會被忽略。 範本指示詞的多個參數應該在一個樣板指示詞中指定。|如果您在文字模板檔案（包括包含的檔案）內指定多個 `template` 指示詞，就會發生此錯誤。 訊息會提供重複範本指示詞的行號。|將不同的 `template` 指示詞彙總成一個 `template` 指示詞。|
|未對名為 '{0}' 的指示詞指定任何處理器。 將會忽略指示詞。|當您指定 `custom` 指示詞，但未提供 `processor` 屬性時發生。 訊息會提供指示詞的名稱和行號。|提供具有指示詞之 `directive` 處理器名稱的 `processor` 屬性。|
|找不到名為 '{1}' 的指示詞為 '{0}' 的處理器。 將會忽略指示詞。|系統找不到您在 `custom` 指示詞中指定的 `directive` 處理器時發生。 訊息會提供指示詞名稱、處理器名稱和指示詞的行號。|將指示詞中的 `processor` 屬性設定為指示詞處理器的名稱。|
|找不到指示詞 '{1}' 的必要參數 '{0}'。 將會忽略指示詞。|當系統未提供必要的指示詞參數時發生。 訊息會提供遺漏參數的名稱、指示詞名稱和行號。|提供遺漏的參數。|
|名為 '{0}' 的處理器不支援名為 '{1}' 的指示詞。 將會忽略指示詞。|指示詞處理器不支援指示詞時發生。 訊息會提供違規指示詞的名稱和行號，以及指示詞處理器的名稱。|更正指示詞的名稱。|
|檔案 '{0}' 的 include 指示詞導致無限迴圈。|如果已指定迴圈包含指示詞，則會顯示（例如，檔案 A 包含檔案 B，其中包含檔案 A）。|請勿指定迴圈 include 指示詞。|
|正在執行轉換：|在執行轉換時產生的所有錯誤或警告前面加上此字串。|不適用。|
|在區塊內發現非預期的開始或結束標記。 請確定您不會誤輸入開始或結束標記，而且範本中沒有任何嵌套區塊。|當您有未預期的 \<# 或 # > 時顯示。 也就是說，如果您在另一個尚未關閉的開啟標記之後有 \<#，或如果沒有未封閉的開啟標記，則會有 # >。 訊息會提供不相符標記的行號。|請移除不相符的開始或結束標記，或使用 escape 字元。|
|以錯誤的格式指定指示詞。 將會忽略指示詞。 請以格式指定指示詞 `<#@ name [parametername="parametervalue"]*  #>`|如果未以正確的格式指定指示詞，則剖析器會顯示。 訊息提供了不正確指示詞的行號。|請確定所有指示詞的格式都是 `<#@ name [parametername="parametervalue"]*  #>`。 如需詳細資訊，請參閱[T4 文字模板](../modeling/t4-text-template-directives.md)指示詞。|
|無法載入已註冊指示詞處理器 '{1}' 的元件 '{0}'<br /><br /> {2}|當主機無法載入指示詞處理器時發生。 訊息會識別為指示詞處理器提供的元件，以及指示詞處理器的名稱。|請確定指示詞處理器已正確註冊，而且該元件存在。|
|在元件 '{1}' 中找不到已註冊指示詞處理器 '{2}' 的類型 '{0}'<br /><br /> {3}|在無法從其元件載入指示詞處理器類型時發生。 訊息會提供類型、元件和指示詞處理器的名稱。|.Vshost.exe 會在登錄中尋找指示詞處理器資訊（名稱、元件和類型）。 請確定指示詞處理器已正確註冊，而且該類型存在於元件中。|
|載入元件 '{0}' 時發生問題|載入元件時發生問題。 訊息會提供元件的名稱。|您可以指定要在 \<@ #assembly # > 指示詞和指示詞處理器中載入的元件。 此字串後面的錯誤訊息應該會提供有關元件載入失敗原因的詳細資料。|
|建立並初始化名為 '{1}' 之指示詞的處理器時發生問題。 處理器的類型為 {0}。 將會忽略指示詞。|當系統無法建立或初始化指示詞處理器時發生。 訊息會提供指示詞的名稱和行號，以及處理器的類型。|請務必使用正確的指示詞處理器，而且指示詞處理器具有公用的預設函式。 否則，請使用 debug 選項來找出指示詞處理器的 Initialize （）方法失敗的原因。 如需詳細資訊，請參閱[疑難排解文字模板](../modeling/debugging-a-t4-text-template.md)。|
|處理名稱為 '{0}' 的指示詞時，擲回例外狀況（Exception）。|在處理指示詞的指示詞處理器擲回例外狀況時發生。|請確定指示詞處理器的參數正確無誤。|
|嘗試解析元件參考 '{0}' 時，主機擲回例外狀況。|當主機嘗試解析元件參考而擲回例外狀況時發生。 訊息會提供元件參考字串。|元件參考來自 \<@ #assembly # > 指示詞和指示詞處理器。 請確定 assembly 參數中提供的 ' name ' 參數正確無誤。|
|嘗試為指示詞指定不支援的 {1} 值 '{0}' {2}|當您提供不支援的要求或提供引數時，RequiresProvidesDirectiveProcessor （所有產生的指示詞處理器衍生自它）發生。|請確定中提供的 name = ' value ' 配對中的名稱，並提供正確的參數。|
