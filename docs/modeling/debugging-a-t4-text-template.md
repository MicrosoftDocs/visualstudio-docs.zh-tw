---
title: 偵錯 T4 文字範本
description: 若要在設計階段文字模板中進行程式設計，請儲存文字模板檔案，然後在方案總管中，于檔案的快捷方式功能表上選擇 [Debug T4 範本]。
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- text templates, troubleshooting
- text templates, debugging
author: mgoertz-msft
ms.author: mgoertz
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: 6c9e4454071002e3bce8478bc825ecfddc17620f
ms.sourcegitcommit: e3a364c014ccdada0860cc4930d428808e20d667
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/19/2021
ms.locfileid: "112385769"
---
# <a name="debugging-a-t4-text-template"></a>偵錯 T4 文字範本
您可以在文字模板中設定中斷點。 若要在設計階段文字模板中進行程式設計，請儲存文字模板檔案，然後在方案總管中，于檔案的快捷方式功能表上選擇 [ **Debug T4 範本** ]。 若要對執行時間文字模板進行偵錯工具，只需將它所屬的應用程式進行調試。

 若要對文字模板進行偵錯工具，您應該瞭解範本轉換程式的步驟。 每個步驟內可能會發生不同類型的錯誤。 步驟如下所示。

|步驟|設計階段範本：發生時間|執行時間範本：發生時|
|-|-|-|
|程式碼是從文字模板產生的。<br /><br /> 指示詞中的錯誤，或不相符或 disordered `<#...#>` 標記。|當您儲存範本或叫用文字轉換時。|當您儲存範本或叫用文字轉換時。|
|產生的程式碼會進行編譯。<br /><br /> 範本程式碼中的編譯錯誤。|緊接在上一個步驟之後。|連同您的應用程式程式碼。|
|程式碼執行。<br /><br /> 範本程式碼中的執行階段錯誤。|緊接在上一個步驟之後。|當您的應用程式執行並叫用範本程式碼時。|

 在大部分的情況下，會在錯誤報表中提供範本程式碼中的行號。 當錯誤報表參考暫存檔案名時，常見的原因是文字模板程式碼中的括弧不相符。

 您可以在文字模板中設定中斷點，並以一般方式進行 debug。

## <a name="common-errors-and-fixes"></a>常見的錯誤和修正
 下表列出最常見的錯誤及其修正。

|錯誤訊息|描述|解決方法|
|-|-|-|
|無法載入 {0} 轉換類別所繼承的基類 ' '。|如果您找不到在範本指示詞中的參數所指定的基類，則會發生 `inherits` 。 訊息會提供範本指示詞的行號。|請確定指定的類別存在，而且在 assembly 指示詞中指定了它存在的元件。|
|無法解析 file 的 include 文字：{0}|當您找不到包含的範本時發生。 訊息會提供要求的 include 檔名稱。|請確定檔案路徑是相對於原始的範本路徑，或是檔案位於已向主機註冊的位置，或是檔案的完整路徑。|
|初始化轉換物件時產生錯誤。 轉換將不會執行。|發生于轉換類別的 ' Initialize () ' 失敗或傳回 false 時。|Initialize () 函式中的程式碼來自于指示詞和指示詞處理器中所指定的基底轉換類別 \<#@template#> 。 導致初始化失敗的錯誤可能是在 [錯誤清單] 中。 調查失敗的原因。 您可以依照下列程式來查看初始化 () 的實際產生程式碼。|
|未授與 ' ' 指示詞處理器 ' ' 的 {0} {1} FullTrust 許可權集合。 只允許信任的元件提供指示詞處理器。 將不會載入此指示詞處理器。|當系統未將 FullTrust 許可權授與包含指示詞處理器的元件時發生。 訊息會提供元件的名稱和指示詞處理器的名稱。|確定您只在本機電腦上使用受信任的元件。|
|路徑 ' {0} ' 必須是這部電腦的本機或受信任區域的一部分。|當指示詞或元件指示詞參考不在您的本機電腦或網路的受信任區域上的檔案時發生。|請確定指示詞或元件指示詞所在的目錄位於您信任的區域中。 您可以透過 Internet Explorer 將網路目錄新增至信任的區域。|
|多個語法錯誤，例如「不正確標記 ' catch '」或「命名空間不能直接包含成員」|您的範本程式碼中有太多右大括弧。 編譯器會將它與標準產生程式碼混淆。|檢查程式碼分隔符號內的右大括弧和括弧數目。|
|未正確編譯或執行的迴圈或條件。 例如：`<#if (i>10)#> Number is: <#= i #>`。<br /><br /> 此程式碼一律會輸出 i 的值。 只有 "Number 是：" 是條件式。|在 c # 中，一律使用大括弧來圍繞內嵌于控制語句中的文字區塊。|新增大括弧： `<#if (i>10) { #>    Number is: <#= i #><# } #>` 。|
|處理設計階段範本或編譯執行時間 (前置處理的) 範本時，「運算式太複雜」。<br /><br /> 當嘗試檢查執行時間範本產生的程式碼時，Visual Studio 會停止運作。|文字區塊太長。 T4 會將文字區塊轉換成字串串連運算式，每個範本行都有一個字串常值。 非常長的文字區塊可以 overstep 編譯器的大小限制。|使用運算式區塊來分割長文字區塊，例如：<br /><br /> `<#= "" #>`|

## <a name="warning-descriptions-and-fixes"></a>警告說明和修正
 下表列出最常見的警告以及修正（如果有的話）。

|警告訊息|描述|解決方法|
|-|-|-|
|載入 include 檔 ' {0} ' 傳回 null 或空字串。|如果包含的文字模板檔案空白則會發生。 訊息會提供包含檔案的檔案名。|請移除 include 指示詞，或確定檔案有一些內容。|
|編譯轉換：|在編譯轉換時，將此字串加到源自編譯器的所有錯誤或警告。 這個字串表示編譯器擲回錯誤或警告。|如果您在尋找 DLL 時發生問題，則可能需要提供完整路徑或完整的強式名稱（如果 DLL 位於 GAC 中的話）。|
|參數 ' {0} ' 已經存在於指示詞中。 將會忽略重複的參數。|在指示詞中多次指定參數時，就會發生。 訊息會提供參數的名稱和指示詞的行號。|請移除重複的參數規格。|
|載入 include 檔 ' ' 時發生錯誤 {0} 。 Include 指示詞將會被忽略。|當您找不到指示詞中指定的檔案時發生 `include` 。 訊息會提供檔案名和指示詞的行號。|請確定 include 檔案存在於與原始文字模板檔案相同的目錄中，或存在於已向主機註冊的其中一個 include 目錄中。|
|為轉換類別指定了不正確基類。 基類必須衍生自 VisualStudio. TextTemplating. Microsoft.visualstudio.texttemplating.texttransformation。|當範本指示詞 `inherits` 中的參數指定的類別不是繼承自時，就會發生 `TextTransformation` 。 訊息會提供範本指示詞的行號。|指定衍生自的類別 `TextTransformation` 。|
|在 ' template ' 指示詞中指定了不正確文化特性。 文化特性必須為 "xx-XX" 格式。 將會使用不變的文化特性。|當範本指示詞中的文化特性參數指定不正確時發生。 訊息會提供範本指示詞的行號。|將 culture 參數變更為 "xx-XX" 格式的有效文化特性。|
|在範本指示詞中指定了不正確 debug 值 ' {0} '。 Debug 值必須是 "true" 或 "false"。 將會使用預設值 "false"。|當範本指示詞 `debug` 中的參數指定不正確時發生。 訊息會提供範本指示詞的行號。|將 debug 參數設定為 "true" 或 "false"。|
|在範本指示詞中指定了不正確 HostSpecific 值 ' {0} '。 HostSpecific 值必須是 "true" 或 "false"。 將會使用預設值 "false"。|在指示詞中的主機特定參數 `template` 指定不正確時發生。 訊息會提供範本指示詞的行號。|將主機特定的參數設定為 "true" 或 "false"。|
|在 ' template ' 指示詞中指定了不正確語言 ' {0} '。 語言必須是 "c #" 或 "VB"。 將會使用預設值 "c #"。|在指示詞中指定了不支援的語言時發生 `template` 。  (不區分大小寫的) ，只允許使用 "c #" 或 "VB"。 訊息會提供範本指示詞的行號。|將範本指示詞 `language` 中的參數設定為 "c #" 或 "VB"。|
|在範本中找到多個輸出指示詞。 除了第一個之外，會忽略第一個。|在範本檔案中指定多個指示詞時發生 `output` 。 訊息會提供重複輸出指示詞的行號。|移除重複 `output` 的指示詞。|
|在範本中找到多個範本指示詞。 除了第一個之外，會忽略第一個。 範本指示詞中的多個參數應該在一個範本指示詞中指定。|如果您在文字模板檔案內指定多個指示詞， `template` (包括) 包含的檔案，就會發生。 訊息會提供重複範本指示詞的行號。|將不同的指示詞彙總 `template` 成一個指示詞 `template` 。|
|未針對名為 ' ' 的指示詞指定處理器 {0} 。 將會忽略指示詞。|如果您指定指示詞 `custom` ，但未提供屬性，就會發生 `processor` 。 訊息提供指示詞的名稱和行號。|提供 `processor` 屬性，其中包含指示詞的 `directive` 處理器名稱。|
|找不到名為 ' ' 的指示詞之名為 ' ' 的處理器 {0} {1} 。 將會忽略指示詞。|當系統找不到您在指示詞 `directive` 中指定的處理器時發生 `custom` 。 訊息提供指示詞名稱、處理器名稱和指示詞的行號。|將指示詞中的屬性設定為指示詞 `processor` 處理器的名稱。|
|找不到指示詞 ' ' 的必要參數 ' ' {0} {1} 。 將會忽略指示詞。|當系統未提供必要的指示詞參數時發生。 訊息會提供遺漏參數的名稱、指示詞名稱和行號。|提供遺漏的參數。|
|名為 ' ' 的處理器不 {0} 支援名為 ' ' 的指示詞 {1} 。 將會忽略指示詞。|指示詞處理器不支援指示詞時發生。 訊息會提供有問題的指示詞的名稱和行號，以及指示詞處理器的名稱。|更正指示詞的名稱。|
|File ' ' 的 include 指示詞 {0} 導致無限迴圈。|如果指定了迴圈 include 指示詞，則會顯示 (例如，file A 包含檔案 B，其中包含檔案 A) 。|請勿指定迴圈 include 指示詞。|
|正在執行轉換：|在執行轉換時產生的所有錯誤或警告前面加上此字串。|不適用。|
|在區塊中找到非預期的開始或結束標記。 請確定您未誤輸入開始或結束標記，而且範本中沒有任何嵌套區塊。|當您有未預期的時顯示 \<# or #> 。 也就是，如果您有，在 \<# after another open tag that has not been closed, or you have a #> 它之前沒有未封閉的開啟標記。 訊息會提供不相符標記的行號。|請移除不相符的開始或結束標記，或使用 escape 字元。|
|指定的指示詞格式錯誤。 將會忽略指示詞。 請以格式指定指示詞 `<#@ name [parametername="parametervalue"]*  #>`|如果未以正確的格式指定指示詞，則會顯示剖析器所顯示的。 訊息會提供不正確指示詞的行號。|請確定所有指示詞都是在表單中 `<#@ name [parametername="parametervalue"]*  #>` 。 如需詳細資訊，請參閱 [T4 文字模板](../modeling/t4-text-template-directives.md)指示詞。|
|無法載入 {0} 已註冊指示詞處理器 ' ' 的元件 ' ' {1}<br /><br /> {2}|當主機無法載入指示詞處理器時發生。 此訊息會識別為指示詞處理器提供的元件和指示詞處理器的名稱。|請確定指示詞處理器已正確註冊，而且元件存在。|
|{0}在元件 ' ' 中找不到 {1} 已註冊指示詞處理器 ' {2} ' 的類型 ' '<br /><br /> {3}|當無法從元件的元件載入指示詞處理器類型時發生。 訊息提供類型、元件和指示詞處理器的名稱。|Vshost.exe 會在登錄中尋找指示詞處理器資訊 (名稱、元件和類型) 。 請確定指示詞處理器已正確註冊，且該類型存在於元件中。|
|載入元件 ' ' 時發生問題 {0}|載入元件時發生問題時發生。 訊息會提供元件的名稱。|您可以指定要在指示詞中載入的元件 \<@#assembly#> ，以及指示詞處理器載入的元件。 遵循此字串的錯誤訊息應該會提供元件載入失敗原因的詳細資料。|
|針對名為 ' ' 的指示詞建立和初始化處理器時發生問題 {1} 。 處理器的型別為 {0} 。 將會忽略指示詞。|當系統無法建立或初始化指示詞處理器時發生。 訊息提供指示詞的名稱和行號，以及處理器的型別。|請務必使用正確的指示詞處理器，而且指示詞處理器具有公用預設的函式。 否則，請使用 debug 選項找出指示詞處理器的 Initialize () 方法失敗的原因。 如需詳細資訊，請參閱 [疑難排解文字模板](../modeling/debugging-a-t4-text-template.md)。|
|處理名為 ' ' 的指示詞時，擲回例外狀況 {0} 。|當指示詞處理器在處理指示詞時擲回例外狀況時發生。|請確定指示詞處理器的參數正確無誤。|
|嘗試解析元件參考 ' ' 時，主機擲回例外狀況 {0} 。|當主機嘗試解析元件參考時擲回例外狀況時發生。 訊息提供元件參考字串。|元件參考來自指示詞和指示詞 \<@#assembly#> 處理器。 請確定元件參數中提供的 ' name ' 參數是否正確。|
|嘗試為指示詞指定不支援 {1} 的值 ' {0} ' {2}|當您提供不支援的要求或提供引數時，RequiresProvidesDirectiveProcessor 會 (所有產生的指示詞處理器衍生自它) 。|請確定所提供的 name = ' value ' 組中所提供的名稱是正確的，而且會提供參數。|
