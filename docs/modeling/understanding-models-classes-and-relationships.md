---
title: 了解模型、類別和關聯性
description: 瞭解特定領域語言 (DSL) 是由其 DSL 定義檔所定義，而且 DSL 解決方案中大部分的程式碼都是從這個檔案產生的。
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- Domain-Specific Language, models
author: mgoertz-msft
ms.author: mgoertz
manager: jmartens
ms.workload:
- multiple
ms.openlocfilehash: b086f21b466863c3498ce15c15f7077b358c6d39
ms.sourcegitcommit: e3a364c014ccdada0860cc4930d428808e20d667
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/19/2021
ms.locfileid: "112388616"
---
# <a name="understanding-models-classes-and-relationships"></a>了解模型、類別和關聯性
特定領域語言 (DSL) 是由其 DSL 定義檔所定義，以及您可能會撰寫的任何自訂程式碼。 DSL 解決方案中的大部分程式碼都是從這個檔案產生的。

 本主題說明 DSL 定義的核心功能。

## <a name="the-dsl-definition"></a>DSL 定義
 當您開啟時 `Dsl\DslDefinition.dsl` ，您的 Visual Studio 視窗如下圖所示。

 ![dsl 設計工具](../modeling/media/dsl_designer.png)

 DSL 定義中最重要的資訊會顯示在 DSL 定義圖中。 其他資訊（也就是 Dsldefinition.dsl 檔的一部分）會顯示在 [DSL Explorer] 中，通常會出現在圖表的旁邊。 您可以使用圖表來取得最常執行的工作，並使用 DSL Explorer 來進行更先進的自訂作業。

 DSL 定義圖顯示定義模型專案的網域類別，以及定義模型專案之間連結的關聯性。 它也會顯示用來向使用者顯示模型專案的圖形和連接器。

 ![具有泳道的 dsl 設計工具](../modeling/media/dsl_desinger.png)

 當您在 DSL 定義中選取某個專案（在圖表或 [DSL Explorer] 中）時，該專案的相關資訊會顯示在屬性視窗中。 其他資訊可能會顯示在 [DSL 詳細資料] 視窗中。

### <a name="models-are-instances-of-dsls"></a>模型是 Dsl 的實例
 *模型* 是由使用者建立的 DSL 實例。 模型包含模型專案，也就是您定義之網域類別的實例，以及元素之間的連結，這些專案是您定義之網域關聯性的實例。 模型也可以有圖形和接點，以顯示圖表上的模型元素和連結。 DSL 定義包含圖形類別、連接器類別，以及圖表的類別。

 DSL 定義也稱為 *網域模型*。 DSL 定義或領域模型是特定領域語言的設計時程表示法，而模型則是網域特定語言的執行時間具現化。

## <a name="domain-classes-define-model-elements"></a>網域類別定義模型元素
 網域類別是用來建立網域中的各種元素，而網域關聯性則是元素之間的連結。 它們是專案和連結的設計時程表示法，其會在建立模型時由設計特定語言的使用者具現化。

 下圖顯示由音樂庫 DSL 的使用者所建立的模型。 音樂專輯以包含歌曲清單的方塊表示。 演出者會以圓角方塊表示，並連接到它們所貢獻的專輯。

 ![已產生的 DSL 執行個體模型](../modeling/media/music_instance.png)

 DSL 定義分隔兩個層面。 模型圖上的模型專案外觀是使用圖形類別和連接器類別來定義。 在模型中傳送的資訊是使用網域類別和網域關聯性來定義。

 下圖顯示音樂媒體櫃 DSL 定義中的網域類別和關聯性。

 ![內嵌和參考關聯性](../modeling/media/music_classes.png)

 下圖顯示四個網域類別：音樂、專輯、演出者和首歌。 網域類別會定義網域屬性，例如名稱、標題等等。 在實例模型中，這些屬性的值會顯示在圖表上。

 類別之間的網域關聯性如下： MusicHasAlbums、MusicHasArtists、AlbumbHasSongs 和 ArtistAppearedOnAlbums。 關聯性具有多重性，例如 1. 1、0 ... *。 例如，每個歌曲都必須透過 AlbumHasSongs 關聯性，與一個專輯完全相關。 每張專輯都可以有任意數目的歌曲。

### <a name="rearranging-the-dsl-definition-diagram"></a>重新排列 DSL 定義圖
 請注意，在 DSL 定義圖上，網域類別可以出現數次，如同專輯在這張圖中所示。 一律會有一個主視圖，而且可能會有一些 *參考* 視圖。

 若要重新排列 DSL 定義圖，您可以：

- 使用 [將 **樹狀結構移至此處** ] 和 [ **分割樹狀** 命令]，來交換主要和參考視圖。 以滑鼠右鍵按一下單一網域類別，以查看這些命令。

- 按 Ctrl + 向上鍵和 Ctrl + 向下鍵，重新排序網域類別和圖形類別。

- 使用每個圖形右上方的圖示來折迭或展開類別。

- 按一下網域類別底部的減號 (-) ，以折迭樹狀結構的部分。

## <a name="inheritance"></a>繼承
 您可以使用繼承來定義網域類別。 若要建立繼承衍生，請按一下 [繼承] 工具，然後按一下 [衍生類別]，再按一下基類。 模型專案具有其專屬網域類別上定義的所有屬性，以及繼承自基類的所有屬性。 它也會繼承其在關聯性中的角色。

 繼承也可以在關聯性、圖形和連接器之間使用。 繼承必須保留在相同的群組中。 圖形無法繼承自網域類別。

## <a name="domain-relationships"></a>網域關聯性
 模型專案可以透過關聯性連結。 連結一律為二進位;它們正好連結兩個元素。 不過，任何專案都可以有多個其他物件的連結，而且同一組元素之間甚至可以有一個以上的連結。

 就像您可以定義不同類別的專案一樣，您可以定義不同類別的連結。 連結的類別稱為 *網域關聯* 性。 網域關聯性會指定其實例可連接的元素類別。 關聯性的每一端稱為 *角色*，而網域關聯性會定義這兩個角色的名稱，以及關聯性本身的名稱。

 網域關聯性有兩種：內嵌關聯性和參考關聯性。 在 DSL 定義圖上，內嵌關聯性在每個角色上都有實線，而參考關聯性具有虛線。

### <a name="embedding-relationships"></a>內嵌關聯性
 模型中的每個元素（其根目錄除外）都是一個內嵌連結的目標。 因此，整個模型形成內嵌連結的單一樹狀結構。 內嵌關聯性代表內含專案或擁有權。 以這種方式相關的兩個模型專案也稱為父系和子系。 子系被視為內嵌在父系中。

 內嵌連結通常不會明確顯示為圖表上的連接器。 相反地，它們通常會以內含專案表示。 模型的根是由圖表表示，而內嵌于其中的元素會顯示為圖表上的圖形。

 在此範例中，根類別的音樂具有 MusicHasAlbums 至專輯的內嵌關聯性，其具有首歌的內嵌 AlbumHasSongs。 歌曲會顯示為每個專輯內清單中的專案。 音樂也有演出者類別的內嵌 MusicHasArtists，其實例也會顯示為圖表上的圖形。

 依預設，當刪除父元素的父系時，會自動將其刪除。

 當模型儲存至 XML 格式的檔案時，除非您已自訂序列化，否則內嵌專案會在其父系內嵌套。

> [!NOTE]
> 內嵌與繼承不同。 內嵌關聯性中的子系不會繼承父系的屬性。 內嵌是模型元素之間的連結類型。 繼承是類別之間的關聯性，並不會建立模型專案之間的連結。

### <a name="embedding-rules"></a>內嵌規則
 實例模型中的每個元素都必須只是一個內嵌連結的目標，但模型的根除外。

 因此，每個非抽象網域類別（根類別除外）都必須是至少一個內嵌關聯性的目標，或者必須從基類繼承內嵌。 類別可以是兩個或多個內嵌的目標，但其實例模型元素一次只能有一個父系。 從目標到來源的多重性必須為 0 ..1 或 1 ..1。

### <a name="the-explorer-displays-the-embedding-tree"></a>Explorer 會顯示內嵌樹狀結構
 您的 DSL 定義也會建立一個 explorer，讓使用者可以在其模型圖旁邊看到。

 ![已產生的 DSL 總管](../modeling/media/music_explorer.png)

 Explorer 會顯示模型中的所有元素，甚至是尚未定義任何圖形的專案。 它會顯示元素和內嵌關聯性，但不會顯示參考關聯性。

 若要查看專案之網域屬性的值，使用者可在模型圖表或模型瀏覽器中選取專案，然後開啟屬性視窗。 它會顯示所有的網域屬性，包括未顯示在圖表上的屬性。 在此範例中，每個歌曲都有標題和內容類型，但只有標題的值會顯示在圖表上。

## <a name="reference-relationships"></a>參考關聯性
 參考關聯性代表任何未內嵌的關聯性類型。

 參考關聯性通常會在圖表上顯示為形狀之間的連接線。

 在模型的 XML 表示中，兩個專案之間的參考連結會使用名字來表示 *。* 也就是，名稱可唯一識別模型中的每個元素。 每個模型專案的 XML 節點包含一個節點，可指定關聯性的名稱和另一個專案的標記。

## <a name="roles"></a>角色
 每個網域關聯性都有兩個角色：「來源角色」和「目標」角色。

 在下圖中，「 **發行者** 」網域類別和 **PublisherCatalog** 網域關聯性之間的線條是來源角色。 網域關聯和 **專輯** 網域類別之間的線條是目標角色。

 ![角色和屬性。](../modeling/media/propertycode.png)

 當您撰寫程式碼來處理模型時，與關聯性相關聯的名稱特別重要。 例如，當您建立 DSL 方案時，產生的類別發行者會有一個是專輯集合的屬性目錄。 類別專輯具有屬於類別發行者的單一實例的屬性發行者。

 當您在 DSL 定義中建立關聯性時，會為屬性和關聯性名稱提供預設值。 不過，您可以變更它們。

## <a name="multiplicities"></a>多重性
 多重性指定網域關聯性中可以有相同角色的元素數目。 在此範例中，零對多 (0。 \***目錄** 角色上的) 多重性設定會指定 **發行者** 網域類別的任何實例，可以有您想要的 **PublisherCatalog** 關聯性連結數目。

 您可以在圖表上輸入或修改 [ `Multiplicity` **屬性** ] 視窗中的屬性，以設定角色的多重性。 下表描述這個屬性的設定。

|多重性類型|描述|
|-|-|
|0 ... * (零到多個) |網域類別的每個實例都可以有多個關聯性實例或沒有關聯性的實例。|
|0 ..1 (零到一個) |網域類別的每個實例都不能有一個以上的關聯性實例，或是沒有關聯性的實例。|
|1 ..1 (一) |網域類別的每個實例都可以有一個關聯性實例。 您無法從 role 類別的任何實例建立此關聯性的多個實例。 如果啟用驗證，當 role 類別的任何實例沒有關聯性的實例時，就會出現驗證錯誤。|
|1.. * (一到多個) |具有此多重性的角色上類別的每個實例都可以有多個關聯性的實例，而且每個實例都必須至少有一個關聯性實例。 如果啟用驗證，當 role 類別的任何實例沒有關聯性的實例時，就會出現驗證錯誤。|

## <a name="domain-relationships-as-classes"></a>做為類別的網域關聯性
 連結會在存放區中表示為 LinkElement 的實例，這是 ModelElement 的衍生類別。 您可以在網域關聯性的領域模型圖表中定義這些屬性。

 您也可以將關聯性設定為其他關聯性的來源或目標。 在領域模型圖表中，以滑鼠右鍵按一下網域關聯性，然後按一下 [ **顯示為類別**]。 將會出現一個額外的類別方塊。 然後您就可以連接其關聯性。

 您可以透過繼承來定義部分關聯性，就像您可以使用網域類別一樣。 選取衍生的關聯性，並在屬性視窗中設定 **基底關聯** 性。

 衍生的關聯性專門于其基底關聯性。 其連結的網域類別應該衍生自，或與基底關聯性所連結的類別相同。 在模型中建立衍生關聯性的連結時，它是衍生的和基底關聯性的實例。 在程式碼中，您可以使用基底或衍生類別所產生的屬性，導覽至連結的相對結尾。

## <a name="see-also"></a>另請參閱

- [Domain-Specific Language Tools Glossary](/previous-versions/bb126564(v=vs.100)) (特定領域語言工具字彙表)