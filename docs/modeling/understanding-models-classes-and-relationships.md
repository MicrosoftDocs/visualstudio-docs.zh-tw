---
title: 了解模型、類別和關聯性
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- Domain-Specific Language, models
author: jillre
ms.author: jillfra
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: 391dff6540bcea26f63d8ea88f344455722b742a
ms.sourcegitcommit: 5f6ad1cefbcd3d531ce587ad30e684684f4c4d44
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/22/2019
ms.locfileid: "72748226"
---
# <a name="understanding-models-classes-and-relationships"></a>了解模型、類別和關聯性
網域指定的語言（DSL）是由其 DSL 定義檔所定義，以及您可能會撰寫的任何自訂程式碼。 DSL 解決方案中的大部分程式碼都是從這個檔案產生的。

 本主題說明 DSL 定義的核心功能。

## <a name="the-dsl-definition"></a>DSL 定義
 當您開啟 `Dsl\DslDefinition.dsl` 時，Visual Studio 視窗會類似下圖。

 ![dsl 設計工具](../modeling/media/dsl_designer.png)

 Dsl 定義中最重要的資訊會顯示在 DSL 定義圖中。 其他資訊（也是 Dsldefinition.dsl 檔的一部分）會顯示在 [DSL Explorer] 中，通常會出現在圖表的側邊。 您可以使用圖表來進行最常見的工作，並使用 DSL Explorer 進行更先進的自訂。

 DSL 定義圖會顯示定義模型專案的網域類別，以及定義模型專案之間連結的關聯性。 它也會顯示用來向使用者顯示模型元素的圖形和連接器。

 ![具有泳道的 dsl 設計工具](../modeling/media/dsl_desinger.png)

 當您選取 DSL 定義中的專案時（不論是在圖表上或在 [DSL Explorer] 中），屬性視窗中都會顯示其相關資訊。 其他資訊可能會顯示在 [DSL 詳細資料] 視窗中。

### <a name="models-are-instances-of-dsls"></a>模型是 Dsl 的實例
 「*模型*」（model）是使用者所建立之 DSL 的實例。 模型包含模型專案，這些專案是您所定義之網域類別的實例，而元素之間的連結則是您定義之網域關聯性的實例。 模型也可以有圖形和連接器，以顯示圖表上的模型專案和連結。 DSL 定義包括圖形類別、連接器類別，以及圖表的類別。

 DSL 定義也稱為*領域模型*。 DSL 定義或領域模型是特定領域語言的設計時程表示法，而模型則是特定領域語言的執行時間具現化。

## <a name="domain-classes-define-model-elements"></a>定義域類別定義模型元素
 網域類別是用來建立網域中的各種元素，而網域關聯性則是元素之間的連結。 這些專案和連結的設計時程表示法，會在建立模型時由設計特定語言的使用者具現化。

 下圖顯示由「音樂媒體櫃 DSL」的使用者所建立的模型。 音樂專輯會以包含歌曲清單的方塊來表示。 演出者是以圓角方塊表示，而且會連接到他們所貢獻的專輯。

 ![已產生的 DSL 執行個體模型](../modeling/media/music_instance.png)

 DSL 定義分成兩個層面。 模型圖表上的模型元素外觀是使用圖形類別和連接器類別來定義。 模型中攜帶的資訊是使用網域類別和網域關聯性所定義。

 下圖顯示 [音樂媒體櫃] 的 DSL 定義中的網域類別和關聯性。

 ![內嵌和參考關聯性](../modeling/media/music_classes.png)

 下圖顯示四個網域類別：音樂、專輯、演出者和歌曲。 網域類別會定義網域屬性，例如名稱、標題等等。 在實例模型中，這些屬性的值會顯示在圖表上。

 類別之間的關聯性如下： MusicHasAlbums、MusicHasArtists、AlbumbHasSongs 和 ArtistAppearedOnAlbums。 關聯性的多重性如 1 ..1、0 ... *。 例如，每個歌曲都必須透過 AlbumHasSongs 關聯性，只與一個專輯相關。 每個專輯都可以有任意數目的歌曲。

### <a name="rearranging-the-dsl-definition-diagram"></a>重新排列 DSL 定義圖
 請注意，網域類別可以在 DSL 定義圖上出現數次，如專輯在此圖片中所示。 一律有一個主要視圖，而且可以有一些*參考*視圖。

 若要重新排列 DSL 定義圖，您可以：

- 使用 [在**此帶入樹狀結構**] 和 [**分割樹狀**] 命令，交換主要和參考的觀點。 以滑鼠右鍵按一下單一網域類別，以查看這些命令。

- 按 Ctrl + 向上鍵和 Ctrl + Down，重新排序網域類別和圖形類別。

- 使用每個圖形右上角的圖示，折迭或展開類別。

- 按一下網域類別底部的減號（-），折迭樹狀結構的各個部分。

## <a name="inheritance"></a>繼承
 您可以使用繼承來定義網域類別。 若要建立繼承衍生，請按一下 [繼承] 工具，按一下 [衍生類別]，然後按一下 [基類]。 模型專案具有在它自己的網域類別上定義的所有屬性，以及繼承自基類的所有屬性。 它也會繼承其在關聯性中的角色。

 繼承也可以在關聯性、圖形和連接器之間使用。 繼承必須保留在相同的群組中。 圖形無法繼承自網域類別。

## <a name="domain-relationships"></a>網域關聯性
 模型專案可以透過關聯性進行連結。 連結一律為二進位;它們只會連結兩個元素。 不過，任何專案都可以有多個其他物件的連結，而且同一對元素之間甚至可以有一個以上的連結。

 就像您可以定義不同類別的專案一樣，您可以定義不同類別的連結。 連結的類別稱為*網域關聯*性。 網域關聯性會指定其實例可以連接的元素類別。 關聯性的每個端點稱為「*角色*」（role），而網域關聯性會定義兩個角色的名稱，以及關聯性本身的名稱。

 網域關聯性有兩種：內嵌關聯性和參考關聯性。 在 DSL 定義圖上，內嵌關聯性在每個角色都有實線，而參考關聯性則有虛線。

### <a name="embedding-relationships"></a>內嵌關聯性
 模型中的每個元素（其根除外）都是一個內嵌連結的目標。 因此，整個模型形成內嵌連結的單一樹狀結構。 內嵌關聯性代表內含專案或擁有權。 以這種方式關聯的兩個模型元素也稱為父系和子系。 子系稱為內嵌在父系中。

 內嵌連結通常不會明確地顯示為圖表上的連接器。 相反地，它們通常是以內含專案來表示。 模型的根是以圖表表示，而內嵌在其中的元素會顯示為圖表上的圖形。

 在此範例中，[音樂] 根類別的 [內嵌關聯性] MusicHasAlbums 為 [專輯]，其中包含歌曲的內嵌 AlbumHasSongs。 歌曲會顯示為每個專輯內清單中的專案。 音樂也有 [演出者] 類別的內嵌 MusicHasArtists，其實例也會在圖表上顯示為圖形。

 根據預設，當父元素被刪除時，會自動刪除內嵌專案。

 將模型儲存至 XML 格式的檔案時，除非您已自訂序列化，否則內嵌專案會嵌套于其父系內部。

> [!NOTE]
> 內嵌與繼承不同。 內嵌關聯性中的子系不會繼承父系的屬性。 內嵌是模型專案之間的連結類型。 繼承是類別之間的關聯性，而且不會建立模型專案之間的連結。

### <a name="embedding-rules"></a>內嵌規則
 實例模型中的每個專案都必須是只有一個內嵌連結的目標，但模型的根除外。

 因此，除了根類別以外，每個非抽象網域類別都必須是至少一個內嵌關聯性的目標，或者必須繼承基類的內嵌。 類別可以是兩個或多個內嵌的目標，但其實例模型元素一次只能有一個父系。 從目標到來源的多重性必須是 0 ..1 或 1 ..1。

### <a name="the-explorer-displays-the-embedding-tree"></a>Explorer 會顯示內嵌樹狀結構
 您的 DSL 定義也會建立 explorer，使用者會在其模型圖表旁看到它。

 ![已產生的 DSL 總管](../modeling/media/music_explorer.png)

 Explorer 會顯示模型中的所有專案，甚至是您尚未定義任何圖形的元素。 它會顯示元素和內嵌關聯性，但不會參考關聯性。

 若要查看專案的網域屬性值，使用者可以在模型圖表或模型 explorer 中選取專案，然後開啟屬性視窗。 它會顯示所有的定義域屬性，包括不會顯示在圖表上的內容。 在此範例中，每個歌曲都有標題和內容類型，但只有標題的值會顯示在圖表上。

## <a name="reference-relationships"></a>參考關聯性
 參考關聯性表示任何不是內嵌的關聯性類型。

 參考關聯性通常會顯示在圖表上，做為圖形之間的連接線。

 在模型的 XML 標記法中，兩個元素之間的參考連結會使用*名字表示。* 也就是說，名字標記是可唯一識別模型中每個元素的名稱。 每個模型專案的 XML 節點都包含一個節點，可指定關聯性的名稱以及另一個元素的標記。

## <a name="roles"></a>角色
 每個網域關聯性都有兩個角色：來源角色和目標角色。

 在下圖中，「**發行者**」網域類別與**PublisherCatalog**網域關聯性之間的程式程式碼是來源角色。 網域關聯性和**專輯**網域類別之間的這一行是目標角色。

 ![角色和屬性。](../modeling/media/propertycode.png)

 當您撰寫的程式碼會流經模型時，與關聯性相關聯的名稱特別重要。 例如，當您建立 DSL 方案時，產生的類別發行者會有一個屬於專輯集合的屬性目錄。 類別專輯具有「屬性發行者」，這是「發行者」類別的單一實例。

 當您在 DSL 定義中建立關聯性時，會將屬性和關聯性名稱指定為預設值。 不過，您可以變更它們。

## <a name="multiplicities"></a>多重性
 多重性會指定在網域關聯性中可以有多少個元素具有相同的角色。 在此範例中，**目錄**角色的「零對多（0 \*）多重性」設定會指定「**發行者**」網域類別的任何實例，都可以有您想要提供的**PublisherCatalog**關係連結數目。

 藉由在圖表上輸入或修改 [**屬性**] 視窗中的 [`Multiplicity`] 屬性，來設定角色的多重性。 下表描述這個屬性的設定。

|多重性類型|描述|
|-|-|
|0： * （零到多個）|網域類別的每個實例都可以有多個關聯性實例，或沒有關聯性的實例。|
|0 ..1 （零到一）|網域類別的每個實例都不能有一個以上的關聯性實例，也不能有關聯性的實例。|
|1 ..1 （一）|網域類別的每個實例都可以有一個關聯性實例。 您無法從 role 類別的任何實例，建立這個關聯性的多個實例。 如果驗證已啟用，當 role 類別的任何實例沒有關聯性的實例時，就會出現驗證錯誤。|
|1. * （一到多個）|具有此多重性之角色上的每個類別實例，都可以有多個關聯性實例，而且每個實例至少必須有一個關聯性實例。 如果驗證已啟用，當 role 類別的任何實例沒有關聯性的實例時，就會出現驗證錯誤。|

## <a name="domain-relationships-as-classes"></a>網域關聯性做為類別
 連結會在存放區中表示為 LinkElement 的實例，這是 ModelElement 的衍生類別。 您可以在網域關聯性的領域模型圖表中定義這些屬性。

 您也可以讓關聯性成為其他關聯性的來源或目標。 在領域模型圖表中，以滑鼠右鍵按一下網域關聯性，然後按一下 [**顯示為類別**]。 [其他類別] 方塊隨即出現。 然後您可以連接其關聯性。

 您可以透過繼承來定義部分關聯性，就像您可以使用網域類別一樣。 選取 衍生關聯性，然後在 屬性視窗中設定**基底關聯**性。

 衍生關聯性專用於其基底關聯性。 其連結的網域類別應該衍生自，或與基底關聯性所連結的類別相同。 在模型中建立衍生關聯性的連結時，它是衍生的和基底關聯性的實例。 在 [程式碼] 中，您可以使用基底或衍生類別所產生的屬性，流覽至連結的相對結尾。

## <a name="see-also"></a>請參閱

- [Domain-Specific Language Tools Glossary](https://msdn.microsoft.com/ca5e84cb-a315-465c-be24-76aa3df276aa) (特定領域語言工具字彙表)
