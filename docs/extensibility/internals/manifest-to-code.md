---
title: Manifest to Code |Microsoft Docs
description: 瞭解如何使用程式碼工具的資訊清單，該工具會使用 imagemanifest 檔案搭配 Visual Studio 映射服務使用。
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: reference
ms.assetid: 17ecacea-397d-4a97-b003-01bd5d56e936
author: leslierichardson95
ms.author: lerich
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: e63349b27ec8ea5617f6d1836ce9ece3251662d3
ms.sourcegitcommit: bab002936a9a642e45af407d652345c113a9c467
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/25/2021
ms.locfileid: "112903161"
---
# <a name="manifest-to-code"></a>資訊清單至程式碼
Manifest to Code 工具是一種主控台應用程式，它會採用 Visual Studio 映射服務的 imagemanifest 檔，並產生包裝函式檔案或檔案，以參考 Visual Studio 擴充功能的 c + +、c #、VB 或 .vsct 檔案中的影像資訊清單值。 此工具會產生包裝函式檔案，這些檔案可用來直接向 Visual Studio 映射服務要求影像，或在程式碼不會處理它自己的任何 UI 和轉譯時，透過 Api 來傳遞資訊清單值。

## <a name="how-to-use-the-tool"></a>如何使用工具
 **語法**

 ManifestToCode/manifest： \<Image Manifest file> /language： \<Code Language>\<Optional Args>

 **引數**

|**交換器名稱**|**注意事項**|**必要或選擇性**|
|-|-|-|
|/manifest|要用來建立或更新程式碼包裝函式的影像資訊清單路徑。|必要|
|/language|要在其中產生程式碼包裝函式的語言。<br /><br /> 有效值： CPP、c + +、CS、CSharp、c #、VB 或 .VSCT 值不區分大小寫。<br /><br /> 針對 .VSCT language 選項，會忽略/monikerClass、/classAccess 和/namespace 選項。|必要|
|/imageIdClass|ImageIdClass 的名稱和工具所建立的相關聯檔案。 針對 c + + 語言選項，只會產生 .h 檔案。<br /><br /> 預設值： \<Manifest Path> \MyImageIds。\<Lang Ext>|選用|
|/monikerClass|MonikerClass 的名稱和工具所建立的相關聯檔案。 針對 c + + 語言選項，只會產生 .h 檔案。 這會忽略 .VSCT 語言。<br /><br /> 預設值： \<Manifest Path> \MyMonikers。\<Lang Ext>|選用|
|/classAccess|ImageIdClass 和 monikerClass 的存取修飾詞。 請確定存取修飾詞對指定的語言有效。 .VSCT language 選項會忽略這個選項。<br /><br /> 預設值： Public|選用|
|/namespace|程式碼包裝函式中定義的命名空間。 .VSCT language 選項會忽略這個選項。 無論選擇的語言選項是 '. ' 或 '：： ' 都是有效的命名空間分隔符號。<br /><br /> 預設值： MyImages|選用|
|/noLogo|設定此旗標會停止產品和著作權資訊的列印。|選用|
|/?|列印出說明資訊。|選用|
|/help|列印出說明資訊。|選用|

 **範例**

- ManifestToCode/manifest： D:\MyManifest.imagemanifest/language： CSharp

- ManifestToCode/manifest： D:\MyManifest.imagemanifest/language： c + +/namespace： My：： Namespace/imageIdClass： MyImageIds/monikerClass： MyMonikers/classAccess： friend

- ManifestToCode/manifest： D:\MyManifest.imagemanifest/language： .VSCT/imageIdClass： MyImageIds

## <a name="notes"></a>備註

- 我們建議您搭配 Manifest from Resources 工具所產生的影像資訊清單來使用此工具。

- 此工具只會查看符號專案以產生程式碼包裝函式。 如果映射資訊清單未包含符號，則產生的程式碼包裝函式將會是空的。 如果映射資訊清單中有一組影像或映射未使用符號，則會從程式碼包裝函式中排除它們。

## <a name="sample-output"></a>範例輸出
 **C # 包裝函式**

 適用于 c # 的簡單映射識別碼和影像標記類別，將類似于下列程式碼：

```csharp
//-----------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by the ManifestToCode tool.
//     Tool Version: 14.0.15198
// </auto-generated>
//-----------------------------------------------------------------------------

using System;

namespace MyImages
{
    public static class MyImageIds
    {
        public static readonly Guid AssetsGuid = new Guid("{442d8739-efde-46a4-8f29-e3a1e5e7f8b4}");

        public const int MyImage1 = 0;
        public const int MyImage2 = 1;
    }
}
//-----------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by the ManifestToCode tool.
//     Tool Version: 14.0.15198
// </auto-generated>
//-----------------------------------------------------------------------------

using Microsoft.VisualStudio.Imaging.Interop;

namespace MyImages
{
    public static class MyMonikers
    {
        public static ImageMoniker MyImage1 { get { return new ImageMoniker { Guid = MyImageIds.AssetsGuid, Id = MyImageIds.MyImage1 }; } }
        public static ImageMoniker MyImage2 { get { return new ImageMoniker { Guid = MyImageIds.AssetsGuid, Id = MyImageIds.MyImage2 }; } }
    }
}
```

 **C + + 包裝函式**

 適用于 c + + 的一組簡單影像識別碼和影像標記類別，將類似于下列程式碼：

```cpp
//-----------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by the ManifestToCode tool.
//     Tool Version: 14.0.15198
// </auto-generated>
//-----------------------------------------------------------------------------

#pragma once

#include <guiddef.h>

namespace MyImages {

class MyImageIds {
public:

    static const GUID AssetsGuid;

    static const int MyImage1 = 0;
    static const int MyImage2 = 1;

};

__declspec(selectany) const GUID MyImageIds::AssetsGuid = {0x442d8739,0xefde,0x46a4,{0x8f,0x29,0xe3,0xa1,0xe5,0xe7,0xf8,0xb4}};

}
//-----------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by the ManifestToCode tool.
//     Tool Version: 14.0.15198
// </auto-generated>
//-----------------------------------------------------------------------------

#pragma once

#include "ImageParameters140.h"
#include "MyImageIds.h"

namespace MyImages {

class MyMonikers {
public:

    static const ImageMoniker MyImage1;
    static const ImageMoniker MyImage2;

};

__declspec(selectany) const ImageMoniker MyMonikers::MyImage1 = { MyImageIds::AssetsGuid, MyImageIds::MyImage1 };
__declspec(selectany) const ImageMoniker MyMonikers::MyImage2 = { MyImageIds::AssetsGuid, MyImageIds::MyImage2 };

}
```

 **Visual Basic 包裝函式**

 Visual Basic 的一對簡單映射識別碼和映射的標記類別，將會類似下列程式碼：

```vb
' -----------------------------------------------------------------------------
'  <auto-generated>
'      This code was generated by the ManifestToCode tool.
'      Tool Version: 14.0.15198
'  </auto-generated>
' -----------------------------------------------------------------------------

Imports System

Namespace MyImages

    Public Module MyImageIds

        Public Shared ReadOnly AssetsGuid As Guid = New Guid("{442d8739-efde-46a4-8f29-e3a1e5e7f8b4}")

        Public Const MyImage1 As Integer = 0
        Public Const MyImage2 As Integer = 1

    End Module

End Namespace
' -----------------------------------------------------------------------------
'  <auto-generated>
'      This code was generated by the ManifestToCode tool.
'      Tool Version: 14.0.15198
'  </auto-generated>
' -----------------------------------------------------------------------------

Imports Microsoft.VisualStudio.Imaging.Interop

Namespace MyImages

    Public Module MyMonikers

        Public Readonly Property MyImage1
            Get
                Return New ImageMoniker With {.Guid = MyImageIds.AssetsGuid, .Id = MyImageIds.MyImage1}
            End Get
        End Property

        Public Readonly Property MyImage2
            Get
                Return New ImageMoniker With {.Guid = MyImageIds.AssetsGuid, .Id = MyImageIds.MyImage2}
            End Get
        End Property

    End Module

End Namespace
```

 **.VSCT 包裝函式**

 .Vsct 檔案的映射識別碼集如下所示：

```xml
<?xml version='1.0' encoding='utf-8'?>
<!--
- [auto-generated]
     This code was generated by the ManifestToCode tool.
     Tool Version: 14.0.15198
- [/auto-generated]
-->
<CommandTable xmlns="http://schemas.microsoft.com/VisualStudio/2005-10-18/CommandTable">
  <Symbols>
    <GuidSymbol name="AssetsGuid" value="{442d8739-efde-46a4-8f29-e3a1e5e7f8b4}">
      <IDSymbol name="MyImage1" value="0" />
      <IDSymbol name="MyImage2" value="1" />
    </GuidSymbol>
  </Symbols>
</CommandTable>
```
