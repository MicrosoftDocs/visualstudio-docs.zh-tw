---
title: 向代碼清單 |微軟文件
ms.date: 11/04/2016
ms.topic: conceptual
ms.assetid: 17ecacea-397d-4a97-b003-01bd5d56e936
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: 768561ef289f0f652f082d40ee9856843721f1ff
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/06/2020
ms.locfileid: "80707260"
---
# <a name="manifest-to-code"></a>資訊清單至程式碼
"向代碼清單"工具是一個控制台應用程式,它為 Visual Studio 影像服務獲取 .imagemanifest 檔,並生成包裝檔或檔,用於引用影像清單的值,用於 C++、C#、VB 或 .vsct 檔案,用於 Visual Studio 擴展名。 此工具生成包裝檔,可用於直接從 Visual Studio 影像服務請求圖像,或者如果代碼不處理其自己的任何 UI 和呈現,則用於透過 API 傳遞清單值。

## <a name="how-to-use-the-tool"></a>如何使用該工具
 **語法**

 清單代碼/清單:\<影像清單檔>/語言\<: 程式碼語言\<> 可選Args>

 **引數**

||||
|-|-|-|
|**切換名稱**|**注意**|**必要或選擇**|
|/清單|用於創建或更新代碼包裝器的圖像清單的路徑。|必要|
|/語言|生成代碼包裝器的語言。<br /><br /> 有效值:CPP、C++、CS、C夏普、C#、VB 或 VSCT 這些值不區分大小寫。<br /><br /> 對於 VSCT 語言選項,將忽略 /monikerClass、/classAccess 和 /命名空間選項。|必要|
|/影像 IdClass|圖像 IdClass 的名稱和工具創建的關聯檔。 對於C++語言選項,僅生成 .h 檔。<br /><br /> 默認值:\<清單路徑>_MyImageIds。\<朗·特特·>|選用|
|/名稱類別|名字物件類的名稱和工具創建的關聯檔。 對於C++語言選項,僅生成 .h 檔。 對於 VSCT 語言,將忽略這一點。<br /><br /> 默認值:\<清單路徑>_MyMonikers。\<朗·特特·>|選用|
|/類訪問|圖像 IdClass 和名字類別的訪問修改器。 確保訪問修改器對給定語言有效。 對於 VSCT 語言選項,將忽略此選項。<br /><br /> 預設值:公共|選用|
|/命名空間|在代碼包裝器中定義的命名空間。 對於 VSCT 語言選項,將忽略此選項。 無論選擇何種語言選項,'.'或"::"都是有效的命名空間分隔符。<br /><br /> 預設值:我的影像|選用|
|/noLogo|設置此標誌將停止列印產品和版權資訊。|選用|
|/?|列印説明資訊。|選用|
|/help|列印説明資訊。|選用|

 **範例**

- 清單代碼/清單:D:\Mymanifest.圖像清單/語言:CSharp

- 清單Tocode/清單:D:\MyManifest.imagemanifest/語言:C++/命名空間:我的:::名稱空間/圖像IdClass:MyImageIds/名字類別:MyMonikers/classAccess:朋友

- 清單代碼/清單:D:\MyManifest.圖像清單/語言:VSCT/圖像IdClass:MyImageIds

## <a name="notes"></a>注意

- 我們建議您將此工具與「來自資源清單」工具生成的圖像清單一起使用。

- 該工具僅查看符號項目以生成代碼包裝器。 如果圖像清單不包含符號,則生成的代碼包裝器將為空。 如果圖像清單中有一個不使用符號的圖像或圖像集,則它們將從代碼包裝器中排除。

## <a name="sample-output"></a>範例輸出
 **C# 包裝**

 C# 的一對簡單影像 ID 和影像名稱物件類別將類似於以下代碼:

```csharp
//-----------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by the ManifestToCode tool.
//     Tool Version: 14.0.15198
// </auto-generated>
//-----------------------------------------------------------------------------

using System;

namespace MyImages
{
    public static class MyImageIds
    {
        public static readonly Guid AssetsGuid = new Guid("{442d8739-efde-46a4-8f29-e3a1e5e7f8b4}");

        public const int MyImage1 = 0;
        public const int MyImage2 = 1;
    }
}
//-----------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by the ManifestToCode tool.
//     Tool Version: 14.0.15198
// </auto-generated>
//-----------------------------------------------------------------------------

using Microsoft.VisualStudio.Imaging.Interop;

namespace MyImages
{
    public static class MyMonikers
    {
        public static ImageMoniker MyImage1 { get { return new ImageMoniker { Guid = MyImageIds.AssetsGuid, Id = MyImageIds.MyImage1 }; } }
        public static ImageMoniker MyImage2 { get { return new ImageMoniker { Guid = MyImageIds.AssetsGuid, Id = MyImageIds.MyImage2 }; } }
    }
}
```

 **C++包裝**

 一對用於C++的簡單影像 ID 和影像名字物件類別將類似於以下代碼:

```cpp
//-----------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by the ManifestToCode tool.
//     Tool Version: 14.0.15198
// </auto-generated>
//-----------------------------------------------------------------------------

#pragma once

#include <guiddef.h>

namespace MyImages {

class MyImageIds {
public:

    static const GUID AssetsGuid;

    static const int MyImage1 = 0;
    static const int MyImage2 = 1;

};

__declspec(selectany) const GUID MyImageIds::AssetsGuid = {0x442d8739,0xefde,0x46a4,{0x8f,0x29,0xe3,0xa1,0xe5,0xe7,0xf8,0xb4}};

}
//-----------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by the ManifestToCode tool.
//     Tool Version: 14.0.15198
// </auto-generated>
//-----------------------------------------------------------------------------

#pragma once

#include "ImageParameters140.h"
#include "MyImageIds.h"

namespace MyImages {

class MyMonikers {
public:

    static const ImageMoniker MyImage1;
    static const ImageMoniker MyImage2;

};

__declspec(selectany) const ImageMoniker MyMonikers::MyImage1 = { MyImageIds::AssetsGuid, MyImageIds::MyImage1 };
__declspec(selectany) const ImageMoniker MyMonikers::MyImage2 = { MyImageIds::AssetsGuid, MyImageIds::MyImage2 };

}
```

 **可視基本包裝器**

 Visual Basic 的一對簡單影像 ID 和影像名稱物件類別將類似於以下代碼:

```vb
' -----------------------------------------------------------------------------
'  <auto-generated>
'      This code was generated by the ManifestToCode tool.
'      Tool Version: 14.0.15198
'  </auto-generated>
' -----------------------------------------------------------------------------

Imports System

Namespace MyImages

    Public Module MyImageIds

        Public Shared ReadOnly AssetsGuid As Guid = New Guid("{442d8739-efde-46a4-8f29-e3a1e5e7f8b4}")

        Public Const MyImage1 As Integer = 0
        Public Const MyImage2 As Integer = 1

    End Module

End Namespace
' -----------------------------------------------------------------------------
'  <auto-generated>
'      This code was generated by the ManifestToCode tool.
'      Tool Version: 14.0.15198
'  </auto-generated>
' -----------------------------------------------------------------------------

Imports Microsoft.VisualStudio.Imaging.Interop

Namespace MyImages

    Public Module MyMonikers

        Public Readonly Property MyImage1
            Get
                Return New ImageMoniker With {.Guid = MyImageIds.AssetsGuid, .Id = MyImageIds.MyImage1}
            End Get
        End Property

        Public Readonly Property MyImage2
            Get
                Return New ImageMoniker With {.Guid = MyImageIds.AssetsGuid, .Id = MyImageIds.MyImage2}
            End Get
        End Property

    End Module

End Namespace
```

 **VSCT 包裝器**

 .vsct 檔案的圖像 ID 會類似於:

```xml
<?xml version='1.0' encoding='utf-8'?>
<!--
- [auto-generated]
     This code was generated by the ManifestToCode tool.
     Tool Version: 14.0.15198
- [/auto-generated]
-->
<CommandTable xmlns="http://schemas.microsoft.com/VisualStudio/2005-10-18/CommandTable">
  <Symbols>
    <GuidSymbol name="AssetsGuid" value="{442d8739-efde-46a4-8f29-e3a1e5e7f8b4}">
      <IDSymbol name="MyImage1" value="0" />
      <IDSymbol name="MyImage2" value="1" />
    </GuidSymbol>
  </Symbols>
</CommandTable>
```
