---
title: 測試區域5：變更原始檔控制 |Microsoft Docs
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- source control [Visual Studio SDK], changing
- source control plug-ins, changing source control
ms.assetid: fdf09e00-108c-4d51-bbd5-72452d52a490
author: madskristensen
ms.author: madsk
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: 654ecdc5034ecc74dc71f5ba03bbeb7d97d0d887
ms.sourcegitcommit: 5f6ad1cefbcd3d531ce587ad30e684684f4c4d44
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/22/2019
ms.locfileid: "72722457"
---
# <a name="test-area-5-change-source-control"></a>測試區域 5︰變更原始檔控制
這個原始檔控制外掛程式測試區域涵蓋透過 [**變更原始檔控制**] 命令來變更原始檔控制。

 [**變更原始檔控制**] 命令為使用者提供四個基本功能：

- **Bind**

   允許使用者建立或重新建立方案/專案和版本存放區之間的原始檔控制連結。

- **解除系結**

   依據每個連接，從原始檔控制中移除專案/方案。

- **連接/中斷連線：**

  切換受控制解決方案的已連線或離線狀態，其涵蓋範圍為3。 如需詳細資訊，請參閱[測試區域3：簽出/復原簽出](../../extensibility/internals/test-area-3-check-out-undo-checkout.md)。

## <a name="command-menu-access"></a>命令功能表存取
 下列 [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] 整合式開發環境功能表路徑用於測試案例中。

 變更原始檔控制 **：檔案**、**原始檔控制**、**變更原始檔控制**。

## <a name="test-cases"></a>測試案例
 以下是 [**變更原始檔控制**命令] 測試區域的特定測試案例。

### <a name="case-5a-bind"></a>案例5a： Bind
 [系結] 可讓使用者將原始程式碼控制資訊加入至選取的專案和方案。 使用者通常會收到提示，在原始檔控制中識別要加入這些專案的專案。 使用者可能不會在此作業中建立原始檔控制中的新專案（與 [加入至原始檔控制] 相反）。

| 動作 | 測試步驟 | 要驗證的預期結果 |
| - | - | - |
| 系結至空白位置 | 1. 建立專案。<br />2. 將方案加入至原始檔控制。<br />3. 開啟 [**變更原始檔控制**] 對話方塊（[檔案]、[**原始檔控制** **]、[** **變更來源控制**]）。<br />4. 按一下 [**解除**系結]。<br />5. 接受警告對話方塊（如果出現的話）。<br />6. 選取所有專案。<br />7 **. 按一下 [** 系結]。<br />8. 流覽至原始檔控制存放區中的空白位置。<br />9. 按一下 **[確定]** 以關閉 [**變更原始檔控制**] 對話方塊。<br />10. 按一下 [確認] 對話方塊中**的 [繼續使用這些**系結]。<br />11. 在警告對話方塊中按一下 **[確定] （** 如果出現的話）。<br />12. 簽入所有專案。 如果此步驟成功，請繼續進行下一個步驟。<br />13. 從原始檔控制開啟方案到新位置。 | `Result from Step 12:`<br /><br /> 方案和專案會系結至版本存放區中的新目標並加以寫入。<br /><br /> 已簽入方案和專案檔案。<br /><br /> 版本存放區專案階層符合磁片上專案的資料夾階層。<br /><br /> `Result from Step 13:`<br /><br /> 所有專案專案都會下載。 |
| 系結至與用戶端同步的位置 | 1. 建立專案。<br />2. 將方案加入至原始檔控制。<br />3. 在版本存放區中建立方案和專案的複本（如果使用 [!INCLUDE[vsvss](../../extensibility/includes/vsvss_md.md)]，則為 Share 和 Branch）。<br />4. 開啟 [**變更原始檔控制**] 對話方塊（[檔案]、[**原始檔控制** **]、[** **變更來源控制**]）。<br />5. 全部解除系結。<br />6. 按一下 **[確定] 關閉 [** **變更原始檔控制**] 對話方塊。<br />7. 重新開啟 [**變更原始檔控制**] 對話方塊。<br />8. 全選。<br />9 **. 按一下 [** 系結]。<br />10. 流覽至方案和專案的分支位置（從步驟3）<br />11. 按一下 **[確定]** 以關閉 [**變更原始檔控制**] 對話方塊。<br />12. 以遞迴方式取得所有專案的最新消息。 | Get 之後的檔案內容與 get 之前的檔案內容相同。 |
| 系結至與用戶端不同步的位置 | 1. 建立專案。<br />2. 將方案加入至原始檔控制。<br />3. 在版本存放區中建立方案和專案的複本（如果使用 [!INCLUDE[vsvss](../../extensibility/includes/vsvss_md.md)]，則為 Share 和 Branch）。<br />4. 修改版本存放區中分支專案的檔案。<br />5. 開啟 [**變更原始檔控制**] 對話方塊（[檔案]、[**原始檔控制** **]、[** **變更來源控制**]）。<br />6. 全部解除系結。<br />7. 按一下 **[確定] 關閉 [** **變更原始檔控制**] 對話方塊。<br />8. 重新開啟 [**變更原始檔控制**] 對話方塊。<br />9. 全選。<br />10 **. 按一下 [** 系結]。<br />11. 流覽至方案和專案的分支位置。<br />12. 按一下 **[確定]** 以關閉 [**變更原始檔控制**] 對話方塊。<br />13. 接受警告對話方塊（如果出現的話）。<br />14. 取得所有專案的最新遞迴。 | 在步驟4中修改的檔案也會在本機修改。 |
| 系結永遠不在原始檔控制之下的方案 | 1. 在原始檔控制中建立空的資料夾。<br />2. 建立用戶端專案。<br />3. 開啟 [**變更原始檔控制**] 對話方塊（[檔案]、[**原始檔控制** **]、[** **變更來源控制**]）。<br />4. 將方案系結至原始檔控制中的空白位置。<br />5. 按一下 **[確定]** 以關閉 [**變更原始檔控制**] 對話方塊。<br />6. 按一下 [確認] 對話方塊中**的 [繼續使用這些**系結]。<br />7. 在警告對話方塊中按一下 **[確定] （** 如果出現的話）。 | 方案會加入至原始檔控制。<br /><br /> 方案和專案已簽出。 |
| 取消系結 | 1. 建立專案。<br />2. 將方案加入至原始檔控制。<br />3. 開啟 [變更原始檔控制] 對話方塊。<br />4. 全部解除系結。<br />5. 按一下 **[確定**] 按鈕以關閉對話方塊。 如果此步驟成功，請繼續進行下一個步驟。<br />6. 重新開啟 [**變更原始檔控制**] 對話方塊。<br />7. 系結至不相關的位置。<br />8. 按一下 [**取消**]。 | `Result from Step 5:`<br /><br /> 方案已不再受原始檔控制<br /><br /> `Result from Step 8:`<br /><br /> 方案仍不在原始檔控制之下。 |

### <a name="case-5b-unbind"></a>Case 5b：解除系結
 解除系結會從專案和其方案中移除原始程式碼控制資訊。 受影響的專案和解決方案是以使用者選擇的混合和專案加入至原始檔控制的方式為基礎。

|動作|測試步驟|要驗證的預期結果|
|------------|----------------|--------------------------------|
|解除系結包含一個檔案系統或本機 IIS Web 專案和一個用戶端專案的方案|1. 建立檔案系統或本機 IIS Web 專案。<br />2. 將方案加入至原始檔控制。<br />3. 將新的用戶端專案加入至方案。<br />4. 在出現提示時，接受解決方案的簽出。<br />5. 開啟 [**變更原始檔控制**] 對話方塊。<br />6. 按一下 [**解除**系結]。<br />7. 按一下 **[確定**] 關閉對話方塊。<br />8. 嘗試簽出方案、專案、方案專案、專案專案。|方案和專案不在原始檔控制之下。<br /><br /> [原始檔控制] 功能表命令不會出現。|
|取消解除系結|1. 建立專案。<br />2. 將方案加入至原始檔控制。<br />3. 開啟 [**變更原始檔控制**] 對話方塊。<br />4. 按一下 [**全部解除**系結]。<br />5. 按一下 [**取消**]。|方案在原始檔控制之下。|

### <a name="case-5c-rebind"></a>案例5c：重新系結
 「重新系結」只是解除系結和系結的組合，這是重新系結先前在原始檔控制之下且已解除系結之專案/解決方案的程式。

|動作|測試步驟|要驗證的預期結果|
|------------|----------------|--------------------------------|
|重新系結方案和專案而不關閉**變更原始檔控制**對話方塊|1. 建立專案。<br />2. 將方案加入至原始檔控制。<br />3. 開啟 [**變更原始檔控制**] 對話方塊。<br />4. 按一下 [**解除**系結]。<br />5. 選取所有資料列。<br />6 **. 按一下 [** 系結]。<br />7. 按一下 **[確定]** 以關閉 [**變更原始檔控制**] 對話方塊。<br />8. 出現提示時，接受簽出。|方案和專案是在原始檔控制之下。|
|只重新系結專案，而不關閉**變更原始檔控制**對話方塊|1. 建立專案。<br />2. 使用（檔案 > 原始檔控制，僅將專案新增至原始檔控制-> 將選取的專案加入至原始檔控制。<br />3. 開啟 [變更原始檔控制] 對話方塊。<br />4. 只解除系結專案。<br />5. 只系結專案。|解決方案仍然不受控制。<br /><br /> 專案仍然受到控制。|
|只重新系結解決方案，而不關閉**變更原始檔控制**對話方塊|1. 建立專案。<br />2. 使用（檔案、**原始檔控制**，將**選取的專案加入至原始**檔控制**中，僅**將方案加入至原始檔控制。<br />3. 開啟 [**變更原始檔控制**] 對話方塊。<br />4. 只解除系結方案（不要關閉**變更原始檔控制**對話方塊）。<br />5. 只系結解決方案。<br />6. 按一下 **[確定**] 關閉對話方塊。<br />7. 查看方案和方案專案（如果有的話）。|解決方案仍然受到控制。<br /><br /> 專案保持不受控制。|
|只有在相同的目錄中時，才重新系結方案/專案|1. 建立專案。<br />2. 使用（檔案、**原始檔控制**，將**選取的專案加入至原始**檔控制**中，僅**將專案新增至原始檔控制。<br />3. 關閉方案。<br />4. 建立包含至少兩個專案的新方案。<br />5. 將方案加入至原始檔控制。<br />6. 從原始檔控制加入在步驟1中建立的專案。<br />7. 如果出現提示，請接受解決方案的簽出。<br />8. 簽入整個解決方案。<br />9. 開啟 [**變更原始檔控制**] 對話方塊。<br />10. 選取已加入的專案（從步驟6），然後按一下 [**解除**系結]。<br />11. 按一下 **[確定**] 關閉對話方塊。<br />12. 出現提示時，接受簽出。<br />13. 重新開啟 [**變更原始檔控制**] 對話方塊。<br />14. 選取已加入的專案（從步驟6），**然後按一下 [** 系結]。<br />15. 選取原始位置。|解決方案和專案仍然受到控制。|

## <a name="see-also"></a>請參閱
- [原始檔控制外掛程式測試指南](../../extensibility/internals/test-guide-for-source-control-plug-ins.md)