---
title: VSIX 顏色編輯器 |微軟文件
ms.date: 11/04/2016
ms.topic: conceptual
ms.assetid: 70879c5d-e0f0-4845-993c-2f4229869706
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: aa3ed1f1a2a761a6602ac891eb78b5a5436abf92
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/06/2020
ms.locfileid: "80704035"
---
# <a name="vsix-color-editor"></a>VSIX 色彩編輯器
"視覺工作室擴展顏色編輯器"工具可以為視覺工作室創建和編輯自定義顏色。 該工具還可以生成主題資源鍵,以便在代碼中使用顏色。 此工具可用於為支援該美的可視化工作室擴展製作顏色。 此工具可以打開 .pkgdef 和 .xml 檔。 Visual Studio 主題(.vstheme 檔案)可以通過將檔案副檔名更改為 .xml 與 Visual Studio 擴展顏色編輯器一起使用。 此外,.vstheme 檔案可以匯入到當前的 .xml 檔中。

 ![VSIX 色彩編輯器主圖](../../extensibility/internals/media/vsix-color-editor-hero.png "VSIX 色彩編輯器主圖")

 **套件定義檔**

 包定義 (.pkgdef) 檔案是定義主題的檔。 顏色本身儲存在主題顏色 .xml 檔中,這些檔案編譯為 .pkgdef 檔案。 .pkgdef 檔部署到 Visual Studio 可搜尋的位置,在運行時處理,並合併在一起以定義主題。

 **色彩標記**

 色彩標記由四個元素組成:

- **類別名稱:** 一組顏色的邏輯分組。 如果已有特定於所需 UI 元素或 UI 元素組的顏色,請使用現有類別名稱。

- **權杖名稱:** 顏色標記和權杖集的描述性名稱。 集包括背景和前景(文本)令牌名稱及其所有狀態,這些名稱應命名,以便很容易識別它們應用於的對和狀態。

- **顏色值(或色調):** 每個彩色主題都需要。 始終成對創建背景和文字顏色值。 顏色為背景/前景配對,因此文本(前景)顏色始終根據繪製背景顏色可讀。 這些顏色是連結的,將在 UI 中一起使用。 如果背景不適合與文本一起使用,請不要定義前景顏色。

- **系統顏色名稱:** 用於高對比度顯示器。

## <a name="how-to-use-the-tool"></a>如何使用該工具
 應盡可能重複使用現有的 Visual Studio 顏色,而不是創建新顏色。 但是,對於未定義適當顏色的情況,應創建自定義顏色以保持擴展的相容。

 **建立新顏色標記**

 要使用視覺化工作室擴展顏色編輯器建立自訂顏色,請按照以下步驟操作:

1. 確定新顏色標記的類別和權杖名稱。

2. 選擇 UI 元素將為每個主題使用的色調和高對比度的系統顏色。

3. 使用顏色編輯器創建新的顏色標記。

4. 在可視化工作室擴展中使用顏色。

5. 在可視化工作室中測試更改。

   **步驟 1:確定新顏色標記的類別和令牌名稱。**

   VSColor 的首選命名方案是 **[類別] [UI 類型] [狀態]**。 請勿在 VSColor 名稱中使用"顏色"一詞,因為它是多餘的。

   類別名稱提供邏輯分組,並且應盡可能狹義地定義。 例如,單個工具視窗的名稱可以是類別名稱,但整個營業單位或專案團隊的名稱不是。 將條目分組到類別中有助於防止同名顏色之間的混淆。

   令牌名稱必須清楚地指示將應用顏色的元素類型和情況或"狀態」。 例如,活動資料提示的 **[UI 類型]** 可以命名為 **"DataTip",[****狀態]** 可以命名為"**活動**",從而產生顏色名稱為 **"DataTipActive"。** 由於數據提示具有文本,因此需要定義前景顏色和背景顏色。 使用背景/前景配對,顏色編輯器將自動為背景建立顏色 **「DataTipActive」,** 為前景創建 **「DataTipActiveText」。。**

   如果 UI 部分只有一個狀態,則可以省略名稱的 **[狀態]** 部分。 例如,如果搜尋框具有邊框,並且沒有影響邊框顏色的狀態更改,則邊框顏色標記的名稱可以簡單地稱為 **「SearchBox 邊框**」。

   一些常見的狀態名稱包括:

- Active

- 非使用中

- MouseOver

- 滑鼠向下

- 已選取

- 已取得焦點

  清單項目控制器部份的幾個權杖名稱範例:

- ListItem

- 清單項目邊框

- 清單項目滑鼠

- 清單項目滑鼠的移動邊框

- 清單項目選擇

- 清單項目選擇邊框

- 清單項目已關閉

- 清單項目已關閉邊框

  **步驟 2:選擇 UI 元素將為每個主題使用的色調和高對比度的系統顏色。**

  為 UI 選擇自訂顏色時,請選擇類似的現有 UI 元素,並將其顏色用作基。 盒內 UI 元素的顏色都經過審閱和測試,因此它們在所有主題中看起來合適且運行正常。

  **步驟 3:使用顏色編輯器創建新的顏色標記。**

  啟動顏色編輯器並打開或建立新的自訂主題顏色 .xml 檔案。 從功能表**中選擇"編輯>"新顏色**"。 這會開啟一個對話框,用於為該類別中的顏色項目指定類別和一個或多個名稱:

  ![VSIX 色彩編輯器的新色彩](../../extensibility/internals/media/vsix-color-editor-new-color.png "VSIX 色彩編輯器的新色彩")

  選擇現有類別,或選擇 **「新建類別」** 以創建新類別。 將開啟另一對話框,建立新的類別名稱:

  ![VSIX 色彩編輯器的新分類](../../extensibility/internals/media/vsix-color-editor-new-category.png "VSIX 色彩編輯器的新分類")

  然後,新類別將在 **「新建顏色**」類別下拉功能表中可用。 選擇類別後,為每個新顏色標記輸入每行一個名稱,並在完成後選擇"創建":

  ![VSIX 色彩編輯器的新色彩填滿](../../extensibility/internals/media/vsix-color-editor-new-color-filled.png "VSIX 色彩編輯器的新色彩填滿")

  顏色值以背景/前景對顯示,"無"表示尚未定義顏色。 注意:如果顏色沒有文本顏色/背景顏色對,則只需要定義背景。

  ![VSIX 色彩編輯器色彩值](../../extensibility/internals/media/vsix-color-editor-color-values.png "VSIX 色彩編輯器色彩值")

  要編輯顏色標記,請為該標記的主題(列)選擇顏色條目。 通過鍵入 8 位 ARGB 格式的十六進位顏色值、在單元格中輸入系統顏色名稱或使用下拉選單通過一組顏色滑塊或系統顏色清單選擇所需顏色來添加顏色值。

  ![VSIX 色彩編輯器編輯色彩](../../extensibility/internals/media/vsix-color-editor-edit-color.png "VSIX 色彩編輯器編輯色彩")

  ![VSIX 色彩編輯器的背景](../../extensibility/internals/media/vsix-color-editor-background.png "VSIX 色彩編輯器的背景")

  對於不需要顯示文本的零部件,請只輸入一個顏色值:背景顏色。 否則,輸入背景和文本顏色的值,由正向斜杠分隔。

  輸入"高對比度"值時,請輸入有效的 Windows 系統顏色名稱。 不要輸入硬編碼的 ARGB 值。 您可以通過從顏色值下拉選單中選擇"背景:系統"或"前景:系統"來查看有效系統顏色名稱的清單。 建立具有文字元件的元素時,請使用正確的背景/文本系統顏色對,否則文本可能無法讀懂。

  完成顏色標記的創建、設置和編輯後,將它們保存到所需的 .xml 或 .pkgdef 格式中。 既沒有背景,也沒有前景集的顏色標記將保存為 .xml 格式的空顏色,但以 .pkgdef 格式丟棄。 如果嘗試將空顏色儲存到 .pkgdef 檔案,對話方塊將警告您潛在的顏色損失。

  **步驟 4:使用可視化工作室擴展中的顏色。**

  定義新的顏色標記後,在專案檔中包括 .pkgdef,其中"生成操作"設置為"內容",並且"包括在 VSIX 中"設置為"True"。

  ![VSIX 色彩編輯器 pkgdef](../../extensibility/internals/media/vsix-color-editor-pkgdef.png "VSIX 色彩編輯器 pkgdef")

  在 Visual Studio 擴充色彩編輯器中,選擇「檔案>查看資源代碼以檢視用於存取基於 WPF 的 UI 中的自訂顏色的代碼。

  ![VSIX 色彩編輯器的資源程式碼檢視器](../../extensibility/internals/media/vsix-color-editor-resource-code-viewer.png "VSIX 色彩編輯器的資源程式碼檢視器")

  在專案中的靜態類中包括此代碼。 對**微軟的引用。\<VSVersion>.0.dll**需要添加到專案中才能使用**主題資源密鑰**類型。

```csharp
namespace MyCustomColors
{
    public static class MyCategory
    {
        #region Autogenerated resource keys
        // These resource keys are generated by Visual Studio Extension Color Editor, and should be replaced when new colors are added to this category.
        public static readonly Guid Category = new Guid("faf7f3f9-9fe5-4dd3-9350-59679617dfbe");

        private static ThemeResourceKey _MyColor1ColorKey;
        private static ThemeResourceKey _MyColor1BrushKey;
        private static ThemeResourceKey _MyColor1TextColorKey;
        private static ThemeResourceKey _MyColor1TextBrushKey;
        public static ThemeResourceKey MyColor1ColorKey { get { return _MyColor1ColorKey ?? (_MyColor1ColorKey = new ThemeResourceKey(Category, "MyColor1", ThemeResourceKeyType.BackgroundColor)); } }
        public static ThemeResourceKey MyColor1BrushKey { get { return _MyColor1BrushKey ?? (_MyColor1BrushKey = new ThemeResourceKey(Category, "MyColor1", ThemeResourceKeyType.BackgroundBrush)); } }
        public static ThemeResourceKey MyColor1TextColorKey { get { return _MyColor1TextColorKey ?? (_MyColor1TextColorKey = new ThemeResourceKey(Category, "MyColor1", ThemeResourceKeyType.ForegroundColor)); } }
        public static ThemeResourceKey MyColor1TextBrushKey { get { return _MyColor1TextBrushKey ?? (_MyColor1TextBrushKey = new ThemeResourceKey(Category, "MyColor1", ThemeResourceKeyType.ForegroundBrush)); } }
        #endregion
    }
}
```

 這允許存取 XAML 程式碼中的顏色,並允許 UI 回應主題更改。

```xaml
<UserControl x:Class="NewTestProject.TestPackageControl" Name="MyToolWindow"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:ns="clr-namespace:MyCustomColors">
  <Grid>
    <TextBlock Background="{DynamicResource {x:Static ns:MyCategory.MyColor1BrushKey}}"
               Foreground="{DynamicResource {x:Static ns:MyCategory.MyColor1TextBrushKey}}"
      >Sample Text</TextBlock>

  </Grid>
</UserControl>
```

 **第 5 步:測試可視化工作室中的更改。**

 顏色編輯器可以暫時將顏色標記應用於 Visual Studio 的執行實例,以查看對顏色的即時更改,而無需重新生成擴展包。 為此,請按下每個主題列標題上的「應用此主題以運行 Visual Studio 視窗」 按鈕。 當 VSIX 顏色編輯器關閉時,此臨時主題將消失。

 ![VSIX 色彩編輯器的套用](../../extensibility/internals/media/vsix-color-editor-apply.png "VSIX 色彩編輯器的套用")

 要使更改永久化,請重新生成並重新部署 Visual Studio 副檔名後,將新顏色添加到 .pkgdef 檔案並編寫使用這些顏色的代碼。 重建 Visual Studio 擴展會將新顏色的註冊表值合併到其餘主題中。 然後重新啟動 Visual Studio,查看 UI,並驗證新顏色是否按預期顯示。

## <a name="notes"></a>注意
 此工具用於為預先存在的 Visual Studio 主題創建自訂顏色,或用於編輯自訂視覺工作室主題的顏色。 要建立完整的自訂視覺工作室主題,請從可視化工作室擴展函式庫下載[視覺工作室顏色主題編輯器擴展](https://marketplace.visualstudio.com/items?itemName=VisualStudioProductTeam.VisualStudio2015ColorThemeEditor)。

## <a name="sample-output"></a>範例輸出
 **XML 顏色輸出**

 該工具產生的 .xml 檔會類似於:

```xml
<Themes>
  <Theme Name="Light" GUID="{de3dbbcd-f642-433c-8353-8f1df4370aba}">
    <Category Name="CategoryName" GUID="{eee9d521-dac2-48d9-9a5e-5c625ba2040c}">
      <Color Name="ColorName1">
        <Background Type="CT_RAW" Source="FFFFFFFF" />
      </Color>
      <Color Name="ColorName2">
        <Background Type="CT_RAW" Source="FFFFFFFF" />
        <Foreground Type="CT_RAW" Source="FF000000" />
      </Color>
      <Color Name="ColorName3">
        <Background Type="CT_RAW" Source="FFFF0000" />
      </Color>
      <Color Name="ColorName4">
        <Background Type="CT_RAW" Source="FF000088" />
        <Foreground Type="CT_RAW" Source="FFFFFFFF" />
      </Color>
    </Category>
  </Theme>
  <Theme Name="Dark" GUID="{1ded0138-47ce-435e-84ef-9ec1f439b749}">...</Theme>
  <Theme Name="Blue" GUID="{a4d6a176-b948-4b29-8c66-53c97a1ed7d0}">...</Theme>
  <Theme Name="HighContrast" GUID="{a5c004b4-2d4b-494e-bf01-45fc492522c7}">...</Theme>
</Themes>

```

 **PKGDEF 顏色輸出**

 該工具產生的 .pkgdef 檔案將類似於:

```
[$RootKey$\Themes\{de3dbbcd-f642-433c-8353-8f1df4370aba}\CategoryName]
"Data"=hex:78,00,00,00,0b,00,00,00,01,00,00,00,21,d5,e9,ee,c2,da,d9,48,9a,5e,5c,62,5b,a2,04,0c,04,00,00,00,0a,00,00,00,43,6f,6c,6f,72,4e,61,6d,65,31,01,ff,ff,ff,ff,00,0a,00,00,00,43,6f,6c,6f,72,4e,61,6d,65,32,01,ff,ff,ff,ff,01,00,00,00,ff,0a,00,00,00,43,6f,6c,6f,72,4e,61,6d,65,33,01,ff,00,00,ff,00,0a,00,00,00,43,6f,6c,6f,72,4e,61,6d,65,34,01,00,00,88,ff,01,ff,ff,ff,ff
[$RootKey$\Themes\{1ded0138-47ce-435e-84ef-9ec1f439b749}\CategoryName]
"Data"=hex:...
[$RootKey$\Themes\{a4d6a176-b948-4b29-8c66-53c97a1ed7d0}\CategoryName]
"Data"=hex:...
[$RootKey$\Themes\{a5c004b4-2d4b-494e-bf01-45fc492522c7}\CategoryName]
"Data"=hex:...

```

 **C# 資源鍵包裝器**

 此工具產生的顏色資源鍵將類似於:

```csharp
namespace MyNamespace
{
    public static class MyColors
    {
        #region Autogenerated resource keys
        // These resource keys are generated by Visual Studio Extension Color Editor, and should be replaced when new colors are added to this category.

        public static string ColorName1ColorKey { get { return "ColorName1ColorKey"; } }
        public static string ColorName1BrushKey { get { return "ColorName1BrushKey"; } }

        public static string ColorName2ColorKey { get { return "ColorName2ColorKey"; } }
        public static string ColorName2BrushKey { get { return "ColorName2BrushKey"; } }
        public static string ColorName2TextColorKey { get { return "ColorName2TextColorKey"; } }
        public static string ColorName2TextBrushKey { get { return "ColorName2TextBrushKey"; } }

        public static string ColorName3ColorKey { get { return "ColorName4ColorKey"; } }
        public static string ColorName3BrushKey { get { return "ColorName4BrushKey"; } }
        public static string ColorName3TextColorKey { get { return "ColorName4TextColorKey"; } }
        public static string ColorName3TextBrushKey { get { return "ColorName4TextBrushKey"; } }
        #endregion
    }
}
```

 **WPF 資源字典包裝器**

 該工具產生的顏色**資源詞典**鍵將類似於:

```xaml
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:colors="clr-namespace:MyNamespace">

  <SolidColorBrush x:Key="{x:Static colors:MyColors.ColorName1BrushKey}" Color="#FFFFFFFF" />
  <Color x:Key="{x:Static colors:MyColors.ColorName1ColorKey}" A="255" R="255" G="255" B="255" />

  <SolidColorBrush x:Key="{x:Static colors:MyColors.ColorName2BrushKey}" Color="#FFFFFFFF" />
  <Color x:Key="{x:Static colors:MyColors.ColorName2ColorKey}" A="255" R="255" G="255" B="255" />
  <SolidColorBrush x:Key="{x:Static colors:MyColors.ColorName2TextBrushKey}" Color="#FF000000" />
  <Color x:Key="{x:Static colors:MyColors.ColorName2TextColorKey}" A="255" R="0" G="0" B="0" />

  <SolidColorBrush x:Key="{x:Static colors:MyColors.ColorName3BrushKey}" Color="#FFFF0000" />
  <Color x:Key="{x:Static colors:MyColors.ColorName3ColorKey}" A="255" R="255" G="0" B="0" />

  <SolidColorBrush x:Key="{x:Static colors:MyColors.ColorName4BrushKey}" Color="#FF000088" />
  <Color x:Key="{x:Static colors:MyColors.ColorName4ColorKey}" A="255" R="0" G="0" B="136" />
  <SolidColorBrush x:Key="{x:Static colors:MyColors.ColorName4TextBrushKey}" Color="#FFFFFFFF" />
  <Color x:Key="{x:Static colors:MyColors.ColorName4TextColorKey}" A="255" R="255" G="255" B="255" />
</ResourceDictionary>
```
