---
title: 適用於 Visual Studio 的應用程式模式 |Microsoft Docs
ms.date: 04/26/2017
ms.topic: conceptual
ms.assetid: 8ed68602-4e28-46fe-b39f-f41979b308a2
author: gregvanl
ms.author: gregvanl
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: fe97972d882fa8806de925bac6a072cd2dde4513
ms.sourcegitcommit: 1c8e07b98fc0a44b5ab90bcef77d9fac7b3eb452
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/25/2019
ms.locfileid: "56796877"
---
# <a name="application-patterns-for-visual-studio"></a>適用於 Visual Studio 的應用程式模式
##  <a name="BKMK_WindowInteractions"></a> 視窗的互動

### <a name="overview"></a>總覽
使用 Visual Studio 中的兩個主視窗類型是文件編輯器和工具視窗。 罕見，但可能，是大型的非強制回應對話方塊。 雖然這些都是在介面中所有非強制回應，但其模式是完全不同。 本章節涵蓋文件視窗中，工具視窗和非強制回應對話方塊之間的差異。 強制回應對話方塊模式所述[對話方塊](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_Dialogs)。

### <a name="comparing-window-usage-patterns"></a>比較視窗使用模式
**文件視窗**幾乎都在文件中也顯示。 這可讓文件編輯器"center 階段"來排列周圍的補充工具視窗。

A**工具視窗**通常會顯示為個別、 較小視窗的 IDE 邊緣對摺疊。 這可以是顯示、 隱藏或自動隱藏。 不過，有時候工具視窗會顯示在文件區域，取消核取**停駐視窗/** 視窗上的屬性。 這會導致更多的不動產，但也常見設計決策： 嘗試將整合到 Visual Studio 時，您必須決定您的功能是否應顯示的工具視窗或文件視窗。

**非強制回應對話方塊**會建議您不要使用 Visual Studio 中。 最非強制回應對話方塊，根據定義，浮動工具視窗，並應實作該方法。 非強制回應對話方塊可以在其中的標準工具視窗停駐於殼層的側大小會限制太大的情況下。 在使用者便會將對話方塊移至第二個監視器可能的情況下也允許屬性。

將您所需要的容器類型的相關仔細。 下表中的 UI 設計的常見使用方式模式考量。

||文件視窗|工具視窗|非強制回應對話方塊|
|-|---------------------|-----------------|---------------------|
| **位置** | 務必也位於文件，並不會不停駐在 IDE 邊緣。 它可以是 「 提取 」，因此它會浮動分別從主要殼層。 | 一般 索引標籤停駐在 IDE 中，邊緣，但可以是自訂浮點數、 自動隱藏 （不固定），或也停駐在文件中。|大型浮動視窗分開 IDE。 |
| **認可模型** | *延遲的認可*<br /><br /> 若要將資料儲存在文件中，使用者必須發出**檔案&gt;儲存**，**另存新檔**，或**全部儲存**命令。 文件視窗具有概念它正在 「 變更 」 內的資料然後認可至儲存的其中一個命令。 當關閉文件視窗，所有的內容會儲存至磁碟或遺失。 | *立即認可*<br /><br /> 沒有任何儲存模型。 偵測器工具視窗可協助編輯檔案，檔案必須在使用中編輯器或設計工具中，開啟和編輯器或設計工具擁有儲存。 | *延遲或立即認可*<br /><br /> 大多數情況下，大型的非強制回應對話方塊需要執行的動作，以認可變更，並允許 「 取消 」 作業中，會回復任何對話方塊中的工作階段中所做的變更。  這項會區別從工具視窗的非強制回應對話方塊，工具視窗一律會有立即認可模型。 |
| **可見度** | *開啟/建立 （檔案） 和 關閉*<br /><br /> 開啟文件視窗是透過開啟現有文件，或使用範本建立新的文件。 沒有任何 「 開啟\<特定編輯器 >"命令。 | *隱藏和顯示*<br /><br /> 單一執行個體工具視窗可以隱藏或顯示。 內容和工具視窗內的狀態會保存是否可見或隱藏。 多重執行個體工具視窗可以被關閉，以及隱藏。 當多重執行個體工具視窗已關閉時，則會被捨棄的內容和工具視窗內的狀態。 | *啟動命令*<br /><br /> 從以工作為基礎的命令啟動對話方塊。 |
| **執行個體** | *多重執行個體*<br /><br /> 某些編輯器也允許在多個編輯器中開啟相同的檔案時，數個編輯器可同時開啟相同的時間和編輯不同的檔案 (使用 **視窗&gt;開新視窗** 命令)。<br /><br /> 單一的編輯器可能正在編輯一個或多個檔案在相同的時間 （專案設計工具）。 | *單一-或多重執行個體*<br /><br /> 內容會變更以反映內容 （例如屬性瀏覽器），或將焦點/內容推送至其他視窗 （方案總管 中的 工作清單）。<br /><br /> 單一執行個體和多重執行個體工具視窗應該與作用中的文件視窗相關聯，除非有充分的理由不到。 | *單一執行個體* |
| **範例** | **在文字編輯器**，例如程式碼編輯器<br /><br /> **設計介面**，例如表單設計工具] 或 [模型化介面<br /><br /> **控制版面配置類似於對話方塊**，例如資訊清單設計工具 | **方案總管 中**提供方案，以及包含在方案內的專案<br /><br /> **伺服器總管**提供階層式檢視的使用者選擇要在視窗中開啟的伺服器和資料連線。 開啟物件從資料庫階層，like 查詢時，會開啟的文件視窗，並可讓使用者編輯查詢。<br /><br /> **屬性瀏覽器**會顯示在文件視窗或另一個工具視窗中選取之物件的屬性。 屬性會顯示在階層式方格檢視或複雜的對話方塊類似的控制項，並允許使用者設定這些屬性的值。 | |

##  <a name="BKMK_ToolWindows"></a> 工具視窗

### <a name="overview"></a>總覽
工具視窗支援發生在文件視窗中的使用者的工作。 它們可以用來顯示代表 Visual Studio 提供，且可以操作的基本的根物件的階層。

在考量新的工具視窗在 IDE 中，作者應該：

-   使用適當的工作現有的工具視窗，並建立新的與類似的功能。 如果他們提供明顯不同的 「 工具 」 或類似的視窗中，或藉由將現有的視窗轉換成樞紐中樞無法整合的功能，應該只建立新的工具視窗。

-   如有需要在 [工具] 視窗頂端，請使用標準命令列。

-   是與其他工具視窗中進行控制簡報和鍵盤瀏覽已存在的模式一致。

-   是與其他工具視窗中的控制項呈現一致。

-   顯示特定文件的工具視窗自動-如果可能的話，使其只在啟用的父文件時才會顯示。

-   請確定其視窗內容是可瀏覽透過鍵盤 （支援方向鍵）。

#### <a name="tool-window-states"></a>工具視窗狀態
Visual Studio 工具視窗會有不同的狀態，其中有些是使用者已啟動 （例如 「 自動隱藏 」 功能）。 其他狀態，像是自動顯示，讓工具視窗會出現在正確的內容，並隱藏不需要時。 總共有五個的工具視窗狀態。

-   **停駐/釘選**工具視窗可以附加至任何文件區域四邊。 圖釘圖示會出現在工具視窗標題列。 工具視窗可以停駐水平或垂直邊緣的殼層和其他工具視窗，而且也可以是標籤連結。

-   **自動隱藏**工具視窗會取消釘選。 視窗可以不到，離開 （使用 工具 視窗和它的圖示的名稱） 索引標籤上的文件區域邊緣滑動。 當使用者停留在 [] 索引標籤時，[工具] 視窗會滑出。

-   **自動顯示**工具視窗時自動出現為編輯器，例如 UI 中，另一部分就會啟動，或是取得焦點。

-   **浮動**工具視窗將滑鼠停留在 IDE 外部。 這是適用於多重監視器組態。

-   **索引標籤式文件**工具視窗可以停駐在文件中也。 這是框架的適用於大型的工具視窗，如物件瀏覽器、 需要更多的不動產超過允許邊緣停駐。

![工具在 Visual Studio 中的視窗狀態](../../extensibility/ux-guidelines/media/0702-01_toolwindowstates.png "0702年 01_ToolWindowStates")<br />Visual Studio 中的工具視窗狀態

#### <a name="single-instance-and-multi-instance"></a>單一執行個體和多重執行個體
工具視窗是單一執行個體或多重執行個體。 部分的單一執行個體工具視窗可能主動式文件視窗中，與相關聯，而多個執行個體工具視窗可能不會。 多重執行個體工具視窗回應** 視窗&gt;開新視窗**命令藉由建立視窗的新執行個體。 下圖顯示使用中視窗的執行個體時，啟用新視窗 命令的工具視窗：

![啟用 [開新視窗] 命令視窗執行個體時的工具視窗是作用中](../../extensibility/ux-guidelines/media/0702-02_toolwindowenablingcommand.png "0702年 02_ToolWindowEnablingCommand")<br />啟用 [開新視窗] 命令視窗執行個體時的工具視窗是作用中

單一執行個體工具視窗可以隱藏或顯示，而多個執行個體工具視窗可以被關閉，以及隱藏。 所有工具視窗可以停都駐，標籤連結、 浮動或設為多重文件介面 (MDI) 子視窗 （類似於文件視窗）。 在 [視窗] 功能表中的適當的視窗管理命令應該回應所有工具視窗：

![在 Visual Studio 視窗功能表的視窗管理命令](../../extensibility/ux-guidelines/media/0702-03_windowmanagementcontrols.png "0702年 03_WindowManagementControls")<br />在 Visual Studio 視窗功能表的視窗管理命令

#### <a name="document-specific-tool-windows"></a>文件特定工具視窗
部分工具視窗被設計來根據給定的一種文件變更。 這些視窗會持續更新以反映功能適用於作用中的文件視窗在 IDE 中。

其內容會變更以反映選取的編輯器工具視窗的範例包括 工具箱 和 文件大綱。 當編輯器具有焦點不提供到視窗的內容時，這些視窗會顯示為浮水印。

#### <a name="navigable-list-tool-windows"></a>可巡覽清單工具視窗
部分工具視窗會顯示使用者可以互動的可瀏覽項目清單。 在這種視窗中，應該一律有意見反應，為目前的項目在清單中，即使非使用中視窗。 清單應該會回應**GoToNextLocation**並**GoToPrevLocation**也變更目前選取的項目，在視窗中的命令

可巡覽清單工具視窗的範例包括方案總管 和 尋找結果 視窗。

### <a name="tool-window-types"></a>工具視窗類型

#### <a name="common-tool-windows-and-their-functions"></a>常見的工具視窗和其函式

**階層式的工具視窗**

| 工具視窗 | 功能 |
| --- | --- |
| 底下提供說明，包括方案總管 | 會顯示一份文件的階層式樹狀結構會包含在專案、 其他檔案和方案項目。 顯示專案中的項目是由封裝擁有專案類型 （例如，參考架構、 目錄為基礎，或混合式類型） 定義。 |
| 類別檢視 | 階層式樹狀結構的類別和文件，檔案本身的獨立工作集中的各種項目。 |
| 伺服器總管 | 階層樹狀結構顯示在方案中的所有伺服器和資料連接。 |
| 文件大綱 | 作用中的文件的階層式結構。 |

**方格工具視窗**

| 工具視窗 | 功能 |
| --- | --- |
| 屬性 | 會顯示一份所選的物件，以及編輯這些屬性的值選擇器的屬性方格。 |
| 工作清單 | 可讓使用者建立/編輯/刪除工作和註解方格。 |

**內容的工具視窗**

| 工具視窗 | 功能 |
| --- | --- |
| 說明 | 視窗中，可讓使用者存取各種方法的說明，請從 「 How Do I？" MSDN 論壇的影片。 |
| 動態說明 | 工具視窗會顯示說明主題適用於目前的選取範圍的連結。 |
| 物件瀏覽器 | 兩個資料行框架組的左的窗格中的物件屬性的階層式物件元件和右側的資料行中的方法清單。 |

**對話方塊的工具視窗**

| 工具視窗 | 功能 |
| --- | --- |
| Find | 可讓使用者尋找或找到並在方案內的各種檔案中取代 對話方塊。 |
| 進階的尋找 | 可讓使用者尋找或找到並在方案內的各種檔案中取代 對話方塊。 |

**其他工具視窗**

::: moniker range="vs-2017"

| 工具視窗 | 功能 |
| --- | --- |
| 工具箱 | 工具視窗，用來儲存要卸除到設計介面，提供一致的拖曳來源的所有設計工具上的項目。 |
| 起始頁 | 使用者的入口網站加入 Visual Studio，開發人員相關新聞、 Visual Studio 說明和最近使用的專案摘要的存取。 使用者也可以藉由複製的 StartPage.xaml 檔案建立自訂起始頁 」 Common7\IDE\StartPages\" Visual Studio 程式檔案目錄，以便在 Visual Studio [startpages] 資料夾的文件目錄，然後再編輯 XAML藉由手動或在 Visual Studio 或其他程式碼編輯器中開啟它。 |

::: moniker-end

::: moniker range=">=vs-2019"

| 工具視窗 | 功能 |
| --- | --- |
| 工具箱 | 工具視窗，用來儲存要卸除到設計介面，提供一致的拖曳來源的所有設計工具上的項目。 |

::: moniker-end

**偵錯工具視窗**

| 工具視窗 | 功能 |
| --- | --- |
| 自動 ||
| 即時運算 ||
| 輸出 | 只要有文字的事件或狀態來宣告，可以使用 [輸出] 視窗。 |
| 記憶體 ||
| 中斷點 ||
| 執行中 ||
| 文件 ||
| 呼叫堆疊 ||
| 區域變數 ||
| 監看式 ||
| 反組譯碼 ||
| 暫存器 ||
| 執行緒 ||

##  <a name="BKMK_DocumentEditorConventions"></a> 文件編輯器慣例

### <a name="document-interactions"></a>文件的互動
「 文件格式 」 是在 IDE 中的最大空間，其中使用者通常著重注意若要完成其工作，借助於補充的工具視窗。 文件編輯器代表基礎單位的使用者開啟並儲存在 Visual Studio 中的工作。 它們會保留很強烈的選取項目繫結至 [方案總管] 或其他使用中階層視窗。 使用者應該能夠指向其中一個這些階層視窗和方案、 專案或 Visual Studio 套件所提供的另一個根物件知道其中會包含文件和其關聯性。

文件編輯需要一致的使用者體驗。 若要允許使用者將焦點放在手邊的工作而不是視窗管理和尋找命令上，選取 文件檢視的一項策略最適合編輯該文件類型的使用者工作。

#### <a name="common-interactions-for-the-document-well"></a>常見的互動方式的文件區域

-   維護一致的互動模型的常見**新的檔案**並**開啟檔案**體驗。

-   文件視窗開啟時，請更新相關的視窗和功能表中的相關的功能。

-   功能表命令會適當地整合至像是一般功能表**編輯**，**格式**，並**檢視**功能表。 如果有大量的特製化的命令，則可以建立新的功能表。 只有當文件具有焦點時，應該會顯示這個新的功能表。

-   內嵌的工具列可能會放在編輯器的頂端。 這是有出現在編輯器之外的另一個工具列。

-   永遠維護 [方案總管] 或類似的作用中的選取範圍階層架構視窗。

-   按兩下 [方案總管] 中的文件，則應該執行相同的動作**開啟**。

-   如果多個編輯器可以使用文件類型上，使用者應該能夠覆寫或重設使用指定的文件類型的預設動作**開啟**對話方塊中，將檔案上按一下滑鼠右鍵，然後選取**開啟使用**從捷徑功能表。

-   不會建置文件中的精靈，也所示。

### <a name="user-expectations-for-specific-document-types"></a>使用者期望的特定文件類型
有數個不同的基本類型的文件編輯器，並各有一組一致與相同類型的其他人的互動。

-   **以文字為基礎的編輯器：** 程式碼編輯器、 記錄檔

-   **設計介面：** WPF 表單設計工具中，Windows form

-   **對話方塊樣式編輯器：** 資訊清單設計工具中，專案屬性

-   **模型設計師：** 工作流程設計工具，其中包含 codemap、 架構圖、 進度

另外還有數個也使用文件的非編輯器類型。 他們不會編輯文件本身，而它們需要遵循標準的文件視窗的互動。

-   **報告：** IntelliTrace 報表、 HYPER-V 報表、 分析工具報告

-   **儀表板：** 診斷中樞

#### <a name="text-based-editors"></a>以文字為基礎的編輯器

-   文件參與預覽 索引標籤上模型中，以預覽文件，而不開啟它。

-   附屬工具視窗，例如文件大綱內，就可以表示文件的結構。

-   IntelliSense （適用的話） 會有一致的行為與其他程式碼編輯器。

-   快顯視窗或輔助 UI 遵循類似的樣式和模式現有類似的 UI （例如 CodeLens)。

-   在資訊列控制項頂端的文件中，或在 [狀態] 列中，將會看到有關文件狀態的訊息。

-   使用者必須能夠自訂的字型和色彩使用外觀**工具 > 選項**頁面上，共用的 [字型和色彩] 頁面或一個特定的編輯器。

#### <a name="design-surfaces"></a>設計介面

-   空的設計工具應該指出如何開始在介面上浮水印。

-   檢視切換機制會遵循現有的模式，例如按兩下以開啟程式碼編輯器] 或 [允許具有這兩個窗格的互動性的文件視窗內的索引標籤。

-   將項目加入至設計介面應透過 [工具箱] 中，除非需要非常特定的工具視窗。

-   在介面上的項目會遵循一致的選取項目模型。

-   包含文件特有的命令，不是常見的命令，例如內嵌的工具列**儲存**。

#### <a name="dialog-style-editors"></a>對話方塊樣式編輯器

-   控制項配置都應該遵循一般的對話方塊版面配置慣例。

-   在編輯器中的索引標籤不應符合文件索引標籤的外觀，其應符合兩個允許的內部索引標籤樣式的其中一個。

-   使用者必須能夠使用鍵盤; 控制項互動請藉由啟動編輯器和定位停駐控制項，或使用標準的助憶鍵。

-   設計工具應該使用的常見儲存模型。 沒有整體儲存 或 認可 按鈕應該放在介面中，雖然其他按鈕可能比較適合。

#### <a name="model-designers"></a>模型設計工具

-   空的設計工具應該指出如何開始在介面上浮水印。

-   將項目加入至設計介面應該透過 [工具箱] 中。

-   在介面上的項目會遵循一致的選取項目模型。

-   包含文件特有的命令，不是常見的命令，例如內嵌的工具列**儲存**。

-   圖例，可能會出現在介面中，可能表示或為浮水印。

-   使用者必須能夠自訂字型/色彩使用的外觀**工具 > 選項**頁面上，共用的 [字型和色彩] 頁面或一個特定的編輯器。

#### <a name="reports"></a>報告

-   報表通常資訊僅供和儲存模型中不會參與。 不過，它們可能會包含互動，例如與其他相關資訊或展開和摺疊的章節連結。

-   在介面上的大部分命令應該是超連結，而不是按鈕。

-   版面配置應該包含標頭，並遵循標準的報表版面配置指導方針。

#### <a name="dashboards"></a>儀表板

-   儀表板不需要互動模型本身，但做為提供各種不同其他工具的方法。

-   它們不會參與儲存模型。

-   使用者必須能夠藉由啟動編輯器和 tab 鍵切換控制項或使用標準的助憶鍵使用鍵盤，控制項互動。

##  <a name="BKMK_Dialogs"></a> 對話方塊

### <a name="introduction"></a>簡介
在 Visual Studio 中的對話方塊通常應該支援一個離散使用者的工作單位，然後關閉。

如果您已經決定您需要一個對話方塊，您會有三個選項，喜好設定順序：

1.  將功能整合成一個 Visual Studio 中的 [共用] 對話方塊。

2.  建立您自己的對話方塊使用現有的類似對話方塊中找到的模式。

3.  建立新的對話方塊中，下列互動和版面配置指導方針。

本節說明如何選擇正確的對話方塊模式，在 Visual Studio 工作流程和對話方塊設計的常見慣例。

### <a name="themes"></a>主題
在 Visual Studio 中的對話方塊，請依照下列兩個基本樣式的其中一個：

#### <a name="standard-unthemed"></a>標準 (unthemed)
大部分的對話方塊是標準的公用程式的對話方塊，而且應該 unthemed。 請勿不重新範本通用控制項，或嘗試建立樣式化的 「 現代化 」 按鈕或控制項。 控制項和 chrome 外觀，請遵循[標準 Windows 桌面互動的方針對話方塊](/windows/desktop/uxguide/win-dialog-box)。

#### <a name="themed"></a>佈景主題
特殊 「 簽章 」 對話方塊可能會配置其佈景主題。 佈景主題的對話方塊已有不同的外觀，也有一些與樣式相關聯的特殊的互動模式。 佈景主題您只有在符合這些需求的對話方塊：

-   對話是共通的經驗，都可見，且通常或許多使用者使用 (例如**新的專案**對話方塊。

-   此對話方塊包含重要的產品品牌項目 (例如**帳戶設定**對話方塊)。

-   對話方塊會顯示為較大的流程，包括其他已配置佈景主題的對話方塊中不可或缺的一部分 (例如**加入已連接服務**對話方塊)。

-   對話方塊是經驗的扮演策略性的角色，在升級或區分的產品版本很重要的一部分。

在建立時配置其佈景主題的對話方塊中，使用適當的環境色彩，並遵循正確的版面配置和互動模式。 (請參閱[Layout for Visual Studio](../../extensibility/ux-guidelines/layout-for-visual-studio.md)。)

### <a name="dialog-design"></a>設計對話方塊
設計良好的對話方塊會將下列項目納入考量：

-   支援使用者工作

-   對話方塊文字樣式、 語言和術語

-   控制選擇與 UI 慣例

-   視覺化版面配置規格和控制項的對齊方式

-   存取鍵盤

#### <a name="content-organization"></a>內容的組織
請考慮這種對話方塊的基本類型之間的差異：

-   [簡單的對話方塊](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_SimpleDialogs)呈現單一的強制回應視窗中的控制項。 此份簡報可能包含複雜的控制項模式，包括欄位選擇器或圖示列的變化。

-   [分層對話方塊](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_LayeredDialogs)來充分運用螢幕面積，當單一的 UI 包含多個控制項群組。 對話方塊群組 「 分層 」 透過索引標籤控制項、 瀏覽清單控制項或按鈕，讓使用者可以選擇哪一個群組，以查看在任何給定的時刻。

-   [精靈](../../extensibility/ux-guidelines/application-patterns-for-visual-studio.md#BKMK_Wizards)適合用來引導使用者完成一連串的步驟來完成工作的邏輯。 循序的面板，有時介紹不同的工作流程 （「 分支 」） 相依於先前的面板中所做的選擇中提供一系列的選項。

####  <a name="BKMK_SimpleDialogs"></a> 簡單的對話方塊
簡單的對話方塊是單一的強制回應視窗中控制項的呈現方式。 這份簡報可能包含複雜的控制項模式，例如欄位選擇器的變化。 對於簡單的對話，遵循標準的一般配置，以及所需的複雜控制項群組的任何特定版面配置。

![> 建立強式名稱金鑰是一個簡單的對話方塊，在 Visual Studio 中的範例。](../../extensibility/ux-guidelines/media/0704-01_createstrongnamekey.png "0704年 01_CreateStrongNameKey")<br />建立強式名稱金鑰是一個簡單的對話方塊，在 Visual Studio 中的範例。

####  <a name="BKMK_LayeredDialogs"></a> 多層式的對話方塊
多層式的對話方塊包含索引標籤、 儀表板和內嵌的樹狀結構。 它們用來最大化不動產，當有多個群組的每一個 UI 中提供的控制項。 分層的群組，讓使用者可以選擇哪一個群組，若要查看一次。

在最簡單的案例中，群組之間切換的機制是索引標籤控制項。 沒有可用的多個替代方案。 請參閱 Prioritizing 和分層如何選擇最適當的樣式。

**工具&gt;選項**對話方塊是使用內嵌的樹狀結構的分層對話方塊的範例：

![工具 > 選項是在 Visual Studio 中的分層對話方塊的範例。](../../extensibility/ux-guidelines/media/0704-02_toolsoptions.png "0704年 02_ToolsOptions")<br />工具 > 選項是在 Visual Studio 中的分層對話方塊的範例。

####  <a name="BKMK_Wizards"></a> 精靈
精靈可用於將透過邏輯的一連串步驟的使用者導向中完成工作。 在循序的面板，提供一系列的選項，使用者必須透過每個步驟再繼續進行下一步 繼續。 足夠的預設值可供使用，一旦**完成**按鈕已啟用。

 強制回應的精靈可用於工作的：

-   包含分支，視使用者的選擇而定，提供不同的路徑

-   包含的步驟，後續的步驟取決於上述步驟的使用者輸入的位置之間的相依性

-   夠複雜的 UI 應用於說明提供的選擇，以及可能的結果，在每個步驟

-   為交易式，需要一組認可任何變更之前，將整個完成的步驟

### <a name="common-conventions"></a>常見的慣例
若要達到最佳的設計和功能與您的對話方塊，請遵循對話方塊大小、 位置、 標準、 控制組態和對齊方式、 UI 文字、 標題列、 控制按鈕和存取金鑰的這些慣例。

如需版面配置特有的指導方針，請參閱[Layout for Visual Studio](../../extensibility/ux-guidelines/layout-for-visual-studio.md)。

#### <a name="size"></a>大小
對話方塊應該符合的最小的 1024 x 768 螢幕解析度，以及初始的對話方塊大小不應超過 900 x 700 個像素。 對話方塊可能會調整大小，但並非必要。

有兩個建議，且可調整大小的對話方塊：

1.  最小的大小會定義將會最佳化控制項的對話方塊而不裁剪，設定和調整以符合其合理的當地語系化成長。

2.  使用者調整大小就會保存工作階段。 例如，如果使用者縮放 150%的對話方塊，後續啟動的對話方塊會顯示在 150%。

#### <a name="position"></a>位置
對話方塊必須出現在第一次啟動 IDE 中置中。 不可調整大小的對話方塊的最後一個位置不需要保存，因此它們會出現在後續啟動上置中。

對於可調整大小的對話，大小應保存在後續啟動。 可調整大小強制回應對話方塊，不需要保存的位置。 顯示在 IDE 中置中，可以避免不斷變更使用者的顯示設定時，無法預期或無法使用的位置中出現的對話方塊。

可以重新調整位置的非強制回應對話方塊，使用者的位置應該維護上後續啟動，因為可能會經常使用的對話方塊，為較大的工作流程中不可或缺的一部分。

當對話方塊必須繁衍其他對話方塊時，最上層的對話方塊應該重疊顯示，向右和向下，從父代，讓它的清楚的使用者，他們已巡覽至新位置。

#### <a name="modality"></a>強制回應性
正在強制回應表示使用者就必須完成或取消對話方塊，然後再繼續。 由於強制回應對話方塊會禁止使用者與環境的其他部分互動，您的功能工作流程應該盡可能謹慎使用。 當強制回應的作業需要時，Visual Studio 就會有共用的對話方塊，您可以整合到您的功能數目。 如果您必須建立一個新的對話方塊，請遵循現有的對話的互動模式，具有類似功能。

當使用者需要同時執行兩個活動時，像是**尋找**並**取代**時撰寫新程式碼，對話方塊應該是強制回應，讓使用者可以輕鬆地切換它們。 Visual Studio 通常會使用針對這類型的編輯器支援已連結的工作的工具視窗。

#### <a name="control-configuration"></a>控制組態
是與完成同樣的工作，在 Visual Studio 中的現有控制項組態一致。

#### <a name="title-bars"></a>標題列

- 標題列中的文字必須反映命令啟動它的名稱。

- 無圖示應該用於對話方塊標題列。 在其中系統會要求一個情況下，使用 Visual Studio 標誌。

- 對話方塊不應該有最小化或最大化按鈕。

- 標題列中的 [說明] 按鈕已被取代。 請勿將它們加入新的對話方塊。 當它們存在的話時，它們應該啟動的工作在概念上相關 [說明] 主題。

  ![在 Visual Studio 對話方塊中的標題列的指導方針規格](../../extensibility/ux-guidelines/media/0704-03_titlebarspecs.png "0704年 03_TitleBarSpecs")<br />在 Visual Studio 對話方塊中的標題列的指導方針規格

#### <a name="control-buttons"></a>控制按鈕
一般情況下， **[確定]**，**取消**，並**協助**應該水平排列按鈕，在對話方塊右下角。 如果對話方塊底部會造成與控制按鈕的視覺化混淆的對話方塊中的數個其他按鈕，允許替代的垂直堆疊。

![Visual Studio 對話方塊中的控制項按鈕的可接受組態](../../extensibility/ux-guidelines/media/0704-04_controlbuttonconfig.png "0704年 04_ControlButtonConfig")<br />可接受 Visual Studio 對話方塊中的控制項按鈕組態

對話方塊中，必須加入預設的控制項按鈕。 若要判斷最佳的命令，以做為預設值，選擇下列選項 （依優先順序列出）：

-   選擇最安全且最安全的命令為預設值。 這表示選擇最有可能避免資料遺失，並避免非預期的系統存取的命令。

-   如果資料遺失 」 和 「 安全性不因素，然後選擇以便利的預設命令。 當對話方塊支援經常或重複的工作，包括最可能的命令為預設值會改善使用者的工作流程。

請避免選擇預設命令的永久破壞性動作。 如果存在這類命令，請改為預設值選擇更安全的命令。

#### <a name="access-keys"></a>存取金鑰
請勿使用存取金鑰 **[確定]**，**取消**，或**協助**按鈕。 根據預設，這些按鈕會對應至快速鍵：

| 按鈕名稱 | 鍵盤快速鍵 |
| --- | --- |
| 確定 | Enter |
| 取消 | Esc |
| 說明 | F1 |

#### <a name="imagery"></a>圖像
在對話方塊中，謹慎使用映像。 請勿使用大圖示在對話方塊中只會用盡空間。 使用映像，才會傳達給使用者，例如警告圖示或狀態動畫訊息很重要的一部分。

###  <a name="BKMK_PrioritizingAndLayering"></a> 排列優先順序，並且分層

#### <a name="prioritizing-your-ui"></a>設定您的 UI 的優先順序
它可能需要特定 UI 項目帶入 forefront，並將更多進階的行為和對話方塊選項 （包括難以理解的命令）。 留出空間，以及讓它顯示在 UI 中的文字標籤預設會顯示對話方塊時，則您可以帶入 forefront 常用的功能。

#### <a name="layering-your-ui"></a>分層 UI
如果您已經決定對話是必要的但您想要呈現給使用者的相關的功能超越什麼可以顯示一個簡單的對話方塊中，您需要將層級的 UI。 Visual Studio 會使用最常見的分層方法是索引標籤和走廊或儀表板。 在某些情況下，可以展開和摺疊的區域可能適合。 彈性的 UI 通常不建議在 Visual Studio 中。

有其優點和缺點的分層 UI，透過類似索引標籤控制項的不同方法。 請檢閱下列清單以確定您選擇適合您情況的分層技術。

##### <a name="tabbing"></a>定位處理

| 切換機制 | 優點和適當的使用 | 缺點和不當使用 |
| --- | --- | --- |
| 索引標籤控制項 | 以邏輯方式分組相關的設定中的對話方塊頁面<br /><br />適用於少於五個 （或納入一個資料列，在對話方塊的索引標籤的數目） 相關的控制項在對話方塊的頁面<br /><br />索引標籤必須簡短： 可以輕鬆地識別內容的一個或兩個字<br /><br />常見的系統對話方塊樣式<br /><br />範例：**檔案總管&gt;項目屬性** | 很難進行簡短的描述性標籤<br /><br />通常無法擴充超過一個對話方塊中的五個索引標籤<br /><br />如果您有一個資料列 （使用替代的分層技術） 的太多索引標籤不適當<br /><br />不是可延伸 |
| 提要欄位巡覽 | 簡單的切換裝置可容納更多的類別，比索引標籤<br /><br />類別目錄 （沒有階層） 的一般清單<br /><br />可延伸<br /><br />範例：**自訂...&gt; 新增命令** | 不適合用於水平間距，如果有少於三個群組<br /><br />工作可能是更適合下拉式清單 |
| 樹狀控制項 | 允許無限制的類別<br /><br />允許群組和/或階層架構的分類<br /><br />可延伸<br /><br />範例：**工具&gt;選項** | 大量的巢狀階層可能會導致過多的水平捲軸<br /><br />Visual Studio 有農民的樹狀檢視 |
| 精靈 | 透過引導使用者完成以工作為基礎的循序步驟可協助進行工作完成： 精靈表示高階工作和個別面板代表完成整體工作所需的子工作<br /><br />當工作跨越 Ui 界限，做為當使用者會需要使用多個編輯器和工具視窗來完成工作時很有用<br /><br />當工作需要分支時很有用<br /><br />當工作包含兩個步驟的相依性時很有用<br /><br />當您幾個類似的工作，使用其中一個決定分支可以看到一個對話方塊，以減少不同類似的對話方塊數目很有用 | 不適用於任何不需要的循序工作流程的工作<br /><br />使用者可能會淹沒和混淆太多步驟的精靈<br /><br />精靈本質上具有有限的螢幕畫面 |

##### <a name="hallways-or-dashboards"></a>走廊或儀表板
走廊上和儀表板是對話方塊或做為啟動指向其他對話方塊和視窗的面板。 只有最常見的選項、 命令和設定，讓使用者能夠輕易地完成一般工作，立即呈現，設計良好的 「 我們 」。 真實世界的走廊提供通往存取其背後聊天室，如以下較不常見 UI 會收集到個別 「 室 」 （通常是其他對話方塊） 可從主要的走廊的相關功能。

或者，UI，可提供單一集合中所有可用的功能，而非重整將較不常見功能重構成不同的位置是直接在儀表板。

![公開額外的 UI，在 Outlook 中的 hallway 概念](../../extensibility/ux-guidelines/media/0704-08_hallway.png "0704年 08_Hallway")<br />公開額外的 UI，在 Outlook 中的 hallway 概念

##### <a name="adaptive-ui"></a>彈性的 UI
根據使用方式顯示或隱藏 UI，或使用者的報告的體驗是另一種呈現時隱藏其他部分的必要的 UI。 建議您不要在 Visual Studio 中的演算法來決定何時要顯示或隱藏 UI 可能需要一些技巧，以及規則一律會錯誤案例的一些集合。

##  <a name="BKMK_Projects"></a> 專案

### <a name="projects-in-the-solution-explorer"></a>在 [方案總管] 中的專案
大部分的專案會分類為參考架構、 目錄為基礎，或混合。 在 [方案總管] 中同時支援這三種專案類型。 使用專案中的使用者經驗的根目錄進行此視窗內。 雖然不同的專案節點的參考、 目錄或混合模式類型的專案，但沒有常見的互動模式應套用做為起點之前為分散到專案特定的使用者模式。

專案應該永遠：

-   支援加入專案資料夾來組織專案內容的能力

-   維護一致的模型專案持續性

專案也應維護一致的互動模型：

-   移除專案項目

-   儲存文件

-   專案屬性編輯

-   編輯替代的檢視中的專案

-   拖放作業

### <a name="drag-and-drop-interaction-model"></a>拖放互動模型
專案通常分類本身為參考型 （能夠保存在儲存體中的專案項目的唯一參考），目錄為基礎 （能夠保存唯一的專案項目實際儲存的專案階層內），或混合的 （無法保存參考或實體的項目）。 IDE 內同時適用於所有三種專案類型**方案總管 中**。

拖放的觀點而言，下列特性應套用至專案中的每一種**方案總管 中**:

-   **參考為基礎的專案：** 重點是專案會參考儲存體中的項目周圍拖曳。 當參考為基礎的專案做為來源，以進行移動作業時，它應該只移除專案中的項目的參考。 項目不應實際刪除從硬碟機。 當參考為基礎的專案做為移動 （或複製） 作業的目標時，它應該新增原始來源項目的參考，而不需進行的私人複本的項目。

-   **目錄型專案：** 拖放的觀點而言，從專案拖曳周圍的實體的項目，而不是參考。 當目錄為基礎的專案做為來源，以進行移動作業時，它應該最後會從硬碟中刪除實體的項目，以及從專案中移除。 當目錄為基礎的專案做為移動 （或複製） 作業的目標時，它應該建立一份來源項目，其目標位置中。

-   **混合目標專案：** 從拖放的觀點而言，這種專案的行為為基礎的本質 （儲存體中的項目參考），或是在項目本身正在拖曳的項目。 上述參考和實體的項目正確的行為。

只有一種專案類型一樣**方案總管 中**，然後拖放作業會直接了當。 因為每個專案系統有定義它自己的拖放行為的能力，以確保可預測的使用者體驗，應遵循特定的指導方針 （根據 Windows 檔案總管拖放行為）：

-   未修改拖曳作業**方案總管 中**（當 Ctrl 或 Shift 鍵都不按住） 應該會導致移動作業。

-   Shift 拖曳作業應該也會導致移動作業的影響。

-   Ctrl 拖曳作業應該會導致複製作業。

-   參考架構和混合的專案系統支援的來源項目新增連結 （或參考） 的概念。 這些專案與拖放作業的目標時 (當**Ctrl + Shift**按住)，它應該會導致項目加入專案的參考

並非所有的拖放作業的參考架構、 目錄為基礎，與混合的專案組合都合理的做法。 特別是，會有困難偽裝成允許目錄為基礎的原始碼專案和參考為基礎的目標專案之間移動作業，因為來源目錄型專案就必須刪除完成的移動時的來源項目。 與目標參考架構的專案然後早已刪除的項目參考。

此外，也可能造成誤導假裝為允許這些類型的專案之間複製作業，因為目標參考型專案不應建立的獨立複本之來源項目的。 同樣地，Ctrl + Shift 拖曳至目錄為基礎的目標專案應該不允許因為目錄為基礎的專案無法保存參考。 在其中拖放作業不支援的情況下，應該不允許卸除 IDE，並將其向使用者顯示不置放游標 （指標在下表中顯示） 中。

若要正確實作拖放行為，在拖曳來源專案需要通訊本質上的對目標專案。 （比方說，是它的參考或目錄型？）這項資訊會以來源所提供的剪貼簿格式。 專案應該做為來源的拖曳 （或剪貼簿複製作業） 提供其中一個`CF_VSREFPROJECTITEMS`或`CF_VSSTGPROJECTITEMS`分別根據專案是參考或目錄為基礎。 這種格式都有相同的資料內容，類似於 Windows`CF_HDROP`格式化但不包含清單的字串，而不是檔名，雙精度浮點數-`NULL`終止份`Projref`字串 (傳回從`IVsSolution::GetProjrefOfItem`或`::GetProjrefOfProject`視需要)。

為目標的卸除 （或剪貼簿貼上作業），專案應該接受兩者`CF_VSREFPROJECTITEMS`和`CF_VSSTGPROJECTITEMS`，不過確切處理拖放作業會根據目標專案和原始碼專案的本質而有所不同。 原始碼專案所提供的是否宣告其本質`CF_VSREFPROJECTITEMS`或`CF_VSSTGPROJECTITEMS`。 卸除的目標了解自己的本質，因此能夠足夠資訊來做出決策，以做為是否移動、 複製或連結應該執行。 使用者也會修改應該執行哪一個拖放作業，藉由按下 Ctrl、 shift 鍵，或同時 Ctrl 和 Shift 鍵。 務必讓置放標的正確指出事先在會執行哪些作業，其`DragEnter`和`DragOver`方法。 **方案總管 中**原始碼專案和目標專案是否相同的專案就會自動得知。

不支援專案項目拖曳 （比方說，從 devenv.exe 到另一個執行個體） 的 Visual Studio 執行個體。 **方案總管 中**這也可以直接停用。

使用者應該總是能夠判斷所選取項目、 將它拖曳到目標位置，並觀察其下的滑鼠指標會出現在卸除項目之前的拖放作業的效果：

| 滑鼠指標 | 命令 | 描述 |
| :---: | --- | --- |
| ![滑鼠 「 不置放 」 圖示](../../extensibility/ux-guidelines/media/0706-01_mousenodrop.png "0706年 01_MouseNoDrop") | 不卸除 | 無法卸除項目至指定的位置。 |
| ![滑鼠 「 複製 」 圖示](../../extensibility/ux-guidelines/media/0706-02_mousecopy.png "0706年 02_MouseCopy") | 複製 | 項目會複製到目標位置。 |
| ![滑鼠 「 移動 」 圖示](../../extensibility/ux-guidelines/media/0706-03_mousemove.png "0706年 03_MouseMove") | Move | 項目將會移至 目標位置。 |
| ![滑鼠 「 加入參考 」 圖示](../../extensibility/ux-guidelines/media/0706-04_mouseaddref.png "0706年 04_MouseAddRef") | 加入參考 | 選取項目的參考會加入到目標位置。 |

#### <a name="reference-based-projects"></a>參考為基礎的專案
 下表摘要說明拖曳和置放 （以及剪下/複製/貼上） 執行的作業應該根據按下參考為基礎的目標專案的來源項目和修飾詞索引鍵的本質：

| 修飾詞 | 分類 | 來源項目：參考/連結 | 來源項目：實體的項目或檔案系統 (`CF_HDROP`) |
| --- | --- | --- | --- |
| 任何修飾詞 | 動作 | Move | 連結 |
| 任何修飾詞 | 目標 | 將參考加入至原始項目 | 將參考加入至原始項目 |
| 任何修飾詞 | 原始程式檔 | 刪除原始項目的參考 | 會保留原始的項目 |
| 任何修飾詞 | 結果 | `DROPEFFECT_MOVE` 從動作傳回`::Drop`和項目會保留在儲存體中的原始位置 | `DROPEFFECT_LINK` 從動作傳回`::Drop`和項目會保留在儲存體中的原始位置 |
| Shift+Drag | 動作 | Move | 不卸除 |
| Shift+Drag | 目標 | 將參考加入至原始項目 | 不卸除 |
| Shift+Drag | 原始程式檔 | 刪除原始項目的參考 | 不卸除 |
| Shift+Drag | 結果 | `DROPEFFECT_MOVE` 從動作傳回`::Drop`和項目會保留在儲存體中的原始位置 | 不卸除 |
| Ctrl+Drag | 動作 | 複製 | 不卸除 |
| Ctrl+Drag | 目標 | 將參考加入至原始項目 | 不卸除 |
| Ctrl+Drag | 原始程式檔 | 會保留原始項目的參考 | 不卸除 |
| Ctrl+Drag | 結果 | `DROPEFFECT_COPY` 從動作傳回`::Drop`和項目會保留在儲存體中的原始位置 | 不卸除 |
| Ctrl+Shift+Drag | 動作 | 連結 | 連結 |
| Ctrl+Shift+Drag | 目標 | 將參考加入至原始項目 | 將參考加入至原始項目 |
| Ctrl+Shift+Drag | 原始程式檔 | 會保留原始項目的參考 | 會保留原始的項目 |
| Ctrl+Shift+Drag | 結果 | `DROPEFFECT_LINK` 從動作傳回`::Drop`和項目會保留在儲存體中的原始位置 | `DROPEFFECT_LINK` 從動作傳回`::Drop`和項目會保留在儲存體中的原始位置 |
| Ctrl+Shift+Drag | 注意事項 | 在 Windows 檔案總管中捷徑的拖放行為相同。 ||
| 剪下/貼上 | 動作 | Move | 連結 |
| 剪下/貼上 | 目標 | 將參考加入至原始項目 | 將參考加入至原始項目 |
| 剪下/貼上 | 原始程式檔 | 會保留原始項目的參考|會保留原始的項目 |
| 剪下/貼上 | 結果 | 項目會保留在儲存體中的原始位置 | 項目會保留在儲存體中的原始位置 |
| 複製/貼上 | 動作 | 複製 | 連結 |
| 複製/貼上 | 原始程式檔 | 將參考加入至原始項目 | 將參考加入至原始項目 |
| 複製/貼上 | 結果 | 會保留原始項目的參考 | 會保留原始的項目 |
| 複製/貼上 | 動作 | 項目會保留在儲存體中的原始位置 | 項目會保留在儲存體中的原始位置 |

#### <a name="directory-based-projects"></a>目錄型專案
下表摘要說明拖曳和置放 （以及剪下/複製/貼上） 執行的作業應該根據目錄為基礎的目標專案的已按下的來源項目和修飾詞索引鍵的本質：


| 修飾詞 | 分類 | 來源項目：參考/連結 | 來源項目：實體的項目或檔案系統 (`CF_HDROP`) |
|-----------------|----------| - | - |
| 任何修飾詞 | 動作 | Move | Move |
| 任何修飾詞 | 目標 | 複製到目標位置的項目 | 複製到目標位置的項目 |
| 任何修飾詞 | 原始程式檔 | 刪除原始項目的參考 | 刪除原始項目的參考 |
| Shift+Drag | 動作 | Move | Move |
| Shift+Drag | 目標 | 複製到目標位置的項目 | 複製到目標位置的項目 |
| Shift+Drag | 原始程式檔 | 刪除原始項目的參考 | 從原始位置刪除項目 |
| Shift+Drag | 結果 | `DROPEFFECT_MOVE` 從動作傳回`::Drop`和項目會保留在儲存體中的原始位置 | `DROPEFFECT_MOVE` 從動作傳回`::Drop`和項目會保留在儲存體中的原始位置 |
| Ctrl+Drag | 動作 | 複製 | 複製 |
| Ctrl+Drag | 目標 | 複製到目標位置的項目 | 複製到目標位置的項目 |
| Ctrl+Drag | 原始程式檔 | 會保留原始項目的參考 | 會保留原始項目的參考 |
| Ctrl+Drag | 結果 | `DROPEFFECT_COPY` 從動作傳回`::Drop`和項目會保留在儲存體中的原始位置 | `DROPEFFECT_COPY` 從動作傳回`::Drop`和項目會保留在儲存體中的原始位置 |
| Ctrl+Shift+Drag | | 不卸除 | 不卸除 |
| 剪下/貼上 | 動作 | Move | Move |
| 剪下/貼上 | 目標 | 複製到目標位置的項目 | 複製到目標位置的項目 |
| 剪下/貼上 | 原始程式檔 | 刪除原始項目的參考 | 從原始位置刪除項目 |
| 剪下/貼上 | 結果 | 項目會保留在儲存體中的原始位置 | 從儲存體中的原始位置刪除項目 |
| 複製/貼上 | 動作 | 複製 | 複製 |
| 複製/貼上 | 目標 | 將參考加入至原始項目 | 複製到目標位置的項目 |
| 複製/貼上 | 原始程式檔 | 會保留原始的項目 | 會保留原始的項目 |
| 複製/貼上 | 結果 | 項目會保留在儲存體中的原始位置 | 項目會保留在原始位置集儲存體 |

#### <a name="mixed-target-projects"></a>混合目標專案
下表摘要說明拖曳和置放 （以及剪下/複製/貼上） 執行的作業應該根據按下混合目標專案的來源項目和修飾詞索引鍵的本質：

| 修飾詞 | 分類 | 來源項目：參考/連結 | 來源項目：實體的項目或檔案系統 (`CF_HDROP`) |
| --- | --- | --- | --- |
| 任何修飾詞 | 動作 | Move | Move |
| 任何修飾詞 | 目標 | 將參考加入至原始項目 | 複製到目標位置的項目 |
| 任何修飾詞 | 原始程式檔 | 刪除原始項目的參考 | 刪除原始項目的參考 |
| 任何修飾詞 | 結果 | `DROPEFFECT_ MOVE` 從動作傳回`::Drop`和項目會保留在儲存體中的原始位置 | `DROPEFFECT_ MOVE` 從動作傳回`::Drop`項目會從儲存體中的原始位置刪除 |
| Shift+Drag | 動作 | Move | Move |
| Shift+Drag | 目標 | 將參考加入至原始項目 | 複製到目標位置的項目 |
| Shift+Drag | 原始程式檔 | 刪除原始項目的參考 | 從原始位置刪除項目 |
| Shift+Drag | 結果 | `DROPEFFECT_ MOVE` 從動作傳回`::Drop`和項目會保留在儲存體中的原始位置 | `DROPEFFECT_ MOVE` 從動作傳回`::Drop`項目會從儲存體中的原始位置刪除 |
| Ctrl+Drag | 動作 | 複製 | 複製 |
| Ctrl+Drag | 目標 | 將參考加入至原始項目 | 複製到目標位置的項目 |
| Ctrl+Drag | 原始程式檔 | 會保留原始項目的參考 | 會保留原始的項目 |
| Ctrl+Drag | 結果 | `DROPEFFECT_ COPY` 從動作傳回`::Drop`和項目會保留在儲存體中的原始位置 | `DROPEFFECT_ COPY` 從動作傳回`::Drop`和項目會保留在儲存體中的原始位置 |
| Ctrl+Shift+Drag | 動作 | 連結 | 連結 |
| Ctrl+Shift+Drag | 目標 | 將參考加入至原始項目 | 將參考加入至原始來源項目 |
| Ctrl+Shift+Drag | 原始程式檔 | 會保留原始項目的參考 | 會保留原始的項目 |
| Ctrl+Shift+Drag | 結果 | `DROPEFFECT_ LINK` 從動作傳回`::Drop`和項目會保留在儲存體中的原始位置 | `DROPEFFECT_ LINK` 從動作傳回`::Drop`和項目會保留在儲存體中的原始位置 |
| 剪下/貼上 | 動作 | Move | Move |
| 剪下/貼上 | 目標 | 複製到目標位置的項目 | 複製到目標位置的項目 |
| 剪下/貼上 | 原始程式檔 | 刪除原始項目的參考 | 從原始位置刪除項目 |
| 剪下/貼上 | 結果 | 項目會保留在儲存體中的原始位置 | 從儲存體中的原始位置刪除項目 |
| 複製/貼上 | 動作 | 複製 | 複製 |
| 複製/貼上 | 目標 | 將參考加入至原始項目 | 複製到目標位置的項目 |
| 複製/貼上 | 原始程式檔 | 會保留原始的項目 | 會保留原始的項目 |
| 複製/貼上 | 結果 | 項目會保留在儲存體中的原始位置 | 項目會保留在儲存體中的原始位置 |

這些詳細資料應該列入考量時實作中拖曳**方案總管 中**:

-   多個選取項目案例的設計。

-   檔案名稱 （完整路徑） 必須是唯一的目標專案，或卸除不被允許。

-   資料夾名稱必須是唯一 （不區分大小寫） 則要卸除這些層級。

-   有拖放 （不是在上述案例中提及） 的時候，就會開啟或關閉的檔案之間的行為差異。

-   最上層的檔案的行為稍有不同資料夾中的檔案。

要注意的另一個問題是如何處理已開啟的設計工具或編輯器的項目上的移動作業。 預期的行為是，如下所示 （適用於所有專案類型）：

1.  如果開啟的編輯器/設計工具並沒有任何未儲存的變更，然後編輯器/設計工具視窗應該會以無訊息模式關閉。

2.  如果開啟的編輯器/設計工具具有未儲存的變更，然後拖曳的來源應該等候發生，並接著會要求使用者開啟的文件儲存未經認可的變更，關閉視窗，如下所示的提示之前卸除:

    ```
    ==========================================================
         One or more open documents have unsaved changes.
    Do you want to save uncommitted changes before proceeding?
                      [Yes]  [No]  [Cancel]
    ==========================================================
    ```

這會讓使用者得以目標進行其複本之前，先儲存進行中的工作。 新方法`IVsHierarchyDropDataSource2::OnBeforeDropNotify`已啟用這項處理。

目標會再複製項目的狀態，因為它是在儲存體 (不包括在編輯器中未儲存的變更，如果使用者選擇**No**)。 目標已完成其複製之後 (在`IVsHierarchyDropDataSource::Drop`)，來源就有機會完成移動作業的刪除部分 (在`IVsHierarchyDropDataSource::OnDropNotify`)。

未儲存變更的任何編輯器應該保持開啟。 如有變更尚未儲存這些文件，這表示將會執行移動作業中複製的一部分，但將會中止刪除部分。 在多個選取項目案例當使用者選擇**No**，有變更尚未儲存這些文件不應該關閉或移除，但沒有未儲存的變更應該關閉並移除。