---
title: 視覺工作室的複合模式 |微軟文件
ms.date: 11/04/2016
ms.topic: conceptual
ms.assetid: e48ecfb2-f4b5-4d3a-b4a2-7a4d62fa4ec0
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: 500ea8ffe7c33c1d747590ea074bff43fa1a3ab3
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/06/2020
ms.locfileid: "80698622"
---
# <a name="composite-patterns-for-visual-studio"></a>適用於 Visual Studio 的複合模式
複合模式將交互和設計元素合併到不同的配置中。 在視覺工作室中,在一致性方面,一些最重要的複合模式包括:

- [資料視覺效果](../../extensibility/ux-guidelines/composite-patterns-for-visual-studio.md#BKMK_DataVisualization)

- [物件 UI 和窺視](../../extensibility/ux-guidelines/composite-patterns-for-visual-studio.md#BKMK_OnObjectUI)

- [選擇模型](../../extensibility/ux-guidelines/composite-patterns-for-visual-studio.md#BKMK_SelectionModels)

- [持久性和儲存設定](../../extensibility/ux-guidelines/composite-patterns-for-visual-studio.md#BKMK_PersistenceAndSavingSettings)

- [觸控輸入](../../extensibility/ux-guidelines/composite-patterns-for-visual-studio.md#BKMK_TouchInput)

## <a name="data-visualization"></a><a name="BKMK_DataVisualization"></a>資料視覺化

### <a name="overview"></a>概觀
 圖表是一種可視化的數據聚合和可視化方式,以增強決策能力。 它們可以幫助使用者面對大量數據,但沒有什麼意義,看看什麼值得注意,什麼可能需要採取行動。

 如果以下任一條件為 true,使用者將受益於圖表:

- 該圖表能否幫助用戶確定可以執行的任務?

- 該圖表是否會使用戶能夠預測潛在變化的後果?

- 該圖表是否有助於用戶發現趨勢並識別模式?

- 該圖表是否允許使用者做出更好的決策?

- 圖表有助於回答使用者在給定上下文中可能擁有的特定問題嗎?

#### <a name="general-rules-for-charts"></a>圖表的一般規則

- 清楚地標記數據。 沒有解釋的插圖只是漂亮的圖片。

- 從零開始軸以避免傾斜比例。 線長和條形大小是了解數據點之間關係的重要視覺提示。

- 創建圖表,而不是資訊圖表。 資訊圖是數據的藝術表現,其主要目標是視覺故事。 圖表可以(而且應該)在視覺上具有吸引力,但讓數據為自己說話。

- 避免刻紋、圖形條形圖、對比哈希標記和其他資訊圖觸摸。

- 請勿將 3D 效果用作裝飾元素。 僅當它們真正成為使用者理解資訊的能力的組成部分時,才使用它們。

- 避免使用多行和填充,因為兩種以上顏色會使這種類型的圖表難以正確閱讀和解釋。

- 請勿使用圖表(或任何插圖)作為理解概念或與數據交互的唯一方法。 這給有視覺障礙的用戶帶來了困難。

- 請勿將圖表用作頁面上的無端或裝飾元素。 換句話說,如果圖表不添加任何值或幫助使用者解決問題,請不要使用它。

### <a name="chart-types"></a>圖表類型
 Visual Studio 中使用的圖表類型包括條形圖、折線圖、稱為環圖或「圓環圖」的修正餅圖、時間線、散點圖(也稱為"聚類圖表")和甘特圖表。 每種類型的圖表都可用於傳達不同類型的資訊。

### <a name="other-charting-considerations"></a>其他圖表注意事項

#### <a name="color"></a>Color
 有一個特定的圖表顏色調色板定義在視覺工作室中使用。 調色板適用於主要類型的色盲,即使用作非常窄的色片,顏色也可以區分。 您可以在 UI 中的任何類型的圖表或圖形中將這些顏色以任意組合使用。 如果您不需要那麼多不同的顏色,則不需要使用所有七種顏色。 這些顏色的設計不與任何前景元素一起使用,因此不要在這些顏色之上放置文本或字形。 這些色調應硬編碼,並在 **「工具>選項**」下公開給使用者自定義(請參閱[為最終使用者公開顏色](../../extensibility/ux-guidelines/colors-and-styling-for-visual-studio.md#BKMK_ExposingColorsForEndUsers))。

|樣本|Hex|RGB|
|------------|---------|---------|
|![樣本 71B252](../../extensibility/ux-guidelines/media/0711_71b252.png "0711_71B252")|#71B252|113,178,82|
|![樣本 BF3F00](../../extensibility/ux-guidelines/media/0711_bf3f00.png "0711_BF3F00")|#BF3F00|191,63,0|
|![樣本 FCB714](../../extensibility/ux-guidelines/media/0711_fcb714.png "0711_FCB714")|#FCB714|252,183,20|
|![樣本 903F8B](../../extensibility/ux-guidelines/media/0711_903f8b.png "0711_903F8B")|#903F8B|144,63,139|
|![樣本 117AD1](../../extensibility/ux-guidelines/media/0711_117ad1.png "0711_117AD1")|#117AD1|17,122,209|
|![樣本 79D7F2](../../extensibility/ux-guidelines/media/0711_79d7f2.png "0711_79D7F2")|#79D7F2|121,215,242|
|![樣本 B5B5B5](../../extensibility/ux-guidelines/media/0711_b5b5b5.png "0711_B5B5B5")|#B5B5B5|181,181,181|

## <a name="on-object-ui-and-peeking"></a><a name="BKMK_OnObjectUI"></a>物件 UI 和窺視
 本節提供用於查看的上下文(也稱為代碼透視視圖)是 Visual Studio 獨有的一種物件上 UI 類型。

### <a name="overview"></a>概觀

- 物件 UI 應為使用者提供更多資訊或互動性,而不會減損其主要任務。

- Visual Studio 中物件 UI 的主要模式稱為「注意點的資訊」。

- Visual Studio 中的物件 UI 是內聯的或浮動的,持久或瞬態。

  - 代碼透視檢視是 Visual Studio 中一種物件上的 UI 類型,是內聯和持久的。

  - CodeLens 是可視化工作室中的一種物件上 UI 類型,是浮動和瞬態的

  瞭解一段代碼的工作原理或查找有關該代碼的詳細資訊通常需要開發人員切換上下文並轉到其他內容或其他視窗。 這些上下文轉換可能具有破壞性,因為如果用戶離開主視窗,可能會失去對原始任務的關注。 此外,恢復原始上下文可能很困難,特別是如果切換視窗導致其原始代碼被其他 UI 遮蓋。

  物件 UI 遵循一種稱為「注意點的資訊」的模式。 這些消息、彈出視窗和對話框為使用者提供了額外的相關信息,這些資訊可添加澄清或交互性,而不會失去對主要任務的關注。 物件 UI 的範例包括當使用者將指標懸停在通知區域中的圖示上時出現的彈出視窗、拼寫錯誤的單詞下的紅色波浪以及 Visual Studio 2013 中引入的透視視圖。

### <a name="decision-points"></a>決策點
 在 Visual Studio 中,有幾種方法可以在關注點使用此資訊模式。 選擇正確的機制,以一致、可預測的方式實施它,對於總體體驗至關重要。 否則,使用者可能會收到令人困惑或不一致的體驗,這會分散內容本身的焦點。

#### <a name="relationships-between-master-and-detail-content"></a>主要內容與詳細資訊內容之間的關係
 關注點的信息用於顯示使用者關注的內容("主"內容)與其他相關內容("詳細資訊"內容)之間的關係。 在此模式中,詳細資訊內容與使用者正在使用的內容明顯相關,並且可以顯示在主內容附近。 補充資訊或資訊,不能匯總,而不壓倒主內容應遵循另一種模式,如工具視窗。

- **始終**在靠近主內容的地方顯示詳細信息內容。

- **始終**確保詳細資訊內容仍使用戶能夠始終專注於主內容。 通常,實現此目的的最佳方法是盡可能接近主內容呈現細節內容。 這可以通過在主內容旁邊的彈出視窗中呈現詳細資訊內容,或者通過在主內容下方內聯呈現詳細資訊內容來實現。

- **切勿**在將使用者從主內容中移開的注意力點使用資訊。 如果使用者需要單獨詳細資訊內容,則公開允許使用者執行此操作的顯式操作。

#### <a name="design-details"></a>設計詳情
 確定物件 UI 是正確的選擇後,有四個主要設計注意事項:

1. **持久性:** 內容是持久還是瞬態?
   使用者是否希望保持資訊可見以引用或與之交互? 或者,使用者會希望快速瀏覽資訊,然後繼續其主要任務?

2. **內容類型:** 內容是資訊性的、可操作的還是導航性的?
   使用者是否需要有關主內容的其他詳細資訊? 使用者是否需要完成影響主內容的任務? 還是需要將使用者定向到其他資源?

3. **指標類型:** 環境指示器有意義嗎?
   資訊能否以有用的方式匯總並顯示而不使主內容不堪重負?

4. **手勢:** 將使用哪些手勢來呼叫和關閉 UI?
   使用者將如何提出詳細資訊內容並將其發送掉? 添加手勢(如固定以在瞬態和持久狀態之間切換)是否有價值?

   這四個決策點中的每一個都會對物件 UI 的主要元件產生影響。

### <a name="on-object-ui-components"></a>物件上 UI 元件

1. 容器(內容示範者)類型

    - 浮動

    - 內嵌

2. 內容類型

    - 資訊:可能是靜態或動態的數據

    - 可操作:變更主內容的指令

    - 導覽:將使用者帶到其他視窗或應用程式(如 MSDN)的連結

3. 軌跡

    - 引動過程

    - 解僱

    - 釘選

    - 其他互動

4. 持久性和提交模型

    - 暫時性

    - 持久

    - 自動

    - 隨選

5. 環境指示器(選擇性的)

    - 波浪線下劃線

    - 智慧標籤圖示

    - 其他環境指示器

#### <a name="container-content-presenter-type"></a>容器(內容示範者)類型
 有兩個主要選項可用於在關注點呈現內容:

1. **內聯:** 內聯示範者(如 Visual Studio 2013 代碼編輯器中引入的預覽視圖)通過行動現有內容為新內容提供了空間。

    - 如果您希望使用者需要花費大量時間引用您提供的內容或與您提供的內容交互,**則更喜歡**內聯演示者。

    - 如果您希望使用者希望流覽您提供的資訊,**請避免**內聯演示者,然後繼續其主要任務,盡量減少中斷。

2. **浮動:** 浮動演示者的位置盡可能靠近所選內容,但不會更改現有內容的佈局。 可以使用各種策略,例如將浮動內容面板顯示在所選符號最近的可用空白上。

    - 如果您希望使用者希望瀏覽您提供的資訊,**請選擇**浮動演示者,然後以最小的中斷繼續其主要任務。

    - 如果您希望使用者需要花費大量時間引用您呈現的內容或與您呈現的內容進行交互,**請避免**浮動演示者。

#### <a name="content-type"></a>內容類型
 有三種主要類型的內容可以顯示在任何物件上 UI 容器中。 可以顯示這些類型的資訊的任意組合。 這三種類型是:

1. **資訊性:** 大多數物件 UI 容器將顯示某種資訊內容。 內容可以表示有關環境當前狀態的資訊,也可以表示有關環境未來潛在狀態的資訊。 例如,它可用於顯示特定命令(如重構)對現有代碼的影響。

    - **始終**使用您顯示的信息的規範表示形式。 例如,代碼應類似於代碼,並帶有語法突出顯示功能,並且應尊重用戶設置的任何字體和其他環境設置。

    - **始終**考慮支援對資訊內容的任何操作,如果將相同的信息作為主內容顯示,則可能採取這些操作。 例如,如果在物件 UI 容器中顯示現有代碼,則強烈建議支援瀏覽和修改該代碼的能力。

    - 如果顯示表示未來潛在狀態的資訊性內容,**則始終**考慮使用不同的背景顏色。

2. 可操作:某些物件上的 UI 容器將提供對主內容執行某些操作的能力,例如執行重構操作。

    - **始終**將可操作的命令與信息內容分開放置。

    - **始終**在適當時啟用和禁用操作。

    - **始終**引用用於表示對話方塊中命令的標準準則。

    - **始終**將物件 UI 容器中公開的操作數保持在絕對最小值。 與物件 UI 互動應該是一種輕量級、快速的體驗。 使用者不必花費精力來管理物件上的 UI 容器本身。

    - **始終**考慮如何以及何時關閉或關閉物件 UI 容器。 最佳做法是,在調用主內容和詳細資訊內容之間的對話方塊時,任何結束主內容與詳細資訊內容之間的對話的操作也應關閉物件上的 UI 容器。

3. **導航:** 某些物件上的 UI 容器包括將使用者帶到其他視窗或應用程式的連結,例如在使用者的 Web 瀏覽器中打開 MSDN 文章。

    - **始終**使用"打開"準備任何導航連結,以便使用者不會因為導航到某些其他內容而感到驚訝。

    - **始終**將導航連結與可操作連結分開。

#### <a name="ambient-indicators-optional"></a>環境指示器(選擇性的)
 環境指示器可能很微妙,包括來自代碼其餘部分的對比顏色的文本,或很明顯的文本,包括波浪形下劃線和智慧標記圖示等滴答聲符號。 環境指示器傳達其他相關信息的可用性。 理想情況下,即使不需要使用者與他們交互,它們也能提供有用的資訊。

- **始終**定位環境指示器,使其不會分散使用者的注意力或壓垮使用者。 如果無法以這種方式定位環境指示器,請考慮另一個解決方案。

- **始終**將環境指示器定位盡可能靠近與其相關的內容。

- **始終**嘗試創建一個指標,匯總其提供的資訊。 請考慮提供可用數據項數的計數(例如,"3引用"而不是簡單的"引用"),或者考慮其他一些匯總資料的方法。

  - 如果指標的數據不能始終計算和顯示,則當計算值時,立即考慮提供累進反饋。 例如,請考慮為反映可用數據更新的更改進行動畫處理,類似於 Windows Phone 上的電子郵件動態磁貼刷新的方式,因為未讀電子郵件的數量會增加。

- **切勿**添加超過使用者可以合理接受給定內容的指標。 環境指示器應有用,無需用戶進行任何交互。 如果指標需要溢出和其他管理控制來使其進入視野,則它們會失去其氛圍。

#### <a name="gestures"></a>軌跡
 允許使用者保持對主內容的關注的一個關鍵方面是支援正確的手勢來打開和關閉其他詳細資訊內容。

- **始終**要求使用者執行一些顯式手勢以打開其他內容。 常見的開放手勢包括:

  - **暫停:** 工具提示或非互動式資訊內容

  - **明確指令:** 內圖示範者

  - **按兩下環境指示器:** CodeLens 彈出視窗

- **每當**使用者按下 Esc 鍵時,始終關閉詳細資訊內容。

- **始終**考慮物件 UI 的上下文。 對於允許在容器內交互的內容演示者,請仔細考慮是否顯示有關懸停的其他資訊,這可能會破壞使用者的工作流。

- **切勿**在懸停上顯示看似可編輯的內容,也不要邀請使用者交互。 如果用戶嘗試將游標移到詳細資訊內容上,則此行為可能會使用戶感到沮喪,因為工具提示的標準行為是在游標不再位於生成該內容的主內容上時立即關閉。

## <a name="selection-models"></a><a name="BKMK_SelectionModels"></a>選擇模型

### <a name="overview"></a>概觀
 選擇模型是用於指示和確認使用者介面中一個或多個感興趣物件的操作的機制。 本主題討論 Visual Studio 文件編輯器中的選擇互動模式:文字編輯器、設計曲面和建模曲面。

 用戶必須有一種方式向 Visual Studio 指示他們正在處理的內容,Visual Studio 必須以可預測的方式回應使用者有關其操作內容的反饋。 使用者和使用者介面之間的差異或溝通不當可能導致使用者沒有注意到操作,從而產生意外的後果。 通常,在使用者看到某些內容丟失或已更改之前,該錯誤才會被注意到。 因此,選擇模型是用戶介面設計中最重要的部分之一。 儘管 Visual Studio 中的選擇模型與 Windows 一致,但存在細微的變化。

 在 Visual Studio 中,如 Windows 中一樣,選擇模型因交互發生的上下文而異。 選擇可以發生在四種類型的物件中:

- Text

- 圖形物件

- 清單與樹狀

- 方格

  在這些物件中,有三種類型的選擇:

- 連續

- 脫節

- 區域

#### <a name="scope"></a>影響範圍
 選擇的最重要組成部分是確保使用者知道他們正在哪個視窗中工作(啟動)以及焦點位於何處(選擇)。 Visual Studio 擴充了 Windows 中的視窗管理功能,但啟動方案是相同的:與窗互會將焦點帶到視窗。 Visual Studio 有兩個用於啟動的指標:一個用於文檔視窗,另一個用於工具視窗。

 對於文件窗動視窗由文件視窗選項卡指示,該選項卡位於前面並更改其背景顏色:

 ![Visual Studio 中的作用中索引標籤選取](../../extensibility/ux-guidelines/media/0713-01_activetab.png "0713-01_ActiveTab")

 **作用選項卡選擇**

 對工具窗動視窗由工具視窗的標題列區域顏色變化指示:

 ![Visual Studio 中的作用中工具視窗選取](../../extensibility/ux-guidelines/media/0713-02_activetoolwindow.png "0713-02_ActiveToolWindow")

 **顯示節點主要選擇的活動工具視窗**

 ![Visual Studio 中的非作用中工具視窗選取](../../extensibility/ux-guidelines/media/0713-03_inactivetoolwindow.png "0713-03_InactiveToolWindow")

 **非作用工具視窗,顯示節點的潛在選擇**

 視窗處於活動狀態后,將根據指南本節中概述的選擇模型指示其焦點。

#### <a name="context"></a>Context
 Visual Studio 旨在保留強大的上下文概念,跟蹤使用者的工作位置。 只有一個視窗處於活動狀態,無論是工具還是文檔視窗。 但是,最頂層的文檔視窗始終保留潛在選擇。 儘管焦點可能位於工具視窗中,但上次處於活動狀態的文檔視窗將顯示所選內容,即使在非活動狀態下也是如此。 這樣做是為了在編輯的文檔中保留使用者的上下文,向他們顯示 Visual Studio 已保留其狀態,以便他們可以在工具視窗和文檔視窗之間無縫返回和移動。

### <a name="text-selection"></a>文字選取
 嚴格文字的視覺化 Studio 編輯器(如內建文字編輯器)使用與 MSDN 上的 Windows 使用者體驗互動指南的[「滑鼠和指標」](/windows/desktop/uxguide/inter-mouse)頁面中描述的相同文字選擇模型和外觀。 文字編輯器中的輸入焦點由稱為插入點的垂直條表示。 插入點是一個像素厚,顏色為與它後面出現的任何一點的相反。 它根據「控制面板」中的**鍵盤**小程式**速度**「選項卡中的**游標閃爍速率**設置的速率閃爍。

#### <a name="contiguous-and-disjoint-selection"></a>連續和不交的選擇
 文字編輯器中的選擇僅連續。 不允許不相交的文本選擇,但應在圖形對象編輯器中定址。 當用戶的滑鼠指標位於文本區域上時,游標將更改為 I 束。 只需按一下,即可將插入點置於單擊位置的文本編輯器中。 按住滑鼠按鈕將啟動選擇高光,釋放滑鼠按鈕結束選擇高光。

#### <a name="region-selection-box-selection"></a>區域選擇(方塊選擇)
 Visual Studio 支援文字編輯器中的區域選擇,這稱為框選擇。 框選擇允許用戶選擇不遵循常規文本流的文本區域。 與標準文本選擇一樣,所選內容必須是連續的。 使用滑鼠拖動時按住 Alt 鍵啟動框選擇。 也可以通過按住 Alt 和 Shift 鍵來啟動框選擇,同時使用箭頭鍵指示選擇區域。 框選擇使用正常選擇高光,並顯示插入點游標在選擇區域末尾閃爍。

 ![視覺工作室中區域&#40;盒&#41;選擇](../../extensibility/ux-guidelines/media/0713-04_boxselection.png "0713-04_BoxSelection")

 **視覺工作室中的區域(框)選擇**

#### <a name="text-selection-appearance"></a>文字選擇外觀
 可以自定義用於編輯器中活動和非活動選擇的顏色。 要自定義編輯器的視覺外觀,用戶可以轉到**工具>選項**,然後在**環境>字體和顏色>文本編輯器**下查看。

### <a name="graphical-selection"></a>圖形選擇

#### <a name="interaction"></a>互動
 圖形物件選擇可能很複雜,具體取決於許多因素:

- **編輯器的主選擇模型。** 包含圖形物件的編輯器也可用於編輯文本或網格。 例如,編輯器可能是基於文本的編輯器,該編輯器還支援圖形物件的位置,例如 Visual Studio XAML 設計器。 支援多個物件類型可能會影響使用者選擇由不同類型的物件組成的組的方式。

- **支援主選擇和輔助選擇狀態。** 編輯器可以提供主選擇和輔助選擇狀態,以便可以一致地編輯物件、相互對齊、一起調整大小等。

- **就地編輯支援。** 編輯人員還可以允許編輯其圖形物件的內容。 例如,矩形形狀可能還包含內部使用者可以更改的文本。 此外,該文本可以居中或對齊。 就地編輯涉及更詳細的使用者交互級別,因此需要一組適當的視覺提示來向使用者顯示狀態資訊。

#### <a name="mouse-interaction"></a>滑鼠互動

|輸入|結果|
|-----------|------------|
|按下未選擇的物件|選擇物件並顯示虛線和選擇控點(如果物件可調整大小)。|
|點選選取的物件|如果物件支援,則啟動就地編輯。 按一下物件外部將停用就地編輯模式。|
|雙擊物件|打開物件後面的代碼進行編輯,並可能插入預設事件處理程式(如果適用)。|
|指向物件|更改指向移動游標的指標。 對象的外觀(如亮度或顏色)可能會更改。|
|選擇句柄|更改指向調整游標的指標。 對於支援旋轉的物件,某些選擇控點可能會更改指向旋轉游標的指標,因為指標相對於選擇句柄的定位不同(例如,移動得更遠)。|
|拖曳|即使以前未選擇物件,也會更改指向移動游標的指標並移動物件。|
|編輯器失去焦點|停用就地編輯模式,儘管物件保留其上次操作/選擇狀態期間的內容和外觀。|
|物件選擇|由邊框、虛線或其他視覺上截然不同的處理指示,以突出顯示對象的邊界。|
|調整選取物件的大小|由選擇控點指示。<br /><br /> 可調整大小的物件有八個控點,表示可以調整大小的每個方向。 如果物件只能在某些方向上調整大小,則可以使用較少的句柄。 當使用者將物件大小調整到八個句柄不是互動式的位置時,可以使用四個句柄。 處理大小應與視窗邊框和邊緣指標綁定,使用**GetSystemMetrics** API 函數的大小與顯示解析度成比例。<br /><br /> ![調整控點大小](../../extensibility/ux-guidelines/media/0713-05_resizehandles.png "0713-05_ResizeHandles")|
|旋轉選擇物件|![旋轉控點](../../extensibility/ux-guidelines/media/0713-06_rotate.png "0713-06_Rotate")|

#### <a name="keyboard-interaction"></a>鍵盤互動

|輸入|結果|
|-----------|------------|
|索引標籤|在編輯器中物件的邏輯順序之間移動焦點指示器。 根據**TabIndex(** 或等效)屬性值、對象創建順序以及編輯器的總體用途,這可能從左到右或從上到下。 Shift_Tab 反轉焦點指示器的方向。|
|空白鍵|保持擊鍵時啟動平移模式。 需要額外的滑鼠輸入來平移視口位置。|
|Ctrl+空格鍵|保持擊鍵時啟動縮放模式。 需要額外的滑鼠輸入來增加和減小縮放係數。|
|Ctrl_Alt_減號|將縮放係數減小一個級別。|
|Ctrl_Alt_加號|將縮放係數增加一個級別。|
|移位或 Ctrl|將物件添加到選擇組。 Ctrl 還允許您從選擇組中單獨刪除物件。|
|Enter|對物件執行預設命令(通常為"打開"或"編輯")。|
|F2|啟動物件的就地編輯。|
|方向鍵|以較小的增量(例如,一次 1 像素)向按下箭頭鍵的方向移動所選物件|
|Ctrl_箭頭鍵|以更大的增量(例如,一次 10 像素)按鍵的方向移動所選物件|
|移位+箭頭鍵|以較小的增量調整所選物件的大小(例如,一次 1 像素)|
|Ctrl_Shift_箭號鍵|以較大幅度(例如,一次 10 像素)調整所選物件的大小(|

 當使用者就地編輯控制件時,物件使用使用者輸入自動調整大小可能有意義。 例如,如果使用者編輯了標籤控制項,則標籤應成長以顯示使用者剛剛鍵入的文本。 如果未完成此操作,則用戶必須在編輯文本後手動調整控制件的大小。 如果使用者有很多控件,這將成為一個死記硬背的任務。

#### <a name="graphical-containers"></a>圖形容器
 在某些情況下,圖形編輯器為其他圖形物件(如 Windows 窗體面板控制件或 HTML 設計器中的網格佈局控制件)提供容器。 如果編輯器為其他圖形物件提供容器,則以下選擇模型應僅用於容器(容器中的物件遵循上述標準模型):

|輸入|結果|
|-----------|------------|
|點選容器|選擇容器物件而不直接選擇任何包含的物件。 容器可以使用標準滑鼠和鍵盤輸入(如上所述)移動和/或調整大小。 包含的物件相對於容器移動,但包含的物件不會調整大小,除非它們也直接被選中。|
|將滑鼠移動在容器的邊界區域上|將滑鼠轉換為移動游標,指示可以移動容器。|
|拖動容器的邊界區域|將滑鼠更改為移動游標並移動容器(以及包含的物件)。 如果不首先按一下,則無法移動容器。|
|點選容器內的物件|取消選擇容器(如果選中),並僅選擇單擊的物件。|
|Shift_按下或點擊包含的物件和/或容器|將按一下的物件添加到現有選擇或選擇群組。 如果單擊的對象已經是選擇組的成員,則從選擇組中刪除它。|

 包含的物件應符合上一節所述的基本選擇模型。 從 Windows 窗體設計器的可用性測試中,使用者期望無縫存取包含的物件,而無需干預步驟(由包含物件強制實施)。

#### <a name="disjoint-and-region-selections"></a>不相交和地區選擇
 圖形物件編輯器應支援不相交的選擇。 請注意,此圖形不顯示 Visual Studio 的控制外觀。 有關詳細的視覺規格,請參閱[圖形物件選擇外觀](../../extensibility/ux-guidelines/composite-patterns-for-visual-studio.md#BKMK_GraphicalObjectSelectionAppearance)。

 ![斷續和區域選取器](../../extensibility/ux-guidelines/media/0713-07_disjointregionselectors.png "0713-07_DisjointRegionSelectors")

 **不相交選擇**

 圖形編輯器還應提供帶有選框類型選擇指示器的區域選擇。 如果圖形編輯器支援其他物件類型(如文本),則根據這些其他對象類型的約束,可能無法選擇區域。

 ![點線框選取](../../extensibility/ux-guidelines/media/0713-08_marqueeselection.png "0713-08_MarqueeSelection")

 **點線框選取**

#### <a name="primary-and-secondary-selections"></a>主要與次要選擇
 某些圖形物件編輯器允許使用者編輯或對齊組中的物件。 在這種情況下,需要引入主選擇和輔助選擇的概念。 主選擇是所有其他物件回應組操作的物件。 使用者首先選擇的物件將成為主控件,後續選擇將成為輔助選擇。 主選擇具有與輔助選擇不同的可視處理,以指示哪個物件是主要物件:

 ![主要和次要選取範圍](../../extensibility/ux-guidelines/media/0713-09_primarysecondary.png "0713-09_PrimarySecondary")

 **具有兩個輔助選擇的主選擇**

#### <a name="graphical-object-selection-appearance"></a><a name="BKMK_GraphicalObjectSelectionAppearance"></a>圖像物件選擇外觀
 選擇控點是圍繞物件邊界框以矩形圖案繪製的正方形。 下圖顯示了圖形物件具有句柄、大小調整和就地編輯外觀的各種狀態的範例。 使用**GetSystemMetrics** API,句柄的大小應綁定到視窗邊框和邊緣指標。

| State | 外觀 | 視覺細節 |
|-------------------------|---------------| - |
| **未選取** | 預設 | ![預設按鈕狀態](../../extensibility/ux-guidelines/media/0713-10_defaultstate.png "0713-10_DefaultState") |
| **主要選擇** | 可調整大小 | ![使用調整大小控點的主要選取範圍](../../extensibility/ux-guidelines/media/0713-11_primaryresize.png "0713-11_PrimaryResize") |
| **主要選擇** | 無法調整大小 | ![不使用調整大小控點的主要選取範圍](../../extensibility/ux-guidelines/media/0713-13_primarynoresize.png "0713-13_PrimaryNoResize") |
| **主要選擇** | 已鎖定 | ![已鎖定主要選取範圍](../../extensibility/ux-guidelines/media/0713-15_primarylocked.png "0713-15_PrimaryLocked") |
| **次要選擇** | 可調整大小 | ![含有調整大小控點的次要選取範圍](../../extensibility/ux-guidelines/media/0713-17_secondaryresize.png "0713-17_SecondaryResize") |
| **次要選擇** | 無法調整大小 | ![不使用調整大小控點的次要選取範圍](../../extensibility/ux-guidelines/media/0713-19_secondarynoresize.png "0713-19_SecondaryNoResize") |
| **次要選擇** | 已鎖定 | ![已鎖定次要選取範圍](../../extensibility/ux-guidelines/media/0713-21_secondarylocked.png "0713-21_SecondaryLocked") |
| **UI 活動** | 預設 | ![UI 作用狀態](../../extensibility/ux-guidelines/media/0713-23_uiactive.png "0713-23_UIActive") |

### <a name="view-selection-models"></a>檢視選擇模型

#### <a name="tree-view"></a>樹狀檢視
 樹視圖中的選擇以簡單的高光顯示。 如果用戶單擊節點名稱或節點圖示,則節點將被選中。 節點左側的三角形字形展開或收縮樹控件,但不影響使用者的選擇,但有一個例外:當所選內容位於該節點的子節點上時摺疊父節點時,所選內容將移動到父節點。

 ![Visual Studio 中的一般樹狀檢閱](../../extensibility/ux-guidelines/media/0713-25_treeview.png "0713-25_TreeView")

 **Visual Studio 中的一般樹狀檢閱**

 樹視圖可以支援連續和不相交的選擇,即使在樹中的多個級別也是如此。 必須在可見的樹節點上進行連續或不交的多個選擇。 如果節點摺疊,則不交接合的選擇將丟失,摺疊的節點將獲取該選擇。 這樣,使用者可以看到受操作影響的節點。 當節點摺疊時,不清楚哪些節點可能會受到影響。

 選擇父節點時,該操作應應用於父節點,但在某些情況下,操作應用於父節點及其所有子節點可能有意義。 在這種情況下,請在操作期間提供其他 UI,例如複選框或確認對話方塊,以使「適用於所有子級」選項顯式提供給使用者。

##### <a name="renaming"></a>重新命名
 如果樹中的節點支援重命名,則應進行重命名。 就地操作應是 Visual Studio 中所有樹控件的標準。 提供立即啟動就地編輯模式的重命名命令,文本選擇覆蓋節點的整個名稱,隨時接受使用者輸入。 如果節點表示檔,則檔名應包含副檔名。 選擇突出顯示應僅包括檔名的正文,而不是副檔名。

|輸入|結果|
|-----------|------------|
|ENTER 鍵|提交重新命名操作|
|Esc 鍵|取消重新命名操作|
|點選就地編輯區域外部|提交重新命名操作|
|復原|輕鬆復原取消重新命名操作|

#### <a name="selection-within-lists-and-grid-controls"></a>清單與格線控制項選取
 清單選擇中的關鍵概念是,它是基於行的,這意味著當進行選擇時,整個行將作為一個單元進行選擇。 相反,網格可以允許選擇特定的單元格,而不會影響行的任何其他方面。 網格還可能包含嵌套行的層次結構(如樹網格中),該層次結構允許通過與父行交互來選擇和取消選擇層次結構的整個分支。 清單中的選擇由整個數據行上的簡單高光顏色顯示。 焦點由當前可編輯行或單元格周圍的單像素虛線邊框顯示(如果所有單元格都是唯讀的行)。

> [!NOTE]
> **焦點**和**選擇**是不同的概念。 *Focus*指示哪個 UI 元素用於接收未顯式定向到另一個物件的輸入,而*選擇*是指物件包含在一組物件中的狀態,以便進行後續操作。

 清單中的選擇可以是連續的、不相交的或區域。 當允許多個選擇時,應始終支持連續和不相聯的選擇,而對區域(框)選擇的支援是可選的。 區域選擇是通過在清單正文的空白中拖動來啟動的。

| Object | 選取項目 |
|--------|------------|
| 清單 | 連續 |
| 清單 | 脫節 |
| 清單 | 區域 |

 按一下清單一次將選擇發生單擊的行。 如果使用者碰巧在支援就地編輯的清單單元格中按一下,則該單元格也會立即啟動以進行就地編輯。 否則,將立即選擇整行並顯示高光。

 在清單正文中拖動可以執行以下三項操作之一:

- 如果清單支援區域選擇,並且滑鼠向下為空白,則啟動區域選擇

- 如果清單儲存格或行支援作為拖動源,則啟動拖放作業

- 選擇目前的列

##### <a name="in-place-editing"></a>就地編輯
 允許就地編輯時,有兩個基本模型:簡單的編輯控制件和屬性選取器。 使用簡單的編輯控制件,內容將突出顯示,並在啟動就地編輯後立即準備好供用戶輸入。 實現屬性選取器時,啟動就地編輯模式后,將顯示調用屬性選取器的按鈕,並且當前選擇不會突出顯示。 單元格中選取器按鈕應正確對齊。 有關就地編輯範例,請參閱可視化工作室中**的屬性視窗**與**工作清單**。

##### <a name="keyboard-support"></a>鍵盤支援
 對清單和網格中選擇的鍵盤支援遵循標準 Windows 約定:

- 箭頭鍵導航清單,在移動焦點時選擇每行/單元格。

- Shift + 箭頭在箭頭鍵的方向執行連續選擇。

- Ctrl + 箭頭後跟空格鍵在從所選內容添加和刪除清單項之間切換,從而創建不相交的選擇。

- 對於包含嵌套層次結構的網格,右箭頭鍵展開父行,左箭頭鍵摺疊一個。

- 如果儲存格是可編輯的,選項卡鍵在當前行的儲存格之間移動焦點。

- Enter 鍵對清單中的項執行預設命令(通常**為"打開**"。

- F2 鍵啟動當前所選單元格的就地編輯。

## <a name="persistence-and-saving-settings"></a><a name="BKMK_PersistenceAndSavingSettings"></a>持久性和儲存設定

### <a name="overview"></a>概觀
 儘管 Visual Studio 中的每個軟體元件通常負責其自身的狀態和持久性,但 Visual Studio 在某些情況下(如視窗大小和位置)會自動保存設置。 下表是自動保存的設置和需要執行顯式使用者或程式設計操作的設置的組合。

|Object|要儲存的內容|何時儲存|儲存位置|
|------------|------------------|------------------|-------------------|
|選擇物件(例如,一行代碼)|程式碼列中斷點<br /><br /> 與程式碼列關聯的使用者快捷方式|儲存項目時|專案**的使用者選項 (.suo)** 檔案|
|對話|對話框的位置(如果已移動)<br /><br /> 使用者上次在對話框中使用的檢視|當對話框關閉時<br /><br /> 視覺化工作室工作階段結束時|在記憶體中<br /><br /> **HKEY_Current_User**註冊|
|時間範圍|視窗的大小與位置|當視窗關閉時<br /><br /> 當視覺工作室模式變更時<br /><br /> 視覺化工作室工作階段結束時|專案**的使用者選項 (.suo)** 檔案<br /><br /> 視窗設定的自訂選項檔案|
|Document|文件選取的檔案<br /><br /> 文件檢視<br /><br /> 使用者存取的最後幾個位置|儲存文件時|專案**的使用者選項 (.suo)** 檔案|
|隨附此逐步解說的專案|對檔案的參考<br /><br /> 對磁碟上的目錄的參考<br /><br /> 對其他軟體的參考<br /><br /> 元件<br /><br /> 有關專案本身的狀態資訊|儲存項目時|專案檔|
|解決方法|從專案的參考<br /><br /> 對檔案的參考|儲存專案或解決方案時|**解決方案 (.sln)** 檔案|
|**工具中的設定>選項**|鍵盤自訂<br /><br /> 工具列自訂項目<br /><br /> 顏色機制|當**工具>選項「** 對話框關閉時<br /><br /> 視覺化工作室工作階段結束時|**HKEY_Current_User**註冊|

 使用者正在執行的操作,以及執行此操作時,會決定設置是否保存在記憶體中(在會話期間),是否作為專案或解決方案檔本身的一部分保存到磁碟(作為註冊表設置跨會話)、解決方案**選項 (.suo)** 檔的一部分,還是作為僅軟體元件知道的自定義設定檔。 上表顯示了多個可以保存設置的事件。 但是,在其他時間,您可能需要儲存狀態:

- 當使用者變更對話框或視窗中的位置時

- 當使用者將焦點移至另一個視窗時

- 當使用者從設計切換到除錯模式時

- 當使用者登出帳號時

- 當電腦進入睡眠狀態或關閉時

- 當電腦/硬碟驅動器即將重新格式化並重新設定時

### <a name="window-configurations"></a>視窗設定
 視窗配置是開發環境的基本表示 - 它是一個方案,由存在的工具視窗列表和排列方式組成。 對於由 IDE (IDE 視窗)管理的視窗,每個使用者將保留佈局資訊,因此當使用者啟動 IDE 時,視窗佈局將顯示與上次退出 Visual Studio 時相同。 IDE 視窗的狀態和位置儲存在 XML 格式的自定義選項檔中。 由載入 IDE 中的套件創建的工具視窗在註冊表中保留其狀態資訊,並且可能由使用者保留,也可能不是每個使用者。

#### <a name="profile-specific-layouts"></a>特定於設定檔的佈局
 每個配置檔都包括工具視窗佈局,以特定開發人員角色熟悉的方式組織(可視C++開發人員希望看到 IDE 左側**的解決方案資源管理器**,而 C# 開發人員希望看到右側**的解決方案資源管理器**)。 使用者在啟動時選擇配置檔後載入特定於設定檔的視窗佈局。 包作者應確定最適合其客戶體驗的視窗布局,因為知道使用者對視窗配置所做的更改將被保留。

## <a name="touch-input"></a><a name="BKMK_TouchInput"></a>觸控輸入
 用戶越來越多地在觸控裝置上使用Microsoft開發產品。 但是,存在一些障礙,使得在觸摸設備上使用開發工具變得困難。 使用者希望我們的產品提供可靠、精確的觸摸體驗。 這些指南的目的是為決定要整合哪些觸摸功能提供資訊,並鼓勵跨 Visual Studio 和相關產品獲得一致的觸摸體驗。

### <a name="levels-of-experience"></a>經驗水準
 以下經驗級別旨在作為指南,幫助團隊根據所需的接觸投資興趣水準決定提供哪種觸摸功能。

- **基本體驗**是希望提供觸摸功能的團隊,因此整個工作沒有死胡同。

- **優化的體驗**適用於希望提供最常見的觸控功能的團隊(例如,網路瀏覽器應用程式中通常可用的功能)。

- **提升體驗**適用於希望添加手勢或其他可選功能等功能的團隊,這些功能可以使應用程式先觸摸友好。

||基本經驗|優化體驗|提升體驗|
|-|----------------------|--------------------------|-------------------------|
|允許使用者...|修復代碼和解決方案/專案級讀取,無死角|執行維護、重構和導航工作|自信地以一致、直觀和流暢的體驗操作|
|編輯器|觸摸平移與選擇<br /><br /> 捲動條觸控以跳轉並按+拖動|捏合縮放<br /><br /> 快速捲動<br /><br /> 選取項目<br /><br /> 易於使用上下文選單||
|頂端工具視窗|清單平移<br /><br /> 項目選取<br /><br /> 捲動條觸控以跳轉並按+拖動|輕鬆的項目捲動與選擇||
|時間範圍||調整視窗大小<br /><br /> 快速存取||
|文件良好||開啟的檔案之間的輕鬆導覽||
|軌跡||確保常見手勢在整個 IDE 中工作|基於手勢的操作<br /><br /> 支援拖放及設計器|
|其他考量|||自訂螢幕鍵盤|

#### <a name="gestures"></a>軌跡
 手勢為使用者提供了指向可能需要更複雜的交互的命令的快捷方式。 請參閱有關[桌面應用程式常見觸摸手勢的](/windows/desktop/wintouch/windows-touch-gestures-overview)Windows 指南,並遵循本指南,查看大多數手勢,包括簡單的手勢,如平移和縮放。
