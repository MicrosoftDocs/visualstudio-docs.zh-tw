---
title: 功能表和命令適用於 Visual Studio |Microsoft Docs
ms.date: 11/04/2016
ms.topic: conceptual
ms.assetid: 0a1ed675-2bd1-4603-ba3a-f40dfb5cfb69
author: gregvanl
ms.author: gregvanl
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: 94d4ac86f40f887eed9d858f10614441d88c9c54
ms.sourcegitcommit: 94b3a052fb1229c7e7f8804b09c1d403385c7630
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/23/2019
ms.locfileid: "62793892"
---
# <a name="menus-and-commands-for-visual-studio"></a>功能表和命令適用於 Visual Studio
## <a name="command-usage"></a>命令使用方式

### <a name="overview"></a>總覽
 與 Microsoft Office，也就是包含許多不同的產品套件，不同的是 Visual Studio 包含許多產品，每個參與其全域 Visual Studio ide 的命令集。 IDE 會篩選功能，可讓使用者根據內容用於管理數千個命令的複雜性。

 當使用者的內容變更-例如從 [設計] 視窗切換至編輯視窗的程式碼-功能無關的新內容就會消失。 在此同時，新的功能介面，以及相關的動態資訊，例如屬性和 [工具箱] 的選項。 使用者應該不會注意到可用的命令集的交換。 如果使用者困擾或混淆命令不會出現或消失，UI 設計需要調整。 使用者的目前內容一律中被表示一個或多個方法，這類 IDE 標題列、 [屬性] 視窗中或 [屬性頁] 對話方塊中。

 命令列允許在 UI 中的彈性。 唯一命令結構固有到 Visual Studio 環境會在主功能表和主要的命令列中，同時並加以自訂和甚至是隱藏的。 其他命令列會出現和消失的應用程式的狀態中的 基礎。 工具視窗和文件編輯器也可以包含內嵌在其視窗邊緣的工具列。

#### <a name="basic-guidelines"></a>基本的指導方針

##### <a name="use-existing-shared-commands-command-groups-and-menus-whenever-possible"></a>使用現有共用的命令、 命令群組和功能表可能的話。
 因為命令通常會根據顯示內容，使用現有的共用的功能表和命令群組可確保命令結構仍然相對穩定之間內容中的變更。 重複使用共用的命令，並將放置新的命令相關的共用命令接近降低 IDE 的複雜性，會建立更方便使用體驗。 如果需要定義新的命令，嘗試將它放在現有的共用的命令群組。 如果新的群組，就必須定義，放在接近相關的命令群組現有的共用功能表建立新的最上層功能表之前。

##### <a name="do-not-create-icons-for-every-command"></a>請勿建立針對每個命令的圖示。
 只有在您建立的命令圖示之前，請仔細考慮。 圖示應該只會針對命令建立的：

- 會出現在預設工具列。

- 可能由使用者加入至工具列，以透過**自訂...** 對話方塊。

- 有相同的動作，在另一項 Microsoft 產品與相關聯的圖示。

##### <a name="limit-the-addition-of-keyboard-shortcuts"></a>限制的鍵盤快速鍵
 絕大多數的使用者採用一小部分的所有可用的快速鍵。 如有疑問，未繫結功能為鍵盤快速鍵。 使用您的使用者體驗小組之前加入新的快速鍵。

##### <a name="give-commands-a-default-menu-placement"></a>提供命令的預設功能表的位置。
 請注意，您的命令要其他人進行自訂，並據以設計它們。 沒有這類的隱藏的命令。 所有的 Visual Studio 命令會出現在**工具 > 自訂** 對話方塊中，命令 視窗中，自動完成**工具 > 選項 > 鍵盤** 對話方塊中，與開發工具環境 (DTE)。 請務必為您的命令，指定名稱和.ctc 檔中的工具提示，讓使用者可以輕鬆地找到它們。

##### <a name="do-not-duplicate-shared-commands-on-an-embedded-toolbar"></a>不會重複在內嵌工具列上的共用的命令。
 您最好將命令放在接近使用者的關注區域。 若要這樣做的一個方式是在您的工具視窗或文件頂端編輯器建立內嵌的工具列。 放在工具列上的命令應該是在視窗內的內容區域的特定項目。 不會重複這些工具列上的共用的命令。 例如，永遠不會放置在內嵌工具列的 [儲存] 圖示。

### <a name="content-and-command-visibility"></a>內容和命令的可見性
 命令會位於下列範圍：**環境**，**階層**，以及**文件**。 每個範圍需知命令位置中有信心。

 中的命令**環境**範圍建立主要的內容，並會在多個內容之間共用。 而是會修改文件和工具視窗的排列方式的可見性。 在環境中的命令範圍，其中包括**新的專案**，**連接到伺服器**，**附加處理序**，**剪下**， **複製**，**貼上**，**尋找**，**選項**，**自訂**，**開新視窗**，並**檢視說明**。

 中的命令**階層**範圍管理在 Visual Studio 包括階層**專案**， **Team**，以及**資料**。 例如，與專案的子內容-**偵錯**，**建置**，**測試**，**架構**，或**分析**. 在階層中的命令範圍，其中包括**加入新項目**，**新的查詢**，**專案設定**，**加入新的資料來源**， **啟動效能精靈**，並**新的圖表**。

 中的命令**文件**內容的文件，例如程式碼、 設計或工作項目查詢 (WIQ) 範圍處理。 它們也會處理的工具視窗的檢視或否則專屬於該工具視窗。 文件範圍命令也會依據的檔案物件本身的階層而異，例如**從專案移除**。 文件中的命令範圍，其中包括**重構 > 重新命名**，**建立工作項目的複本**， **全部展開**，**全部摺疊**，及**建立使用者工作**。

### <a name="command-placement-decisions"></a>命令位置決策
 一旦您已經決定要建立命令，您必須決定其適當的位置和是否要建立鍵盤快速鍵。 請遵循此決策路徑，以建立命令的位置：

 ![命令位置決策圖](../../extensibility/ux-guidelines/media/0501-a_commandplacement.png "0501 a_CommandPlacement")

 **在 Visual Studio 中的命令位置決策路徑**

### <a name="command-placement-in-menus"></a>在功能表中的命令位置

#### <a name="main-menu-bar"></a>主功能表列
 主功能表列應該是命令 UI 參與任何特定的內容功能表封裝的標準位置。 主功能表列會不同於其他命令的結構，環境會使用它來控制哪些命令是可見的範圍。 所有其他的命令列只需要停用命令，不在此情況下，它們被放在功能表或工具列上。

 環境會定義一組內建在主功能表列的命令都通用的整個 IDE 和工作的多個網域。 這些命令會永遠顯示不論其中 Vspackage 載入環境。 雖然 Vspackage 可以延伸這組命令，從每個產品和其命令的位置設定此命令會為每個小組的責任。

 Visual Studio 主功能表的結構可以分成下列功能表類別：

##### <a name="core-menus"></a>Core 功能表

- 檔案

- 編輯

- 檢視

- 工具

- 視窗

- Help

##### <a name="project-specific-menus"></a>專案特定功能表

- 專案

- 組建

- 偵錯

##### <a name="context-specific-menus"></a>特定內容功能表

- 小組

- 資料

- 測試

- 架構

- 分析

##### <a name="document-specific-menus"></a>文件特有的功能表

- 格式

- 資料表

##### <a name="when-designing-main-menus-adhere-to-these-rules"></a>在設計主功能表，請遵循這些規則：

- 不會超過 25 個最上層的項目中指定的內容

- 功能表應該永遠不會超過 600 像素的高度。

- Ultimate SKU 和一般設定檔中，例如評估多個內容，在主功能表。

- 飛出視窗功能表可接受的。

- 飛出功能表應該包含至少三個項目並不能超過 7 個。

- 飛出功能表應只有一個層級深度： 某些 Visual Studio 功能表項目有階層式的子功能表，但不是鼓勵這種模式。

- 使用不超過六個分隔符號字元。 群組應該遵守下列圖所示：

     ![主功能表群組的指導方針](../../extensibility/ux-guidelines/media/0501-b_mainmenus.png "0501 b_MainMenus")

- 雖然它不需要在圖中的每個群組，將其他群組加入會受到限制。

- 每個群組應該具有來自兩個至七個功能表項目。

#### <a name="main-menu-ordering"></a>主功能表排序
 然後再加入新的最上層項目，請考慮將命令放在現有的最上層功能表中。 當新增新的最上層功能表，請務必將它放在正確的位置。 決定功能表為特定專案、 內容或文件。 最上層的功能表名稱保持簡潔，並使用唯一一個文字。

 Core 功能表應該書夾其餘的命令。 檔案、 編輯和檢視應該一律是向左及工具 視窗中，並說明應一律為權限。

#### <a name="context-menus"></a>操作功能表
 放置太多的操作功能表中的功能會導致不容易學習的介面。 所有重大的功能應該可以透過主功能表列中使用。 命令的位置應該與現有的命令，以避免重複命令協調。 操作功能表，殼層會定義標準的功能表應該會根據解決方案、 專案節點，或專案項目中的內容功能表是否包含的群組。

 在設計時快顯功能表，遵循相同的規則與主功能表中，並加：

- 不會超過 25 個最上層功能表項目。

- 飛出視窗功能表可接受，但是必須不超過一層的深度，永遠不會使用階層式的延伸顯示。

- 使用不超過六個分隔符號字元。

### <a name="command-placement-in-toolbars"></a>在工具列中的命令位置

#### <a name="general-toolbars"></a>一般的工具列
 當設計和排列工具列，請遵循這些標準：

- 請勿使用一個以上的動詞命令，每個按鈕。 一個按鈕 = 一個動作。

- 只有在需要來標示要進行，請使用圖示旁的文字。

- 使用下拉式方塊只會在一個工作階段中多次切換的屬性。 否則，會公開其他位置的屬性。

- 下拉式方塊的寬度應該等於最長的項目，在方塊 + 30%的寬度。 比方說，如果 200 像素的最長的項目，則下拉式方塊應該 260 個像素寬。

- 限制使用分隔符號。 旁邊的下拉式清單中用法會是分隔符號的反模式，因為本身下拉式清單中的圖形做為視覺分隔符號。

- 圖示群組應該包含至少三到六個的圖示。

- 如果限定詞產生多個有用的命令，使用分割按鈕來儲存最後的設定：

     ![Visual Studio 中的分割按鈕](../../extensibility/ux-guidelines/media/0501-c_splitbuttons.png "0501 c_SplitButtons")

     **分割按鈕的範例。在左側的六個命令而可以納入單一按鈕。**

#### <a name="product-specific-toolbars"></a>特定產品的工具列
 每項產品可以提供包含常用的預設工具列和重要命令，以及每項產品的預設工具列應該已安裝產品之後，啟動 Visual Studio 的第一次。

 共用的命令群組和 IDE 所提供的功能表，也應該利用產品。 每個共用的命令群組會放在共用功能表要使用者有意義的方式組織相關的命令。 請務必利用此共用的命令結構，以降低複雜度。

#### <a name="global-toolbars"></a>通用工具列
 需要容納一個資料列右側，現成的全域工具列。 建立新的全域工具列時, 遵循的指導方針的工具列型別。

 **一般工具列指導方針：**

- 每個工具列通用控制項 （溢位中的 移駐夾） 中有 24 個像素。

- 每個工具列按鈕是 22 個像素寬包括填補字元。 建立分割按鈕的圖示加入另一個 11 個像素的寬度。

- 允許重複的工具列上的命令。

  **文件特定工具列**作用中的特定檔案類型時，會顯示，而且不同的檔案類型會變成作用中時會消失。

- 文件特定工具列不能有超過 12 佹餂鈕。

- 工具列的總寬度不可超過 300 像素。

- 每個檔案類型可以有多個內嵌的工具列或一個特定文件的全域工具列上，但非兩者。

  **內容特定工具列**出現時的特定內容是設定，並且通常會持續很長的作用。

- 所有的特定內容的工具列按鈕限制為 18。

- 如果作用中的內容時，大部分使用者不會以一致的方式會採用此工具列命令，將不關聯此工具列的內容。

- 請確定工具列在結束內容時就會消失。 沒有任何這些工具列應該會出現在啟動。

  **不使用任何內容的工具列**永遠不會自動出現。 這些會顯示只有當使用者啟動它們。 保留以下 200 像素的最大寬度。

### <a name="general-organization-and-shell-defined-groups"></a>一般的組織和介面定義的群組
 使用現有共用的命令、 命令群組和功能表。 如果需要定義新的命令，嘗試將它放在現有的共用的命令群組。 如果新的群組，就必須定義，請嘗試將它放在現有的共用接近相關的命令群組功能表中，建立新的最上層功能表之前。 這會減少同時確保一致的命令位置，在 IDE 中的命令的複雜度。

 共用**格式**下圖說明 功能表中，通常顯示在設計工具樣式文件視窗的內容中：

 ![具有圖說文字的 visual Studio 格式 功能表](../../extensibility/ux-guidelines/media/0501-d_formatmenu.png "0501 d_FormatMenu")

 **在 Visual Studio 中的功能表群組**

### <a name="reducing-and-reusing-commands"></a>減少與重複使用的命令
 命令是通常是根據顯示的內容中，以便減少使用者會看到在任何指定時間的命令數目。 不過，您也應該重複使用現有的共用的功能表和命令群組，以確保命令結構保持相當穩定之間內容中的變更。

 重複使用共用的命令，並將放置新的命令相關的共用命令接近可降低 IDE 的複雜性，並建立更方便使用體驗。

## <a name="naming-commands"></a>命名的命令

### <a name="naming-conventions"></a>命名規範
 一致的命令命名很重要，如此使用者就能找到並執行命令，藉由使用命令列，或繫結到鍵盤快速鍵。 命令名稱也會協助使用者了解哪些命令可顯示在工具列上或階層式或內容功能表中的用途。

#### <a name="when-naming-commands"></a>當命名命令：

- 建構文字，如此就可輕鬆地當地語系化。 如需詳細資訊當地語系化文字，請參閱 <<c0> [ 當地語系化最佳作法](/dotnet/standard/globalization-localization/best-practices-for-developing-world-ready-apps#localization-best-practices)。

- 很簡潔。 命令應該使用不超過三個字。

- 使用字首大寫的大小寫： 每個單字的第一個字母都必須大寫。 如需在 Visual Studio 中格式化的文字的詳細資訊，請參閱[文字樣式](../../extensibility/ux-guidelines/fonts-and-formatting-for-visual-studio.md#BKMK_TextStyle)。

- 請考量將放置命令。 它是否在最上層的功能表或飛出視窗？ 例如，當飛出視窗上，最上層命令中的群組對齊命令應該是 「 對齊 」 以及飛出視窗的命令應該是"Left"「 權利 」、 「 中心 」，「 Justify"，等等。 它會是多餘命名飛出視窗命令"靠左對齊"或"靠右對齊。 」

     ![Visual Studio 格式 功能表](../../extensibility/ux-guidelines/media/0502-a_formatmenu.png "0502 a_FormatMenu")

### <a name="using-icons-with-commands"></a>使用命令中的圖示
 謹慎地使用命令與配對的圖示的使用中。 雖然唯一的映像關聯的命令，則使用者的能力來識別該命令，則視覺雜亂和效率低落將發生的映像的過度使用。 決定是否要建立命令的圖示時，就會說明下列規則。

#### <a name="use-an-icon-with-a-command-only-if"></a>使用命令才圖示：

- 相同的命令有與其相關聯的其他重要 Microsoft 產品，例如其中一個 Microsoft Office 應用程式的圖示。

- 此命令會放在預設工具列。

- 命令是特殊命令的使用者可能會加入至工具列，使用 **[自訂]** 對話方塊。

## <a name="access-and-shortcut-keys"></a>便捷鍵和快速鍵

### <a name="overview"></a>總覽
 有兩種類型的索引鍵的鍵盤設定：

- **存取金鑰**（也稱為加速器） 允許在對話方塊 UI 中使用鍵盤存取透過功能表命令以及每個標籤。 存取金鑰大部分是供協助工具、 指派給所有功能表和大多數對話方塊控制項，不一定要記下，會影響只有目前的視窗，和當地語系化。

- **快速鍵**大部分會使用控制項 (Ctrl) 和函式 (Fn) 的索引鍵序列。 它們被採用更多的進階的使用者，並且有助於提升產能。 它們只能指派給最常用的命令，並允許快速存取，同時略過主功能表。 快速鍵要記憶，而且該原因必須指派與設定檔結構描述一致。 快顯金鑰的配置可能會不同的設定檔。 使用者可以自訂快捷鍵，透過**工具 > 選項 > 鍵盤**。

### <a name="assigning-access-keys"></a>指定便捷鍵
 存取金鑰是由 Alt 再加上英數字元的索引鍵所組成。 每個功能表項目，而沒有例外狀況指派便捷鍵。 請遵循 Windows 和通用慣例指定便捷鍵。 比方說的存取金鑰**檔案 > 新增**應該總是**alt 鍵，F，N**。

 請勿使用單一像素寬度字母，例如 'i' （以大寫或小寫） 或小寫 'l'，並避免伸尾部分 （g、 j、 p、 q 和 y） 搭配使用的字元，因為這些是難以區別。

 請避免使用重複的索引鍵，如果可能的話。 在其中重複資料刪除是無法避免的情況下，功能表系統會以輪流使用索引鍵的所有命令處理衝突。 為例，假設 「 數字 」 下複製"n 名"的存取金鑰，[檔案] 功能表命令的**alt 鍵，F，N**會建立新的檔案，並**Alt、 F，N，N**會執行 「 數字 」 命令。

### <a name="assigning-shortcut-keys"></a>指派的快速鍵
 請避免將新的快速鍵，因為它們不需要為每個命令，而且如果過度使用而使稅務系統 （和使用者記憶體）。 資料從客戶經驗改進計畫 (CEIP) 會指出 Visual Studio 使用者使用一小部分的整合式的捷徑。

 在定義的捷徑，請遵循下列規則：

- **使用控制項 (Ctrl) 和函式 (Fn) 的索引鍵序列。**

- **保留常用的快速鍵。** 維護最常用的快速鍵。

- **讓編輯器快速鍵容易輸入。** 將簡單類型快速鍵繫結開發人員撰寫程式碼時的最需要的命令。 例如， **Edit.InvokeSmartTag**必須能夠快速快速鍵，例如 Ctrl + 並不 Alt + Shift + f10 鍵。

- **尋求以一致的方式配置其佈景主題的捷徑。**

- **遵循 Windows 指導方針來判斷哪些修飾詞的按鍵來運用。** 使用 Ctrl 按鍵組合有大規模的效果，例如，套用至整份文件的命令的命令。 擴充或補充的標準捷徑按鍵動作的命令，請使用 Shift 鍵組合。 請勿使用 Ctrl + alt 鍵組合。

- **移除多餘的捷徑。** 如果您有舊版的功能，請考慮移除捷徑時，所使用極端 infrequency （少於 10 次從 CEIP 資料） 或中度 infrequency （少於 100 倍的 CEIP 資料從） 的存取金鑰可讓您快速存取相同的命令。 例如: Alt 鍵，H，C 會開啟說明/內容。

  不是簡單的方式，檢查快顯的可用性。 如果您想要新增的捷徑，請遵循下列步驟：

1. 檢查清單[Visual Studio 2013 快速鍵](http://visualstudioshortcuts.com/2013/)來判斷是否有類似的命令，將您的使用。

2. 移至**工具 > 選項 > 環境 > 鍵盤**並測試您的捷徑。 檢查每個鍵盤對應配置列在 [套用下列其他鍵盤對應配置]。 檢查 [一般] C#，VB，和C++設定檔，因為這些共用唯一的快速鍵。 如果它不對應這些地方的任何使用您的捷徑。