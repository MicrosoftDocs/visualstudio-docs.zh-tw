---
title: 視覺工作室的功能表和命令 |微軟文件
ms.date: 11/04/2016
ms.topic: conceptual
ms.assetid: 0a1ed675-2bd1-4603-ba3a-f40dfb5cfb69
author: acangialosi
ms.author: anthc
manager: jillfra
ms.workload:
- vssdk
ms.openlocfilehash: c1f22b7ac4377b600208c079b6af1eff7fc3cbfc
ms.sourcegitcommit: 16a4a5da4a4fd795b46a0869ca2152f2d36e6db2
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/06/2020
ms.locfileid: "80698391"
---
# <a name="menus-and-commands-for-visual-studio"></a>適用於 Visual Studio 的功能表和命令
## <a name="command-usage"></a>指令使用

### <a name="overview"></a>概觀
 與 Microsoft Office(一個包含許多獨立產品的套件)不同,Visual Studio 包含許多產品,每個產品都向全域視覺工作室 IDE 貢獻其命令集。 IDE 通過根據上下文篩選使用者可用的功能來管理數千個命令的複雜性。

 當使用者的上下文發生更改(例如從設計視窗切換到代碼編輯視窗)時,與新上下文無關的功能將消失。 同時,新功能與相關的動態資訊(如屬性和工具箱選項)一起顯示。 使用者不應注意到可用命令集的交換。 如果使用者因出現或消失的命令而分心或混淆,則 UI 設計需要調整。 使用者的當前上下文始終以一個或多個方式表示,例如在IDE標題列、屬性視窗或屬性頁對話框中。

 命令欄允許在 UI 中具有靈活性。 Visual Studio 環境固有的唯一命令結構是主菜單和主命令列,它們既可以自定義,也可以隱藏。 其他命令列會根據應用程式的狀態顯示和消失。 工具視窗和文件編輯器還可以在其視窗邊緣包含嵌入工具列。

#### <a name="basic-guidelines"></a>基本準則

##### <a name="use-existing-shared-commands-command-groups-and-menus-whenever-possible"></a>盡可能使用現有的共用命令、命令組和功能表。
 由於命令通常基於上下文顯示,因此使用現有的共用功能表和命令組可確保在上下文中更改之間命令結構保持相對穩定。 重用共用命令並將新命令放置在相關共用命令附近也會降低IDE複雜性,並創建更使用者友好的體驗。 如果需要定義新命令,請嘗試將其放置在現有的共用命令組中。 如果需要定義新組,則在創建新的頂級功能表之前,將其放置在靠近相關命令組的現有共用功能表中。

##### <a name="do-not-create-icons-for-every-command"></a>不要為每個命令創建圖示。
 在創建命令圖示之前,請仔細考慮。 圖示應只針對以下指令建立:

- 顯示在默認工具列上。

- 使用者可能會通過 **「自定義..."** 對話框添加到工具列中。

- 在另一個 Microsoft 產品中具有與同一操作關聯的圖示。

##### <a name="limit-the-addition-of-keyboard-shortcuts"></a>限制鍵盤捷徑的新增
 絕大多數使用者使用所有可用快捷方式的一小部分。 如有疑問,不要將功能綁定到鍵盤快速鍵。 在添加新快捷方式之前,請與您的用戶體驗團隊合作。

##### <a name="give-commands-a-default-menu-placement"></a>為命令提供預設功能表放置位置。
 請注意,您的命令將由其他人自定義並相應地進行設計。 不存在隱藏命令。 所有可視化工作室命令都顯示在 **「工具>自訂**」對話框、命令視窗、自動完成 **、「工具>選項>鍵盤**對話框以及開發工具環境 (DTE) 中。 請確保在 .ctc 檔中為命令指定名稱和工具提示,以便用戶可以輕鬆找到它們。

##### <a name="do-not-duplicate-shared-commands-on-an-embedded-toolbar"></a>不要複製嵌入工具列上的共用命令。
 將命令放置在靠近用戶焦點區域的位置非常有用。 執行此操作的一種方法是在工具視窗或文檔編輯器的頂部創建一個嵌入工具列。 放置在工具列上的命令應特定於視窗中的內容區域。 不要在這些工具列上複製共用命令。 例如,切勿在嵌入工具列中放置"保存"圖示。

### <a name="content-and-command-visibility"></a>內容與指令可見性
 命令存在在以下作用網域中:**環境**、**層次結構**與**文件**。 瞭解每個範圍,以便對命令放置有信心。

 **"環境"** 作用域中的命令建立主上下文,並在多個上下文之間共用。 它們改變了文檔和工具視窗的可見性或排列。 環境範圍內的指令包括**新專案**、**連線到伺服器**、**附加行程**、**剪切**、**複製**、**貼上**、**貼上**、**選項**,**您可以使用**您可以設定,**請參考****您可以**說明 。

 **層次結構**作用網域中的命令管理視覺化工作室中的層次結構,包括**專案**、**團隊**與**資料**。 它們與專案的子中文相關,例如 **,除錯**、**產生**、**測試**、**架構結構**或**分析**。 層次結構作用網域中的指令包括 **「新增新項目**」、「**新增新查詢**」、「**專案設定**」、「**新增新資料來源**」、「**啟動效能精靈**」和 **「新圖**」。

 **"文件**"作用網域中的命令對文件的內容(如代碼、設計或工作項查詢 (WIQ))執行操作。 它們還作用於工具視窗的檢視,或者特定於該工具視窗。 文件範圍指令還對本身特定於層次結構的檔案物件執行操作,例如從 Project**中移除**。 在文件作用網域的指令包含**重構>重新命名**,**建立工作項目的複本**,**並展開所有**項目、**折疊所有**與**建立使用者工作**。

### <a name="command-placement-decisions"></a>命令放置決策
 決定創建命令後,需要確定其適當的位置以及是否創建鍵盤快速鍵。 依此決策路徑決定命令的放置位置:

 ![命令位置決策圖](../../extensibility/ux-guidelines/media/0501-a_commandplacement.png "0501-a_CommandPlacement")

 **視覺化工作室中指令放置的決策路徑**

### <a name="command-placement-in-menus"></a>命令放置在選單中

#### <a name="main-menu-bar"></a>主選單列
 主選單欄應為任何特定於上下文的功能表包的命令的標準位置,這些功能表包有助於 UI。 主菜單欄與其他命令結構不同,因為環境使用它來控制哪些命令可見。 所有其他命令列只是禁用斷章取義的命令,無論這些命令是放置在功能表還是工具列上。

 環境定義一組內置於主菜單欄中的命令,這些命令在整個 IDE 和多個任務域中很常見。 無論將哪些 VS 包載入到環境中,這些命令始終可見。 儘管 VSPackages 可以擴展這組命令,但每個產品的命令集及其命令的位置是每個團隊的責任。

 Visual Studio 主選單的結構可以細分為以下選單類別:

##### <a name="core-menus"></a>核心選單

- 檔案

- 編輯

- 檢視

- 工具

- 時間範圍

- 説明

##### <a name="project-specific-menus"></a>特定於項目的選單

- 隨附此逐步解說的專案

- 組建

- 偵錯

##### <a name="context-specific-menus"></a>特定於上下文的選單

- 小組

- 資料

- 測試

- 架構

- 分析

##### <a name="document-specific-menus"></a>特定於文件的選單

- [格式]

- Table

##### <a name="when-designing-main-menus-adhere-to-these-rules"></a>設計主選單時,遵循以下規則:

- 在給定上下文中不要超過 25 個頂級專案

- 功能表的高度不應超過 600 圖元。

- 在多個上下文中評估主功能表,例如在終極 SKU 和常規配置檔中。

- 飛出功能表是可以接受的。

- 飛出功能表應包含至少三個項目,不超過七個。

- 飛出選單應該只深入一級 - 某些 Visual Studio 菜單項具有級聯子功能表,但不鼓勵此模式。

- 使用不超過六個分隔符。 分組應遵循以下說明:

     ![主功能表群組的方針](../../extensibility/ux-guidelines/media/0501-b_mainmenus.png "0501-b_MainMenus")

- 雖然不需要在圖形中包含每個分組,但添加其他分組受到限制。

- 每個分組應具有 2 到 7 個功能表項。

#### <a name="main-menu-ordering"></a>主選單訂購
 在添加新的頂級項之前,請考慮將命令放在現有的頂級功能表中。 添加新的頂級功能表時,請確保將其放置在正確的位置。 確定功能表是特定於專案、上下文還是文檔。 保持頂級功能表的名稱簡潔,只使用一個單詞。

 核心功能表應預訂其餘命令。 檔、編輯和視圖應始終在左側,工具、視窗和幫助應始終在右側。

#### <a name="context-menus"></a>操作功能表
 在上下文菜單中放置過多的功能會導致一個難以學習的介面。 所有主要功能都應通過主菜單欄提供。 命令的位置應與現有命令協調,以避免重複的命令。 對於上下文菜單,shell 定義應包含的標準功能表組,具體取決於上下文菜單是用於解決方案、專案節點還是專案項。

 設計上下文選單時,遵循與主菜單相同的規則,此外:

- 不要超過 25 個頂級功能表項。

- 飛出功能表是可以接受的,但不得超過一級深度 - 切勿使用級聯飛出。

- 使用不超過六個分隔符。

### <a name="command-placement-in-toolbars"></a>命令放置在工具列中

#### <a name="general-toolbars"></a>一般工具列
 設計和安排工具列時,請遵循以下標準:

- 每個按鈕不要使用多個動詞。 一個按鈕 = 一個操作。

- 僅當圖示需要使用標籤進行強化時,才在圖示旁邊使用文本。

- 對將在一個工作階段中多次切換的屬性,對屬性使用組合框。 否則,在別處公開屬性。

- 組合框的寬度應等於框中最長專案的寬度 = 30%。 例如,如果最長的專案為 200 像素,則組合框應為 260 像素寬。

- 限制分離器的使用。 下拉清單旁邊的分隔符的使用是反模式,因為下拉清單本身的形狀充當視覺分隔符。

- 圖示組應包含三到六個圖示。

- 如果限定字串產生多個有用的指令,請使用儲存最後一個設定的分割按鈕:

     ![Visual Studio 中的分割按鈕](../../extensibility/ux-guidelines/media/0501-c_splitbuttons.png "0501-c_SplitButtons")

     **拆分按鈕的示例。左邊的六個命令可以裝入一個按鈕。**

#### <a name="product-specific-toolbars"></a>特定於產品的工具列
 每個產品都可以提供一個預設工具列,其中包含常用和重要命令,並且每個產品的預設工具列應在安裝產品後首次啟動 Visual Studio 時顯示。

 產品還應利用 IDE 提供的共用命令組和功能表。 每個共用命令組都放置在共用菜單中,旨在以有意義的方式為用戶組織相關命令。 請務必利用此共用命令結構來降低複雜性。

#### <a name="global-toolbars"></a>全域工具列
 全域工具列需要開箱即用即可容納一行。 創建新的全域工具列時,請遵循該工具列類型的指南。

 **一般工具列指南:**

- 每個工具列在常見控制項中具有 24 個畫素(夾持器、溢出)。

- 每個工具列按鈕寬 22 圖元,包括填充。 使圖示拆分按鈕會添加另外 11 像素的寬度。

- 允許跨工具列複製命令。

  當特定檔類型處於活動狀態時,將顯示**特定於文檔的工具列**,當其他文件類型變為活動時,該工具列將消失。

- 特定於文件的工具列可能不超過 12 個按鈕。

- 工具列的總寬度不得超過 300 圖元。

- 每個文件類型可以有一個嵌入工具列或一個特定於文檔的全域工具列,但不能同時具有兩者。

  設置特定上下文時會出現**特定於上下文的工具列**,並傾向於長時間保持活動狀態。

- 所有特定於上下文工具列的按鈕限制為 18。

- 如果大多數使用者在上下文處於活動狀態時不會始終使用此工具列的命令,則不要將此工具列與上下文相關聯。

- 確保工具列在退出上下文時消失。 啟動時不應出現這些工具列。

  **沒有上下文的工具列**永遠不會自動顯示。 僅當使用者激活它們時,才會顯示這些內容。 將最大寬度保持在 200 像素以下。

### <a name="general-organization-and-shell-defined-groups"></a>一般組織與 shell 定義的群組
 使用現有的共用命令、命令組和功能表。 如果需要定義新命令,請嘗試將其放置在現有的共用命令組中。 如果需要定義新組,請嘗試將其放置在靠近相關命令組的現有共用功能表中,然後再創建新的頂級功能表。 這降低了命令複雜性,同時確保在IDE中放置一致的命令。

 分享**格式**選單(通常顯示在設計器樣式的文件視窗上下文中)如下影像所示:

 ![具有圖說文字的 Visual Studio [格式] 功能表](../../extensibility/ux-guidelines/media/0501-d_formatmenu.png "0501-d_FormatMenu")

 **視覺化工作室中的選單組**

### <a name="reducing-and-reusing-commands"></a>減少和重用指令
 命令通常基於上下文顯示,以減少使用者在任何給定時間看到的命令數。 但是,您還應重用現有的共用功能表和命令組,以確保命令結構在上下文中的更改之間保持相對穩定。

 重用共用命令並將新命令放置在相關共用命令附近,可降低IDE複雜性,並創建更使用者友好的體驗。

## <a name="naming-commands"></a>命名命令

### <a name="naming-conventions"></a>命名慣例
 一致的命令命名至關重要,以便使用者可以通過使用命令行或綁定到鍵盤快捷方式來查找和執行命令。 命令名稱還可幫助使用者瞭解命令顯示在工具列或級聯或上下文菜單中時使用什麼用途。

#### <a name="when-naming-commands"></a>命名命令時:

- 建構文字,以便易於當地語系化。 關於本地化文字的更多,請參閱[本地化最佳實務](/dotnet/standard/globalization-localization/best-practices-for-developing-world-ready-apps#localization-best-practices)。

- 簡潔。 命令不應超過三個單詞。

- 使用標題大小寫:每個單詞的第一個字母應大寫。 有關視覺化工作室中文字格式的詳細資訊,請參閱[文字樣式](../../extensibility/ux-guidelines/fonts-and-formatting-for-visual-studio.md#BKMK_TextStyle)。

- 考慮命令的放置位置。 是頂級菜單還是彈出視窗? 例如,在彈出視窗中對對齊命令進行分組時,頂級命令應為「對齊」,而飛出命令應為「左」、「右」、「中心」、」對齊「等。 將飛出命令命名為「向左對齊」或「向右對齊」是多餘的。

     ![Visual Studio 的 [格式] 功能表](../../extensibility/ux-guidelines/media/0502-a_formatmenu.png "0502-a_FormatMenu")

### <a name="using-icons-with-commands"></a>將圖示與指令一起使用
 在使用圖示與命令配對時要謹慎。 儘管將唯一圖像與命令關聯會加速用戶識別該命令的能力,但圖像過度使用會造成視覺混亂和效率低下。 以下規則有助於決定是否創建命令圖示。

#### <a name="use-an-icon-with-a-command-only-if"></a>僅當:

- 同一命令在另一個著名的 Microsoft 產品(如 Microsoft Office 應用程式之一)中具有與其關聯的圖示。

- 該命令將放置在預設工具列中。

- 該命令是使用者可能使用 **「自定義」** 對話方塊添加到工具列的專用命令。

## <a name="access-and-shortcut-keys"></a>存取並快速鍵

### <a name="overview"></a>概觀
 鍵盤鍵分配有兩種:

- **訪問鍵**(也稱為快捷鍵)允許鍵盤通過功能表進行命令和對話方塊 UI 中的每個標籤的訪問。 訪問鍵主要用於輔助功能,分配給所有功能表和大多數對話方塊控制項,不用於記憶,僅影響當前視窗,並且當地語系化。

- **快速鍵**主要使用控制 (Ctrl) 和函數 (Fn) 鍵序列。 它們專為高級用戶而設計,有助於提高生產效率。 它們僅分配給最常用的命令,並允許在繞過主功能表時快速訪問。 快速鍵旨在被記住,因此必須分配與設定檔方案一致的設置。 快捷鍵方案可能因配置檔而異。 使用者可以通過**工具>選項>鍵盤**自定義快速鍵。

### <a name="assigning-access-keys"></a>配置存取金鑰
 訪問鍵由 Alt 加上字母數位鍵組成。 毫無例外地為每個功能表項分配訪問鍵。 遵循 Windows 和通用約定來分配訪問密鑰。 例如,**檔案> New**的存取金鑰應始終為**Alt、F、N**。

 請勿使用單圖元寬度字母,如"i"(大寫或小寫)或小寫"l",並且避免使用帶有下行名(g、j、p、q 和 y)的字元,因為這些字母很難區分。

 盡可能避免使用重複的鍵。 在重複不可避免的情況下,功能表系統通過迴圈流覽使用鍵的所有命令來處理衝突。 例如,對於複製「N」訪問密鑰的檔功能表下的假想「數位」命令 **,Alt、F、N**將創建新檔 **,Alt、F、N、N**將執行「Number」命令。

### <a name="assigning-shortcut-keys"></a>配置捷徑
 避免分配新的快捷鍵,因為每個命令都不需要它們,如果使用過度,則對系統(和使用者記憶體)徵稅。 來自客戶體驗改善計畫 (CEIP) 的數據顯示,Visual Studio 使用者僅使用整合的快捷方式的一小部分。

 定義快捷方式時,請遵循以下規則:

- **使用控制 (Ctrl) 和函數 (Fn) 鍵序列。**

- **保留常用的快捷方式。** 維護最流行的快捷方式。

- **使編輯器快捷方式易於鍵入。** 在編寫代碼時,將易於鍵入的快捷方式綁定到開發人員最需要的命令。 例如 **,Edit.InvokeSmartTag**需要具有快速快速鍵(如 Ctrl+/,而不是 Alt_Shift_F10)。

- **爭取一致的主題捷徑。**

- **按照 Windows 指南確定要使用哪些修改器鍵。** 對具有大規模效果的命令(如應用於整個文檔的命令)使用 Ctrl 組合。 對擴展或補充標準快速鍵操作的命令使用 Shift 組合。 不要使用 Ctrl_Alt 組合。

- **刪除無關的快捷方式。** 如果您有舊功能,請考慮刪除使用極非頻(從 CEIP 資料少於 10 倍)或中等非頻(從 CEIP 資料小於 100 次)的快捷方式(如果存取金鑰提供對同一命令的快速存取。 例如:Alt、H、C 將打開幫助/內容。

  沒有一個簡單的方法來檢查快捷方式的可用性。 如果要添加快捷方式,請按照以下步驟操作:

1. 檢查 Visual [Studio 2013 快捷方式](http://visualstudioshortcuts.com/2013/)的清單,以確定是否有類似的命令對您的命令進行分組。

2. 跳到 **「工具>選項>環境>鍵盤**並測試您的快捷方式。 檢查「應用以下附加鍵盤映射方案」下列出的每個鍵盤映射方案。 檢查常規、C#、VB 和C++配置檔,因為這些配置檔共用唯一的快捷方式。 如果快捷方式未在其中任何一個位置映射,則其可用。
