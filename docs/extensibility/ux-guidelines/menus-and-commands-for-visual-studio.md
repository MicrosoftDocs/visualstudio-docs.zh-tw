---
title: Visual Studio 的功能表和命令 |Microsoft Docs
description: 瞭解當您建立 Visual Studio 的新功能時，命令列如何讓使用者介面具有彈性。
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
ms.assetid: 0a1ed675-2bd1-4603-ba3a-f40dfb5cfb69
author: acangialosi
ms.author: anthc
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: d28242b70c0c9808cc7eb066341cd2973d2372a2
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/08/2021
ms.locfileid: "99971579"
---
# <a name="menus-and-commands-for-visual-studio"></a>適用於 Visual Studio 的功能表和命令
## <a name="command-usage"></a>命令使用方式

### <a name="overview"></a>概觀
 不同于 Microsoft Office （此套件包含許多不同的產品），Visual Studio 包含許多產品，各自將其命令集提供給全域 Visual Studio IDE。 IDE 會根據內容篩選使用者可用的功能，來管理上千個命令的複雜度。

 當使用者的內容變更時（例如從設計視窗切換至程式碼編輯視窗），與新內容不相關的功能也會消失。 同時，新功能會與相關的動態資訊（例如屬性和工具箱選項）一起出現。 使用者應該不會注意到可用的命令集交換。 如果使用者在出現或消失的情況下受到干擾或混淆，則 UI 設計需要調整。 使用者目前的內容一律會以一或多個方式指出，例如在 IDE 標題列、屬性視窗或 [屬性頁] 對話方塊中。

 命令列可讓 UI 具有彈性。 唯一的 Visual Studio 環境唯一的命令結構是主功能表和主要的命令列，可以自訂甚至隱藏。 其他的命令列會根據應用程式的狀態出現並消失。 工具視窗和檔編輯器也可以在視窗邊緣內包含內嵌的工具列。

#### <a name="basic-guidelines"></a>基本指導方針

##### <a name="use-existing-shared-commands-command-groups-and-menus-whenever-possible"></a>盡可能使用現有的共用命令、命令群組和功能表。
 由於命令通常會根據內容顯示，因此使用現有的共用功能表和命令群組可確保命令結構在內容的變更之間保持相對穩定。 重複使用共用的命令，並將新的命令放在相關的共用命令附近，也可降低 IDE 複雜度，並建立更容易使用的體驗。 如果需要定義新的命令，請嘗試將它放置在現有的共用命令群組中。 如果需要定義新的群組，請在建立新的最上層功能表之前，將它放在靠近相關命令群組的現有共用功能表中。

##### <a name="do-not-create-icons-for-every-command"></a>請勿建立每個命令的圖示。
 在您建立命令圖示之前，請仔細考慮。 只應針對下列命令建立圖示：

- 出現在預設工具列上。

- 使用者很可能會透過 [ **自訂 ...** ] 對話方塊，將使用者新增至工具列。

- 具有與另一個 Microsoft 產品中相同動作相關聯的圖示。

##### <a name="limit-the-addition-of-keyboard-shortcuts"></a>限制新增鍵盤快速鍵
 大部分的使用者都採用一小部分的可用快捷方式。 如果不確定，請不要將您的功能系結至鍵盤快速鍵。 在加入新的快捷方式之前，請與您的使用者經驗小組合作。

##### <a name="give-commands-a-default-menu-placement"></a>提供命令預設的功能表位置。
 請注意，您的命令會由其他人自訂，並據此加以設計。 隱藏的命令也沒有這樣的東西。 所有 Visual Studio 命令都會出現在 [ **工具] > [自訂** ] 對話方塊、[命令] 視窗、[自動完成]、[ **工具 > 選項 > 鍵盤** ] 對話方塊，以及 (DTE) 的 [開發工具] 環境中。 請務必在您的 .ctc 檔案中提供命令的名稱和工具提示，讓使用者可以輕鬆地找到它們。

##### <a name="do-not-duplicate-shared-commands-on-an-embedded-toolbar"></a>請勿複製內嵌工具列上的共用命令。
 將命令放在接近使用者的焦點區域附近很有用。 其中一個方法是在您的工具視窗或檔編輯器的頂端建立內嵌的工具列。 放在工具列上的命令應該是視窗內的內容區域特定的。 請勿在這些工具列上重複共用命令。 例如，絕對不要在內嵌的工具列內放置「儲存」圖示。

### <a name="content-and-command-visibility"></a>內容和命令可見度
 命令存在於下列範圍中：**環境**、**階層和****檔**。 瞭解每個範圍，以在命令放置上具有信心。

 **環境** 範圍中的命令會建立主要內容，並在多個內容間共用。 他們會改變檔和工具視窗的可視性或相片順序。 環境範圍中的命令包括 **新增專案**、 **連接到伺服器**、 **附加進程**、 **剪** 下、 **複製**、 **貼** 上、 **尋找**、 **選項**、 **自訂**、 **新視窗** 和 **View** 說明

 階層 **範圍中** 的命令會管理 Visual Studio 中的階層，包括 **專案**、 **小組** 和 **資料**。 它們與專案的子上下文相關，例如， **Debug**、 **Build**、 **Test**、 **架構** 或 **分析**。 在階層範圍中的命令之間，會 **加入新的專案**、 **新的查詢**、 **專案設定**、 **加入新的資料來源**、 **啟動效能嚮導** 和 **新圖表**。

 **檔** 範圍中的命令會處理檔的內容，例如程式碼、設計或工作專案查詢 (.wiq) 。 它們也會在工具視窗的視圖上運作，或在其他工具視窗中使用。 檔範圍命令也會對本身為階層特定的檔案物件（例如， **從專案中移除**）採取動作。 檔範圍中的命令會 **重構 > 重新命名**、 **建立工作專案的複本**、 **全部展開** **、全部折迭，** 以及 **建立使用者** 工作。

### <a name="command-placement-decisions"></a>命令位置決策
 一旦決定建立命令之後，您必須決定適當的位置，以及是否要建立鍵盤快速鍵。 遵循此決策路徑來建立命令的放置位置：

 ![命令位置決策圖](../../extensibility/ux-guidelines/media/0501-a_commandplacement.png "0501-a_CommandPlacement")

 **命令位置在 Visual Studio 中的決策路徑**

### <a name="command-placement-in-menus"></a>功能表中的命令位置

#### <a name="main-menu-bar"></a>主功能表列
 主功能表列應該是參與 UI 之任何內容特定功能表封裝的命令標準位置。 主功能表列與其他命令結構不同之處在于，環境會使用它來控制哪些命令是可見的。 所有其他的命令列都只會停用不在內容中的命令，不論它們是放在功能表或工具列上。

 環境會定義一組內建于主功能表列的命令，這些命令在整個 IDE 和多個工作網域中都是共通的。 無論載入至環境中的 Vspackage 為何，都一律會顯示這些命令。 雖然 Vspackage 可以擴充這組命令，但每個產品的命令集和其命令的位置都是每個小組的責任。

 Visual Studio 主功能表的結構可以細分為下列功能表類別：

##### <a name="core-menus"></a>核心功能表

- 檔案

- 編輯

- 檢視

- 工具

- 時間範圍

- 説明

##### <a name="project-specific-menus"></a>專案特定功能表

- Project

- 組建

- 偵錯

##### <a name="context-specific-menus"></a>特定內容功能表

- 小組

- 資料

- 測試

- 架構

- 分析

##### <a name="document-specific-menus"></a>檔特定功能表

- 格式

- 資料表

##### <a name="when-designing-main-menus-adhere-to-these-rules"></a>設計主功能表時，請遵守下列規則：

- 在指定的內容中，請勿超過25個最上層專案

- 功能表的高度絕對不能超過600圖元。

- 評估多個內容中的主功能表，例如終極 SKU 和一般設定檔。

- 飛出視窗功能表是可接受的。

- 飛出視窗功能表至少應包含三個專案，而且不能超過7個。

- 飛出視窗功能表應該只會有一個層級的深度-某些 Visual Studio 功能表項目具有串聯的子功能表，但不建議使用此模式。

- 使用的分隔符號不超過六個。 分組應遵循下圖：

     ![主功能表群組的方針](../../extensibility/ux-guidelines/media/0501-b_mainmenus.png "0501-b_MainMenus")

- 雖然圖中並不需要每個群組，但新增其他群組會受到限制。

- 每個群組都應該有兩個到七個功能表項目。

#### <a name="main-menu-ordering"></a>主功能表順序
 在加入新的最上層專案之前，請考慮將命令放在現有的最上層功能表中。 當您加入新的最上層功能表時，請務必將它放置在正確的位置。 決定功能表是否為專案、內容或檔所特有。 將最上層功能表的名稱保持簡潔，並只使用一個字組。

 核心功能表應該 bookend 其餘的命令。 [檔案]、[編輯] 和 [視圖] 應該一律在左邊，而 [工具]、[視窗] 和 [說明] 應該一律位於右邊。

#### <a name="context-menus"></a>操作功能表
 在內容功能表中放入太多功能，會導致難以學習的介面。 所有主要功能都應該可透過主功能表列取得。 命令的放置應與現有的命令一致，以避免重複的命令。 針對快顯功能表，shell 會根據內容功能表是針對方案、專案節點或專案專案來定義應包含的標準功能表群組。

 設計操作功能表時，請遵守與主功能表相同的規則，此外：

- 請勿超過25個最上層功能表項目。

- 飛出視窗功能表是可接受的，但不能超過一層級的深度，也不能使用串聯 flyouts。

- 使用的分隔符號不超過六個。

### <a name="command-placement-in-toolbars"></a>工具列中的命令位置

#### <a name="general-toolbars"></a>一般工具列
 設計和排列工具列時，請遵循下列標準：

- 每個按鈕請勿使用一個以上的動詞。 一個按鈕 = 一個動作。

- 只有在需要利用標籤來加強時，才使用文字與圖示。

- 針對將在單一會話中多次切換的屬性使用下拉式方塊。 否則，會在別處公開屬性。

- 下拉式方塊的寬度應等於 box + 30% 內最長專案的寬度。 比方說，如果最長的專案是200圖元，則下拉式方塊的寬度應該是260圖元。

- 限制使用分隔符號。 在下拉式清單旁邊使用分隔符號是一種反模式，因為下拉式清單本身的圖形會當做視覺分隔符號。

- 圖示群組應該包含三到六個圖示。

- 如果限定詞導致多個有用的命令，請使用儲存最後一個設定的分割按鈕：

     ![Visual Studio 中的分割按鈕](../../extensibility/ux-guidelines/media/0501-c_splitbuttons.png "0501-c_SplitButtons")

     **分割按鈕的範例。左邊的六個命令可改為放入單一按鈕。**

#### <a name="product-specific-toolbars"></a>特定產品的工具列
 每項產品都可以提供包含常用和重要命令的預設工具列，且每個產品的預設工具列應該會在安裝產品後第一次啟動 Visual Studio 時出現。

 產品也應該運用 IDE 提供的共用命令群組和功能表。 每個共用的命令群組都會放置在共用功能表中，以對使用者以有意義的方式組織相關命令。 請務必利用此共用命令結構來降低複雜度。

#### <a name="global-toolbars"></a>全域工具列
 全域工具列必須符合方塊中的一個資料列。 建立新的全域工具列時，請遵循該工具列類型的指導方針。

 **一般工具列指導方針：**

- 在通用控制項中，每個工具列都有24個圖元 (移出、溢位) 。

- 每個工具列按鈕的寬度都是22圖元，包括邊框距離。 讓圖示成為分割按鈕會新增另一個寬度11圖元。

- 允許跨工具列重複命令。

  檔專屬的 **工具列** 會在特定檔案類型為作用中時出現，並會在不同的檔案類型變成使用中時消失。

- 檔專屬的工具列可能不會有12個以上的按鈕。

- 工具列的總寬度不得超過300圖元。

- 每個檔案類型可以有一個內嵌的工具列或一個檔專屬的全域工具列，但不能同時有兩者。

  特定內容設定時，**內容特定的工具列** 會出現，而且通常會在延長的期間內保持有效。

- 所有特定內容工具列的按鈕限制為18。

- 如果大部分的使用者在內容為使用中時，不會一直使用這個工具列的命令，則請勿將此工具列與內容產生關聯。

- 確定工具列會在結束內容時消失。 啟動時，這些工具列都不會出現。

  **沒有內容的工具列** 就不會自動出現。 只有當使用者啟動這些專案時，才會顯示這些專案。 將最大寬度維持在200圖元以下。

### <a name="general-organization-and-shell-defined-groups"></a>一般組織和 shell 定義的群組
 使用現有的共用命令、命令群組和功能表。 如果需要定義新的命令，請嘗試將它放置在現有的共用命令群組中。 如果需要定義新的群組，請在建立新的最上層功能表之前，嘗試將它放置在靠近相關命令群組的現有共用功能表中。 這樣可減少命令複雜性，同時確保 IDE 中的命令位置保持一致。

 [共用 **格式** ] 功能表（通常顯示在設計工具樣式文件視窗的內容中）如下圖所示：

 ![具有圖說文字的 Visual Studio [格式] 功能表](../../extensibility/ux-guidelines/media/0501-d_formatmenu.png "0501-d_FormatMenu")

 **Visual Studio 中的功能表群組**

### <a name="reducing-and-reusing-commands"></a>減少和重複使用命令
 命令通常會根據內容顯示，以便減少使用者在任何指定時間所見的命令數目。 不過，您也應該重複使用現有的共用功能表和命令群組，以確保命令結構在內容的變更之間保持相對穩定。

 重複使用共用的命令，並將新命令放在相關的共用命令附近，可降低 IDE 複雜度，並建立更容易使用的體驗。

## <a name="naming-commands"></a>命名命令

### <a name="naming-conventions"></a>命名規範
 一致的命令命名十分重要，因此使用者可以使用命令列或系結至鍵盤快速鍵，來尋找和執行命令。 命令名稱也可協助使用者瞭解當命令顯示在工具列或階層階層式或內容功能表時，該命令所提供的用途。

#### <a name="when-naming-commands"></a>命名命令時：

- 建立文字，以便輕鬆地進行當地語系化。 如需當地語系化文字的詳細資訊，請參閱 [當地語系化最佳做法](/dotnet/standard/globalization-localization/best-practices-for-developing-world-ready-apps#localization-best-practices)。

- 很簡潔。 命令不能使用三個以上的單字。

- 使用標題大小寫大小寫：每個單字的第一個字母應為大寫。 如需 Visual Studio 中文字格式的詳細資訊，請參閱 [文字樣式](../../extensibility/ux-guidelines/fonts-and-formatting-for-visual-studio.md#BKMK_TextStyle)。

- 請考慮將放置命令的位置。 它是在最上層功能表還是飛出視窗中？ 例如，當您在飛出視窗中將對齊命令分組時，最上層命令應該是「對齊」，而飛出視窗命令應該是「左」、「右」、「中心」、「對齊」等等。 這是多餘的，可將飛出視窗的命令「靠左對齊」或「靠右對齊」。

     ![Visual Studio 的 [格式] 功能表](../../extensibility/ux-guidelines/media/0502-a_formatmenu.png "0502-a_FormatMenu")

### <a name="using-icons-with-commands"></a>搭配命令使用圖示
 使用與命令搭配使用的圖示配對。 雖然將唯一的映射與命令相關聯，加速使用者識別該命令的能力，但影像過度使用也會造成視覺雜亂和效率低下。 下列規則可協助您決定是否要建立命令圖示。

#### <a name="use-an-icon-with-a-command-only-if"></a>只有在下列情況時，才使用具有命令的圖示：

- 相同的命令在另一個重要的 Microsoft 產品（例如其中一個 Microsoft Office 的應用程式）中有相關聯的圖示。

- 此命令會放在預設工具列中。

- 此命令是一種特殊命令，使用者很可能會使用 [ **自訂** ] 對話方塊，將其新增至工具列。

## <a name="access-and-shortcut-keys"></a>存取和快速鍵

### <a name="overview"></a>概觀
 鍵盤按鍵指派的類型有兩種：

- **存取金鑰** (也稱為快速鍵) 允許透過命令的功能表以及對話方塊 UI 中的每個標籤來存取鍵盤。 存取金鑰大多是為了方便存取，而是指派給所有功能表和大部分的對話方塊控制項，這些都不是要記下、只會影響目前的視窗，而且已當地語系化。

- **快速鍵** 大多使用 Control (Ctrl) 和函式 (Fn) 按鍵序列。 它們是專為 advanced 使用者而設計，可協助提升生產力。 系統只會將這些命令指派給最常使用的命令，並允許快速存取，同時略過主功能表。 快速鍵的記下目的是要將其指派為與設定檔配置一致的原因。 快速鍵配置可能會因設定檔而異。 使用者可以透過 [ **工具] > 選項 > 鍵盤** 自訂快速鍵。

### <a name="assigning-access-keys"></a>指派存取金鑰
 存取金鑰是由 Alt + 英數位鍵 (s) 所組成。 將存取金鑰指派給每個功能表項目，而不會發生例外狀況。 遵循 Windows 與指派存取金鑰的一般慣例。 例如， **File > New** 的存取金鑰應該一律是 **Alt、F、N**。

 請勿使用單一圖元寬度的字母，例如 ' i ' (大寫或小寫) 或小寫的 ' l '，並避免使用具有下行的字元 (g、j、p、q 和 y) ，因為它們難以區分。

 盡可能避免使用重複的索引鍵。 在無法避免重複的情況下，功能表系統會藉由迴圈使用金鑰的所有命令來處理衝突。 例如，在 [檔案] 功能表下複製 "N" 存取金鑰的假設 "Number" 命令， **alt、f、n** 會建立新檔案，而 **alt、f、n、n** 會執行 "Number" 命令。

### <a name="assigning-shortcut-keys"></a>指派快速鍵
 請避免指派新的快速鍵，因為並非每個命令都需要這些快速鍵，而且系統 (和使用者記憶體) （如果過度使用）。 客戶經驗改進計畫 (CEIP) 的資料表示 Visual Studio 使用者只會使用一小部分的整合快捷方式。

 定義快捷方式時，請遵循下列規則：

- **使用 Control (Ctrl) 和 Function (Fn) 按鍵序列。**

- **保留經常使用的快捷方式。** 維護最受歡迎的快捷方式。

- **讓編輯器快速鍵易於輸入。** 針對開發人員在撰寫程式碼時所需的命令，系結簡單易用的快捷方式。 例如， **InvokeSmartTag** 需要有一個快速快速鍵，例如 Ctrl +/，而不是 Alt + Shift + F10。

- **致力於一致的主題快捷方式。**

- **遵循 Windows 指導方針來判斷要採用哪些輔助按鍵。** 針對具有大規模效果的命令（例如適用于整份檔的命令），使用 Ctrl 鍵組合。 針對擴充或補充標準快速鍵之動作的命令，請使用 Shift 鍵組合。 請勿使用 Ctrl + Alt 組合。

- **移除多餘的快捷方式。** 如果您有舊版功能，請考慮從 CEIP) 資料的 infrequency 中移除所使用的快捷方式 (少於10次，如果存取金鑰提供相同命令的快速存取權，則請考慮從 CEIP) 資料的 infrequency (少於100倍。 例如： Alt、H、C 會開啟 [說明]/[內容]。

  沒有簡單的方法可以檢查快速鍵的可用性。 如果您想要新增快捷方式，請遵循下列步驟：

1. 請檢查 [Visual Studio 2013 快捷方式](http://visualstudioshortcuts.com/2013/) 的清單，以判斷是否有類似的命令，可將您的分組。

2. 移至 [ **工具 > 選項 > 環境] > 鍵盤** 並測試您的快捷方式。 檢查 [套用下列額外的鍵盤對應配置] 底下列出的每個鍵盤對應配置。 檢查一般、c #、VB 和 c + + 設定檔，因為它們會共用唯一的快捷方式。 如果您的快捷方式未在任何位置進行對應，則可以使用。
