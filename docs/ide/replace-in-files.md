---
title: 在檔案中尋找和取代
ms.date: 11/04/2016
ms.topic: conceptual
f1_keywords:
- vs.findreplace.replaceinfiles
- vs.replaceinfiles
helpviewer_keywords:
- text searches, replacing text
- find and replace
- replace in files
author: TerryGLee
ms.author: tglee
manager: jillfra
ms.workload:
- multiple
ms.openlocfilehash: dddd55714e53516ba1ccd8a11c99761a4db7136a
ms.sourcegitcommit: cc841df335d1d22d281871fe41e74238d2fc52a6
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/18/2020
ms.locfileid: "75585622"
---
# <a name="replace-in-files"></a>檔案中取代

[檔案中取代]**** 可讓您在一組指定檔案中搜尋程式碼的字串或運算式，並變更部分或所有找到的相符項目。 找到的匹配項和執行的操作列在 **"查找結果"視窗中，** 該視窗中選擇了"結果"選項。 **Find Results**

> [!NOTE]
> 您看到的對話方塊和功能表命令可能與 **"説明"** 中描述的對話方塊和功能表命令不同，具體取決於您的活動設置或版本。 若要變更您的設定 (例如變更為 [一般]**** 或 [Visual C++]**** 設定)，請選擇 [工具]**** > [匯入和匯出設定]****，然後選擇 [重設所有設定]****。

您可以使用下列方法之一，在 [檔案中尋找]**** 視窗中顯示 [檔案中取代]****。

## <a name="to-display-replace-in-files"></a>若要顯示檔案中取代

1. 在 [編輯]**** 功能表上，展開 [尋找和取代]****。

2. 選擇 [檔案中取代]****。

   — 或者—

   如果 [尋找和取代]**** 視窗已開啟，請選擇工具列中的 [檔案中取代]****。

## <a name="find-what"></a>尋找目標

若要搜尋新的文字字串或運算式，請在方塊中指定。 若要搜尋您最近搜尋過的 20 個字串之一，請開啟下拉式清單，然後選擇字串。 如果您想要在搜尋字串中使用一或多個規則運算式，請選擇相鄰的 [運算式產生器]**** 按鈕。 如需詳細資訊，請參閱[在 Visual Studio 中使用規則運算式](../ide/using-regular-expressions-in-visual-studio.md)。

> [!NOTE]
> 只有在選取 [尋找選項]**** 下方的 [使用規則運算式]**** 時，才會啟用 [運算式產生器]**** 按鈕。

## <a name="replace-with"></a>取代為

若要將 [尋找目標]**** 方塊中的字串執行個體取代為其他字串，請在 [取代為]**** 方塊中輸入取代字串。 若要刪除 [尋找目標]**** 方塊中的字串執行個體，請將此欄位保留空白。 開啟清單即可顯示您最近搜尋的 20 筆字串。 如果您想要在取代字串中使用一或多個規則運算式，請選擇相鄰的 [運算式產生器]**** 按鈕。 如需詳細資訊，請參閱[在 Visual Studio 中使用規則運算式](../ide/using-regular-expressions-in-visual-studio.md)。

## <a name="look-in"></a>查詢

您從 [查詢]**** 下拉式清單中選擇的選項，可決定 [檔案中取代]**** 僅搜尋目前使用中的檔案，或搜尋儲存在特定資料夾中的所有檔案。 從清單中選取搜尋範圍、輸入資料夾路徑，或按一下 [瀏覽 (...)]**** 按鈕，顯示 [選擇搜尋資料夾]**** 對話方塊，然後選擇要搜尋的資料夾集合。 您也可以直接在 [查詢]**** 方塊中輸入路徑。

> [!NOTE]
> 如果選取 [查詢]**** 選項時，所搜尋的檔案已從原始程式碼控制簽出，則只會搜尋該檔案的本機電腦下載版本。

## <a name="find-options"></a>尋找選項

您可以展開或折疊 **"查找選項"** 部分。 可選取或清除下列選項：

**大小寫須相符**

選取時，[尋找結果]**** 視窗僅會顯示內容和大小寫都相符的 [尋找目標]**** 字串執行個體。 例如，若搜尋 "MyObject" 時選取 [大小寫須相符]****，則會傳回 "MyObject"，而不是 "myobject" 或 "MYOBJECT"。

**全字拼寫須相符**

選取時，[尋找結果]**** 視窗僅會顯示完整字組相符的 [尋找目標]**** 字串執行個體。 例如，搜尋 "MyObject" 時會傳回 "MyObject"，而不是 "CMyObject" 或 "MyObjectC"。

**使用正則運算式**

如果已選取此核取方塊，您可以在 [尋找目標]**** 或 [取代為]**** 文字方塊中，使用特殊標記法來定義文字模式。 如需這些標記法的清單，請參閱[在 Visual Studio 中使用規則運算式](../ide/using-regular-expressions-in-visual-studio.md)。

**尋找下列檔案類型**

這個清單可指定要在 [查詢]**** 目錄中搜尋的檔案類型。 如果此欄位保持空白，則會搜尋 [查詢]**** 目錄中的所有檔案。 選取此清單中的任一項目，即可輸入預先設定的搜尋字串，以尋找特定類型的檔案。

## <a name="result-options"></a>結果選項

您可以展開或折疊 **"結果"選項**部分。 可選取或清除下列選項：

**查找結果 1**視窗

若選取此選項，目前搜尋的結果將會取代 [尋找結果 1]**** 視窗的內容。 此視窗會自動開啟，以顯示您的搜尋結果。 若要手動開啟此視窗，請從 [檢視]**** 功能表中選取 [其他視窗]****，並選擇 [尋找結果 1]****。

**查找結果 2**視窗

若選取此選項，目前搜尋的結果將會取代 [尋找結果 2]**** 視窗的內容。 此視窗會自動開啟，以顯示您的搜尋結果。 若要手動開啟此視窗，請從 [檢視]**** 功能表中選取 [其他視窗]****，並選擇 [尋找結果 2]****。

**僅顯示檔案名稱**

選取此核取方塊時，[尋找結果]**** 視窗會列出包含搜尋字串之所有檔案的完整名稱和路徑。 不過，這些結果不含字串出現位置的程式碼行。 此核取方塊僅在 [檔案中尋找]**** 中提供。

**全部取代後保持已修改檔案為開啟狀態**

如果選取，就會將有進行取代作業的所有檔案保持開啟，以便您恢復或儲存變更。 記憶體的容量可能會限制進行取代作業之後，能夠保持開啟的檔案數目。

> [!CAUTION]
> 您僅能針對仍然保持開啟以供編輯的檔案執行 [恢復]**** 動作。 如果沒有選取此選項，沒有開啟以供編輯的檔案將會保持關閉狀態，且該些檔案就無法使用 [恢復]**** 選項。

## <a name="see-also"></a>另請參閱

- [查找和替換文本](../ide/finding-and-replacing-text.md)
- [在檔中查找](../ide/find-in-files.md)
- [視覺化工作室命令](../ide/reference/visual-studio-commands.md)
